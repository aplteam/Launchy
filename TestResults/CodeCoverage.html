<!DOCTYPE html>
<html lang="en">
<head>
<title>Coverage</title>
<meta charset="utf-8"/>
<style>
@media screen{
    html {background-color: #FFFFF0;}
body {
    font-size: 16px;
    font-family : Verdana, "Bitstream Vera Sans", "DejaVu Sans", Tahoma, Geneva, Arial, Sans-serif;
    margin: 1em;
}
th, td {padding: 5px 10px;}
th {text-align: left;}
h1, h2, h3, h4, h5, h6 {color: #424242;}
h1 {font-size: 22px;}
h2 {font-size: 18px; margin-top: 2em; margin-bottom:0.3em;}
tbody tr:nth-child(even) {background-color: #F0F0F0;}
tbody tr:nth-child(odd) {background-color: #FAFAFA;}
th {background-color: #E6E6E6;color: #424242;}
table {border: silver 1px solid; font-size: 14px;font-family: APLFont, monospace;}
code , code a {font-size: 14px; font-family: APLFont, monospace;}
code.header {
    font-size: 16px; 
    font-family: APLFont, monospace; 
    margin: 1.5em 0.5em 0 0.5em; 
    padding:0;
    display: block;
}
div.code-block {
    border: 1px silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 0.5em 0.5em 0.5em 0.5em;
    padding: 0.5em;
}
div.code-block.missing {
    background-color: #fa605254;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
ul li, ol li {margin: 0.7em 0.2em;}
.float-right {float:right;}
.no-underline {    text-decoration :none;}
.top-links {font-size:20px; padding-left: 0.6em;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5px; padding-top:0; font-size: 9px;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 0.5em; padding: 0.5em;}
}
@media print{@page {size: portrait}
@page {
    margin: 1cm 1cm 1cm 1.75cm;
    @bottom-right {
        content: counter(page) " / " counter(pages);
  }
}
body {
    font: 12pt "Times New Roman", Times, serif;
    line-height: 1.2;
     /* CSS3 filter, at the moment Webkit only. Prefix it for future implementations */
    -webkit-filter: grayscale(100%);
    filter: grayscale(100%); /* future-proof */
}
h1 {font-size: 18pt;}
h2 {font-size: 16pt; margin-top: 10pt; margin-bottom: 3pt;}
th, td {padding: 2pt 3pt;}
th {text-align: left;background-color: #DBDBDB;}
tbody tr:nth-child(odd) {background-color: #EDEDED;}
table {
    color-adjust: exact !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    font-size: 8pt;
    font-family: APLFont, monospace;
}
div.keep-together {break-inside: avoid; break-before:auto;}
table {border: silver 1pt solid;}
code , code a {font-size: 8pt; font-family: APLFont, monospace;}
code.header {
    font-size: 8pt;
    font-family: APLFont, monospace;
    margin: 7pt 3pt 0 10pt;
    padding:0;
    display: block;
}
div.code-block {
    border: 1pt silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 4pt 4pt 4pt 4pt;
    padding: 4pt;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
a {text-decoration: none;color: black;}
ul li, ol li {margin: 8pt 3pt;}
.no-print {display:none;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5pt; padding-top:0; font-size: 6pt;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 8px; padding: 8px;}
}
</style>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.css"/>
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.js"></script>
</head>
<body>
<h1 id="top">Coverage Report</h1>
<p>Watched: 188 fns/opr within <code>#.Launchy.Launchy</code></p>
<p>The test suite was executed once:</p>
<table>
<thead>
<tr><th>Executed at</th><th>APLVersion</th><th>Memory (MB)</th></tr>
</thead>
<tbody>
<tr><td>2023-09-11 08:31:29</td><td>Windows-64 ⋄ 18.2.47418.0 ⋄ W ⋄ Development ⋄ Unicode</td><td>51</td></tr>
</tbody>
</table>
<p>Overall 33% of the testable code is covered.</p>
<p>(Comment lines, empty lines, all <code>:End</code>* lines etc. are ignored)</p>
<p>41 of the fns/opr are 100% covered.</p>
<div id="partly-covered" class="keep-together">
<table id="percent">
<thead>
<tr><th style="text-align:left;">Function/Operator</th><th style="text-align:left;">Lines not executed</th><th style="text-align:left;">Coverage</th><th style="text-align:right;">≢</th></tr>
</thead>
<tbody>
<tr class="uncovered"><td><a href="#listing_1" title="Link to listing">#.Launchy.Launchy.About</a></td><td>43←≢2-6,8-17,19-29,32-36,39-40,43-52</td><td>0</td><td>43</td></tr>
<tr class="uncovered"><td><a href="#listing_2" title="Link to listing">#.Launchy.Launchy.AskForKeyboardShortcutForLNK</a></td><td>59←≢2-10,12-17,19-22,24-33,35-38,40-48,50-53,55-62,64-67,69</td><td>0</td><td>59</td></tr>
<tr class="uncovered"><td><a href="#listing_3" title="Link to listing">#.Launchy.Launchy.AskForRideAndPort</a></td><td>79←≢1-3,5,7-14,16,18-21,23-35,37-40,42-47,49-55,57-62,64-70,72-74,76-79,81-87,89,91,94-96</td><td>0</td><td>79</td></tr>
<tr class="uncovered"><td><a href="#listing_4" title="Link to listing">#.Launchy.Launchy.AskForShowCommandLineParms</a></td><td>5←≢1-5</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_5" title="Link to listing">#.Launchy.Launchy.CeateMenu_Edit</a></td><td>18←≢1-6,8-13,15-20</td><td>0</td><td>18</td></tr>
<tr class="uncovered"><td><a href="#listing_6" title="Link to listing">#.Launchy.Launchy.CheckCredentials</a></td><td>12←≢1-12</td><td>0</td><td>12</td></tr>
<tr class="uncovered"><td><a href="#listing_7" title="Link to listing">#.Launchy.Launchy.CheckDefaults</a></td><td>28←≢2-4,6-27,29,31-32</td><td>0</td><td>28</td></tr>
<tr class="uncovered"><td><a href="#listing_8" title="Link to listing">#.Launchy.Launchy.CheckDyalogForRunning</a></td><td>12←≢1-12</td><td>0</td><td>12</td></tr>
<tr class="uncovered"><td><a href="#listing_9" title="Link to listing">#.Launchy.Launchy.CheckForNewVersion</a></td><td>20←≢1-4,6-7,9-11,13-17,19-21,23-24,26</td><td>0</td><td>20</td></tr>
<tr class="uncovered"><td><a href="#listing_10" title="Link to listing">#.Launchy.Launchy.CheckRc</a></td><td>5←≢1-5</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_11" title="Link to listing">#.Launchy.Launchy.CheckRide</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_12" title="Link to listing">#.Launchy.Launchy.CollectCommandLineParms</a></td><td>30←≢2-4,6-10,12-13,15-16,18-19,21-22,24-32,34,36-38,40</td><td>0</td><td>30</td></tr>
<tr class="uncovered"><td><a href="#listing_13" title="Link to listing">#.Launchy.Launchy.ColorCode</a></td><td>2, 3, 5</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_14" title="Link to listing">#.Launchy.Launchy.CreateBatFile</a></td><td>6←≢1-6</td><td>0</td><td>6</td></tr>
<tr class="uncovered"><td><a href="#listing_15" title="Link to listing">#.Launchy.Launchy.CreateShortcut</a></td><td>16←≢3-14,16-18,20</td><td>0</td><td>16</td></tr>
<tr class="uncovered"><td><a href="#listing_16" title="Link to listing">#.Launchy.Launchy.EditCredentials</a></td><td>93←≢1-12,14-18,20-26,28-32,34-41,43-49,51-56,58-64,66-72,74-80,82-88,90-93,95-102,105-106,109</td><td>0</td><td>93</td></tr>
<tr class="uncovered"><td><a href="#listing_17" title="Link to listing">#.Launchy.Launchy.EditINI</a></td><td>27←≢1-9,11-16,18-19,21,24-27,30-32,34-35</td><td>0</td><td>27</td></tr>
<tr class="uncovered"><td><a href="#listing_18" title="Link to listing">#.Launchy.Launchy.ExchangeIn</a></td><td>4←≢2-5</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_19" title="Link to listing">#.Launchy.Launchy.ExecuteIn</a></td><td>2, 3</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_20" title="Link to listing">#.Launchy.Launchy.FindRIDEexe</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_21" title="Link to listing">#.Launchy.Launchy.GetAllControls</a></td><td>5←≢2-6</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_22" title="Link to listing">#.Launchy.Launchy.GetAplList</a></td><td>8←≢3-10</td><td>0</td><td>8</td></tr>
<tr class="uncovered"><td><a href="#listing_23" title="Link to listing">#.Launchy.Launchy.GetCommandLineParmsFromGUI</a></td><td>4←≢2-5</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_24" title="Link to listing">#.Launchy.Launchy.GetCommandLineParmsFromINI</a></td><td>4←≢1-4</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_25" title="Link to listing">#.Launchy.Launchy.GetCurrentlySelectedAPL</a></td><td>1, 2, 4</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_26" title="Link to listing">#.Launchy.Launchy.GetDebugCode</a></td><td>2, 3</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_27" title="Link to listing">#.Launchy.Launchy.GetDefaultForIconify</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_28" title="Link to listing">#.Launchy.Launchy.GetDyalogAppPath</a></td><td>5←≢2-6</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_29" title="Link to listing">#.Launchy.Launchy.GetDyalogRegKey</a></td><td>2</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_30" title="Link to listing">#.Launchy.Launchy.GetFileTime</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_31" title="Link to listing">#.Launchy.Launchy.GetFolder</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_32" title="Link to listing">#.Launchy.Launchy.GetFontSize</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_33" title="Link to listing">#.Launchy.Launchy.GetInstallDirFor</a></td><td>2, 3</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_34" title="Link to listing">#.Launchy.Launchy.GetInstallPath</a></td><td>2, 3, 4</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_35" title="Link to listing">#.Launchy.Launchy.GetJson</a></td><td>29←≢14-31,33-36,38,40-44,46</td><td>0</td><td>29</td></tr>
<tr class="uncovered"><td><a href="#listing_36" title="Link to listing">#.Launchy.Launchy.GetMajorAndMinor</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_37" title="Link to listing">#.Launchy.Launchy.GetPathToDesktop</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_38" title="Link to listing">#.Launchy.Launchy.GetProperPath</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_39" title="Link to listing">#.Launchy.Launchy.GetRef2n</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_40" title="Link to listing">#.Launchy.Launchy.GetRideExeName</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_41" title="Link to listing">#.Launchy.Launchy.GetRidePathForVersion</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_42" title="Link to listing">#.Launchy.Launchy.GetVersionOfSelectedAPL</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_43" title="Link to listing">#.Launchy.Launchy.GetWsSize</a></td><td>7←≢1-7</td><td>0</td><td>7</td></tr>
<tr class="uncovered"><td><a href="#listing_44" title="Link to listing">#.Launchy.Launchy.GetWsSize_</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_45" title="Link to listing">#.Launchy.Launchy.IfAtLeastVersion</a></td><td>3</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_46" title="Link to listing">#.Launchy.Launchy.IsRideAvailable</a></td><td>5←≢1-5</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_47" title="Link to listing">#.Launchy.Launchy.LaunchDyalog</a></td><td>21←≢2-6,8-12,14-23,26</td><td>0</td><td>21</td></tr>
<tr class="uncovered"><td><a href="#listing_48" title="Link to listing">#.Launchy.Launchy.LaunchWindowsAPL</a></td><td>16←≢1-5,7,9-15,17-19</td><td>0</td><td>16</td></tr>
<tr class="uncovered"><td><a href="#listing_49" title="Link to listing">#.Launchy.Launchy.LoadPatch</a></td><td>10←≢2-11</td><td>0</td><td>10</td></tr>
<tr class="uncovered"><td><a href="#listing_50" title="Link to listing">#.Launchy.Launchy.LoadPatches</a></td><td>15←≢1-5,7-16</td><td>0</td><td>15</td></tr>
<tr class="uncovered"><td><a href="#listing_51" title="Link to listing">#.Launchy.Launchy.NL</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_52" title="Link to listing">#.Launchy.Launchy.Off</a></td><td>1, 2, 4</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_53" title="Link to listing">#.Launchy.Launchy.OnAbout</a></td><td>2, 3</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_54" title="Link to listing">#.Launchy.Launchy.OnActivateApp</a></td><td>4←≢2-5</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_55" title="Link to listing">#.Launchy.Launchy.OnChangeRide</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_56" title="Link to listing">#.Launchy.Launchy.OnChangeWinCoord</a></td><td>3, 4, 5</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_57" title="Link to listing">#.Launchy.Launchy.OnChanged</a></td><td>2</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_58" title="Link to listing">#.Launchy.Launchy.OnCheckForNewVersion</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_59" title="Link to listing">#.Launchy.Launchy.OnCreateLNK</a></td><td>19←≢1-19</td><td>0</td><td>19</td></tr>
<tr class="uncovered"><td><a href="#listing_60" title="Link to listing">#.Launchy.Launchy.OnDYALOGSTARTUPDEBUG</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_61" title="Link to listing">#.Launchy.Launchy.OnDYALOGSTARTUPSTOP</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_62" title="Link to listing">#.Launchy.Launchy.OnEditCredentials</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_63" title="Link to listing">#.Launchy.Launchy.OnEditINI</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_64" title="Link to listing">#.Launchy.Launchy.OnFileBoxCancel</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_65" title="Link to listing">#.Launchy.Launchy.OnFileBoxOK</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_66" title="Link to listing">#.Launchy.Launchy.OnGitHubReleaseNotes</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_67" title="Link to listing">#.Launchy.Launchy.OnGoToGitHub</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_68" title="Link to listing">#.Launchy.Launchy.OnHandleOption</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_69" title="Link to listing">#.Launchy.Launchy.OnHandleTipToggler</a></td><td>5←≢1-5</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_70" title="Link to listing">#.Launchy.Launchy.OnHelp</a></td><td>10←≢2-11</td><td>0</td><td>10</td></tr>
<tr class="uncovered"><td><a href="#listing_71" title="Link to listing">#.Launchy.Launchy.OnIconify</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_72" title="Link to listing">#.Launchy.Launchy.OnKeyPressInList</a></td><td>15←≢1-7,9-12,14-17</td><td>0</td><td>15</td></tr>
<tr class="uncovered"><td><a href="#listing_73" title="Link to listing">#.Launchy.Launchy.OnKeyPressInPortNo</a></td><td>10←≢1-10</td><td>0</td><td>10</td></tr>
<tr class="uncovered"><td><a href="#listing_74" title="Link to listing">#.Launchy.Launchy.OnKeyPressInPushButton</a></td><td>4←≢1-4</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_75" title="Link to listing">#.Launchy.Launchy.OnLaunchAPL</a></td><td>11←≢1-7,9-12</td><td>0</td><td>11</td></tr>
<tr class="uncovered"><td><a href="#listing_76" title="Link to listing">#.Launchy.Launchy.OnLetsCrash</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_77" title="Link to listing">#.Launchy.Launchy.OnLoadPatch</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_78" title="Link to listing">#.Launchy.Launchy.OnLoadPatches</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_79" title="Link to listing">#.Launchy.Launchy.OnMakeDefault</a></td><td>12←≢1-12</td><td>0</td><td>12</td></tr>
<tr class="uncovered"><td><a href="#listing_80" title="Link to listing">#.Launchy.Launchy.OnMenuOptionsDropDown</a></td><td>5←≢2-6</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_81" title="Link to listing">#.Launchy.Launchy.OnMoveFocusToList</a></td><td>4←≢1-4</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_82" title="Link to listing">#.Launchy.Launchy.OnOnlineHelp</a></td><td>6←≢1-6</td><td>0</td><td>6</td></tr>
<tr class="uncovered"><td><a href="#listing_83" title="Link to listing">#.Launchy.Launchy.OnPortGotFocus</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_84" title="Link to listing">#.Launchy.Launchy.OnPortLostFocus</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_85" title="Link to listing">#.Launchy.Launchy.OnPresetAPLs</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_86" title="Link to listing">#.Launchy.Launchy.OnQuit</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_87" title="Link to listing">#.Launchy.Launchy.OnRegEdit</a></td><td>6←≢1-6</td><td>0</td><td>6</td></tr>
<tr class="uncovered"><td><a href="#listing_88" title="Link to listing">#.Launchy.Launchy.OnReleaseNotes</a></td><td>10←≢1-10</td><td>0</td><td>10</td></tr>
<tr class="uncovered"><td><a href="#listing_89" title="Link to listing">#.Launchy.Launchy.OnResetDefaults</a></td><td>14←≢2-15</td><td>0</td><td>14</td></tr>
<tr class="uncovered"><td><a href="#listing_90" title="Link to listing">#.Launchy.Launchy.OnRightAlign</a></td><td>4←≢2-5</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_91" title="Link to listing">#.Launchy.Launchy.OnRunRide</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_92" title="Link to listing">#.Launchy.Launchy.OnSelectAplVersion</a></td><td>10←≢2-11</td><td>0</td><td>10</td></tr>
<tr class="uncovered"><td><a href="#listing_93" title="Link to listing">#.Launchy.Launchy.OnSelectDefault</a></td><td>6←≢1-6</td><td>0</td><td>6</td></tr>
<tr class="uncovered"><td><a href="#listing_94" title="Link to listing">#.Launchy.Launchy.OnSelectLink</a></td><td>5←≢1-5</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_95" title="Link to listing">#.Launchy.Launchy.OnSelectList</a></td><td>6←≢1-6</td><td>0</td><td>6</td></tr>
<tr class="uncovered"><td><a href="#listing_96" title="Link to listing">#.Launchy.Launchy.OnSelectTriggerShortcutKeyForLKN</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_97" title="Link to listing">#.Launchy.Launchy.OnSpinnerKeyPress</a></td><td>10←≢2-11</td><td>0</td><td>10</td></tr>
<tr class="uncovered"><td><a href="#listing_98" title="Link to listing">#.Launchy.Launchy.OnStandardKeyPress</a></td><td>9←≢2-10</td><td>0</td><td>9</td></tr>
<tr class="uncovered"><td><a href="#listing_99" title="Link to listing">#.Launchy.Launchy.OnStartExplorer</a></td><td>2, 3</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_100" title="Link to listing">#.Launchy.Launchy.OnStartExplorerInHelpDir</a></td><td>2, 3</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_101" title="Link to listing">#.Launchy.Launchy.OnTogglePassword</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_102" title="Link to listing">#.Launchy.Launchy.RefreshWindowCoords</a></td><td>5←≢4-8</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_103" title="Link to listing">#.Launchy.Launchy.RestoreDefaults</a></td><td>4←≢2-5</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_104" title="Link to listing">#.Launchy.Launchy.SaveInRegistry</a></td><td>9←≢2-10</td><td>0</td><td>9</td></tr>
<tr class="uncovered"><td><a href="#listing_105" title="Link to listing">#.Launchy.Launchy.SayGoodByeAfterError</a></td><td>17←≢1-8,10,12-19</td><td>0</td><td>17</td></tr>
<tr class="uncovered"><td><a href="#listing_106" title="Link to listing">#.Launchy.Launchy.SelectRide</a></td><td>10←≢5-11,13-15</td><td>0</td><td>10</td></tr>
<tr class="uncovered"><td><a href="#listing_107" title="Link to listing">#.Launchy.Launchy.SetActiveTo</a></td><td>2, 3</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_108" title="Link to listing">#.Launchy.Launchy.ShowCmd</a></td><td>7←≢2-8</td><td>0</td><td>7</td></tr>
<tr class="uncovered"><td><a href="#listing_109" title="Link to listing">#.Launchy.Launchy.ShowMsg2</a></td><td>38←≢1-4,6-12,14-18,20,23-32,35-42,44-45,47</td><td>0</td><td>38</td></tr>
<tr class="uncovered"><td><a href="#listing_110" title="Link to listing">#.Launchy.Launchy.StartExplorer</a></td><td>5←≢1-5</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_111" title="Link to listing">#.Launchy.Launchy.StartRide</a></td><td>18←≢1-8,10-11,13-19,21</td><td>0</td><td>18</td></tr>
<tr class="uncovered"><td><a href="#listing_112" title="Link to listing">#.Launchy.Launchy.TellCommunicationWithGitHubFailed</a></td><td>5←≢1-5</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_113" title="Link to listing">#.Launchy.Launchy.TellDownloadProblem</a></td><td>5←≢1-5</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_114" title="Link to listing">#.Launchy.Launchy.TellErrorWhileCheckingForBetterVersion</a></td><td>4←≢1-4</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_115" title="Link to listing">#.Launchy.Launchy.TellLaunchyIsUp2Date</a></td><td>4←≢1-4</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_116" title="Link to listing">#.Launchy.Launchy.TellRegistryProblem</a></td><td>6←≢1-6</td><td>0</td><td>6</td></tr>
<tr class="uncovered"><td><a href="#listing_117" title="Link to listing">#.Launchy.Launchy.ThereIsAWorkingDir</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_118" title="Link to listing">#.Launchy.Launchy.ValueOrDefault</a></td><td>3, 4, 5</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_119" title="Link to listing">#.Launchy.Launchy.WantToExecute</a></td><td>50←≢1-2,4-13,15-19,21-30,33-40,42-49,51-52,54-57,59</td><td>0</td><td>50</td></tr>
<tr class="uncovered"><td><a href="#listing_120" title="Link to listing">#.Launchy.Launchy.YesNoCancel</a></td><td>9←≢2-10</td><td>0</td><td>9</td></tr>
<tr class="uncovered"><td><a href="#listing_121" title="Link to listing">#.Launchy.Launchy.YesOrNo</a></td><td>8←≢1-8</td><td>0</td><td>8</td></tr>
<tr class="uncovered"><td><a href="#listing_122" title="Link to listing">#.Launchy.Launchy.YesOrNo2</a></td><td>47←≢1-4,6-15,17-26,29-36,38-45,47-48,50-53,55</td><td>0</td><td>47</td></tr>
<tr class="uncovered"><td><a href="#listing_123" title="Link to listing">#.Launchy.Launchy.RefNamespace.∆List</a></td><td>7←≢5-11</td><td>0</td><td>7</td></tr>
<tr class="uncovered"><td><a href="#listing_124" title="Link to listing">#.Launchy.Launchy.RefNamespace.∆GetRefs</a></td><td>4←≢4-7</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_125" title="Link to listing">#.Launchy.Launchy.RefNamespace.∆GetMethods</a></td><td>3</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_126" title="Link to listing">#.Launchy.Launchy.SelectAPL.CreateGUI2</a></td><td>54←≢1-11,13-19,21-33,35,37-39,42-43,45,47,49-54,56-63,65</td><td>0</td><td>54</td></tr>
<tr class="uncovered"><td><a href="#listing_127" title="Link to listing">#.Launchy.Launchy.SelectAPL.DQ</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr><td><a href="#listing_128" title="Link to listing">#.Launchy.Launchy.CheckIni_Ride</a></td><td>12←≢2-13</td><td>8</td><td>13</td></tr>
<tr><td><a href="#listing_129" title="Link to listing">#.Launchy.Launchy.CheckForInvalidIniEntries</a></td><td>8←≢3-10</td><td>20</td><td>10</td></tr>
<tr><td><a href="#listing_130" title="Link to listing">#.Launchy.Launchy.CheckIni_DefaultDyalog</a></td><td>12←≢4-15</td><td>20</td><td>15</td></tr>
<tr><td><a href="#listing_131" title="Link to listing">#.Launchy.Launchy.ProcessIniFile</a></td><td>19←≢11,13-20,22-25,28-29,32-33,41-42</td><td>37</td><td>30</td></tr>
<tr><td><a href="#listing_132" title="Link to listing">#.Launchy.Launchy.CheckIni_WsSizeDefault</a></td><td>8←≢4,8-14</td><td>38</td><td>13</td></tr>
<tr><td><a href="#listing_133" title="Link to listing">#.Launchy.Launchy.CheckIni_WsSize</a></td><td>8←≢10-17</td><td>50</td><td>16</td></tr>
<tr><td><a href="#listing_134" title="Link to listing">#.Launchy.Launchy.EnableEarlyRide</a></td><td>4←≢8-11</td><td>50</td><td>8</td></tr>
<tr><td><a href="#listing_135" title="Link to listing">#.Launchy.Launchy.GetInstalledAPLs</a></td><td>5←≢5-9</td><td>55</td><td>11</td></tr>
<tr><td><a href="#listing_136" title="Link to listing">#.Launchy.Launchy.CreateVersions</a></td><td>18←≢8-9,11-13,15-17,19,45-53</td><td>59</td><td>44</td></tr>
<tr><td><a href="#listing_137" title="Link to listing">#.Launchy.Launchy.MassageAplList</a></td><td>6←≢5-10</td><td>60</td><td>15</td></tr>
<tr><td><a href="#listing_138" title="Link to listing">#.Launchy.Launchy.GetWinCoords</a></td><td>4←≢6-9</td><td>64</td><td>11</td></tr>
<tr><td><a href="#listing_139" title="Link to listing">#.Launchy.Launchy.HasWorkDir</a></td><td>3</td><td>67</td><td>3</td></tr>
<tr><td><a href="#listing_140" title="Link to listing">#.Launchy.Launchy.IniHas_DyalogDefault</a></td><td>3</td><td>67</td><td>3</td></tr>
<tr><td><a href="#listing_141" title="Link to listing">#.Launchy.Launchy.GetCaption</a></td><td>3</td><td>75</td><td>4</td></tr>
<tr><td><a href="#listing_142" title="Link to listing">#.Launchy.Launchy.Init1</a></td><td>12, 15, 18</td><td>77</td><td>13</td></tr>
<tr><td><a href="#listing_143" title="Link to listing">#.Launchy.Launchy.CreateGlobals</a></td><td>4←≢12-14,18</td><td>80</td><td>20</td></tr>
<tr><td><a href="#listing_144" title="Link to listing">#.Launchy.Launchy.Shutdown</a></td><td>6</td><td>83</td><td>6</td></tr>
<tr><td><a href="#listing_145" title="Link to listing">#.Launchy.Launchy.CreateRide</a></td><td>13</td><td>94</td><td>16</td></tr>
<tr><td><a href="#listing_146" title="Link to listing">#.Launchy.Launchy.Run</a></td><td>14</td><td>95</td><td>19</td></tr>
<tr><td><a href="#listing_147" title="Link to listing">#.Launchy.Launchy.CreateForm</a></td><td>3</td><td>97</td><td>29</td></tr>
<tr class="fullyCovered"><td><a href="#listing_148" title="Link to listing">#.Launchy.Launchy.AddPosnAndSize</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_149" title="Link to listing">#.Launchy.Launchy.CheckIni</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_150" title="Link to listing">#.Launchy.Launchy.CloseForm</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_151" title="Link to listing">#.Launchy.Launchy.CopyTips</a></td><td></td><td>100</td><td>4</td></tr>
<tr class="fullyCovered"><td><a href="#listing_152" title="Link to listing">#.Launchy.Launchy.CreateButtons</a></td><td></td><td>100</td><td>32</td></tr>
<tr class="fullyCovered"><td><a href="#listing_153" title="Link to listing">#.Launchy.Launchy.CreateCommandLine</a></td><td></td><td>100</td><td>24</td></tr>
<tr class="fullyCovered"><td><a href="#listing_154" title="Link to listing">#.Launchy.Launchy.CreateDebugFlags</a></td><td></td><td>100</td><td>20</td></tr>
<tr class="fullyCovered"><td><a href="#listing_155" title="Link to listing">#.Launchy.Launchy.CreateFlags</a></td><td></td><td>100</td><td>60</td></tr>
<tr class="fullyCovered"><td><a href="#listing_156" title="Link to listing">#.Launchy.Launchy.CreateGui</a></td><td></td><td>100</td><td>15</td></tr>
<tr class="fullyCovered"><td><a href="#listing_157" title="Link to listing">#.Launchy.Launchy.CreateMenu_Edit</a></td><td></td><td>100</td><td>16</td></tr>
<tr class="fullyCovered"><td><a href="#listing_158" title="Link to listing">#.Launchy.Launchy.CreateMenu_Explore</a></td><td></td><td>100</td><td>12</td></tr>
<tr class="fullyCovered"><td><a href="#listing_159" title="Link to listing">#.Launchy.Launchy.CreateMenu_File</a></td><td></td><td>100</td><td>22</td></tr>
<tr class="fullyCovered"><td><a href="#listing_160" title="Link to listing">#.Launchy.Launchy.CreateMenu_Help</a></td><td></td><td>100</td><td>38</td></tr>
<tr class="fullyCovered"><td><a href="#listing_161" title="Link to listing">#.Launchy.Launchy.CreateMenu_Options</a></td><td></td><td>100</td><td>39</td></tr>
<tr class="fullyCovered"><td><a href="#listing_162" title="Link to listing">#.Launchy.Launchy.CreateMenubar</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_163" title="Link to listing">#.Launchy.Launchy.CreateStartupParms</a></td><td></td><td>100</td><td>18</td></tr>
<tr class="fullyCovered"><td><a href="#listing_164" title="Link to listing">#.Launchy.Launchy.CreateStatusbar</a></td><td></td><td>100</td><td>11</td></tr>
<tr class="fullyCovered"><td><a href="#listing_165" title="Link to listing">#.Launchy.Launchy.CreateTipObject</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_166" title="Link to listing">#.Launchy.Launchy.CreateWsSize</a></td><td></td><td>100</td><td>20</td></tr>
<tr class="fullyCovered"><td><a href="#listing_167" title="Link to listing">#.Launchy.Launchy.DQ</a></td><td></td><td>100</td><td>4</td></tr>
<tr class="fullyCovered"><td><a href="#listing_168" title="Link to listing">#.Launchy.Launchy.Find_RIDE_Versions</a></td><td></td><td>100</td><td>17</td></tr>
<tr class="fullyCovered"><td><a href="#listing_169" title="Link to listing">#.Launchy.Launchy.GetAplLauncherRegistryKey</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_170" title="Link to listing">#.Launchy.Launchy.GetDefaultFromRegistry</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_171" title="Link to listing">#.Launchy.Launchy.GetListOfAPLs</a></td><td></td><td>100</td><td>12</td></tr>
<tr class="fullyCovered"><td><a href="#listing_172" title="Link to listing">#.Launchy.Launchy.GetProperAPL_FontSize</a></td><td></td><td>100</td><td>5</td></tr>
<tr class="fullyCovered"><td><a href="#listing_173" title="Link to listing">#.Launchy.Launchy.GetRegPathForCurrentDyalogVersion</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_174" title="Link to listing">#.Launchy.Launchy.GetRegPathForDyalog</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_175" title="Link to listing">#.Launchy.Launchy.GetRideMsg</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_176" title="Link to listing">#.Launchy.Launchy.HandleTips</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_177" title="Link to listing">#.Launchy.Launchy.Init2</a></td><td></td><td>100</td><td>4</td></tr>
<tr class="fullyCovered"><td><a href="#listing_178" title="Link to listing">#.Launchy.Launchy.MassageAplList_</a></td><td></td><td>100</td><td>10</td></tr>
<tr class="fullyCovered"><td><a href="#listing_179" title="Link to listing">#.Launchy.Launchy.OnClose</a></td><td></td><td>100</td><td>4</td></tr>
<tr class="fullyCovered"><td><a href="#listing_180" title="Link to listing">#.Launchy.Launchy.PolishPath_RIDE</a></td><td></td><td>100</td><td>5</td></tr>
<tr class="fullyCovered"><td><a href="#listing_181" title="Link to listing">#.Launchy.Launchy.PolishStatusbarSize</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_182" title="Link to listing">#.Launchy.Launchy.SEP</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_183" title="Link to listing">#.Launchy.Launchy.SavePropsInRegistry</a></td><td></td><td>100</td><td>19</td></tr>
<tr class="fullyCovered"><td><a href="#listing_184" title="Link to listing">#.Launchy.Launchy.ScreenSize</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_185" title="Link to listing">#.Launchy.Launchy.SetScaledPixel</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_186" title="Link to listing">#.Launchy.Launchy.ToggleTipVisibility</a></td><td></td><td>100</td><td>7</td></tr>
<tr class="fullyCovered"><td><a href="#listing_187" title="Link to listing">#.Launchy.Launchy.Version</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_188" title="Link to listing">#.Launchy.Launchy.RefNamespace.Create</a></td><td></td><td>100</td><td>3</td></tr>
</tbody>
</table>
</div>
<script>
$(document).ready(function() {
    var oTable;
    oTable = $("#percent").DataTable( {
        paging:   false,
        ordering: true,
        info:     true,
        fixedHeader: true,
        order: [2,"asc"],
        dom: "Bft",
        drawCallback: function( settings ) {
             var api = this.api();
             $('.header[id^="listing_"]').next().addBack().css("display","none");
             api.rows( {page:"current"} ).data().each(function(data){
              id = data[0];
              id = id.match(/"(\#.*?)"/);
              if (id){$(id[1]).next().addBack().css("display","block");}
             })
        },      
        buttons: [
        {
            text: "Partly covered (20)",
            titleAttr: "50%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^(?!(0%|100%)).*";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Uncovered (127)",
            titleAttr: "0%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^0%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Fully covered (41)",
            titleAttr: "100%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "100%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "All (188)",
            titleAttr: "all",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = ".";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
    ],
 
        columnDefs: [
            {className: "align-right", targets: [2,3]
            },
            {
                render: function ( data, type, row, meta ) {
                            return data+"%" ;        
                        },
                targets: 2
            }
        ]             
    } );
    oTable.button(0).trigger();

} );    
</script>
<h2>Listings</h2>
<code class="header" id="listing_1">#.Launchy.Launchy.About &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←About n</code>
<code> [1]  ⍝ Called by OnAbout</code>
<code class="emphasize">→[2]   r←⍬</code>
<code class="emphasize">→[3]   tx←''</code>
<code class="emphasize">→[4]   tx,←⊂'Version ',⊃{⍺,' from ',⍵}/1↓Version</code>
<code class="emphasize">→[5]   tx,←⊂'Homepage:'</code>
<code class="emphasize">→[6]   tx,←⊂'https://github.com/aplteam/Launchy'</code>
<code> [7]  </code>
<code class="emphasize">→[8]   n2←⎕NS''</code>
<code class="emphasize">→[9]   ∆←''</code>
<code class="emphasize">→[10]  ∆,←⊂'Caption' 'About Launchy'</code>
<code class="emphasize">→[11]  ∆,←⊂'Posn'(n.Form.Posn+20 50)</code>
<code class="emphasize">→[12]  ∆,←⊂'Size'(300 400)</code>
<code class="emphasize">→[13]  ∆,←⊂'MinButton' 0</code>
<code class="emphasize">→[14]  ∆,←⊂'MaxButton' 0</code>
<code class="emphasize">→[15]  ∆,←⊂'SysMenu' 0</code>
<code class="emphasize">→[16]  n2.Form←n.Form.⎕NEW'Form'∆</code>
<code class="emphasize">→[17]  n2.LinkFont←⎕NEW'Font'(('weight' 800)('Underline' 1))</code>
<code> [18] </code>
<code class="emphasize">→[19]  posn←15 15</code>
<code class="emphasize">→[20]  i←1</code>
<code class="emphasize">→[21]  links←''</code>
<code class="emphasize">→[22]  :For i :In ⍳⍴tx</code>
<code class="emphasize">→[23]      ∆←''</code>
<code class="emphasize">→[24]      ∆,←⊂'Caption'(i⊃tx)</code>
<code class="emphasize">→[25]      ∆,←⊂'Posn'posn</code>
<code class="emphasize">→[26]      ∆,←⊂'Attach'(4⍴'Top' 'Left')</code>
<code class="emphasize">→[27]      :If isLink←'https://'{⍺≡(⍴⍺)↑⍵}i⊃tx</code>
<code class="emphasize">→[28]          ∆,←⊂'FCol'(0 0 255)</code>
<code class="emphasize">→[29]          ∆,←⊂'FontObj'n2.LinkFont</code>
<code> [30] </code>
<code> [31]      :EndIf</code>
<code class="emphasize">→[32]      ref←n2.Form.⎕NEW'Label'∆</code>
<code class="emphasize">→[33]      posn[1]+←ref.Size[1]</code>
<code class="emphasize">→[34]      ⍎'n2.Field',(¯2↑'0',⍕i),'←ref'</code>
<code class="emphasize">→[35]      :If isLink</code>
<code class="emphasize">→[36]          links,←ref</code>
<code> [37]      :EndIf</code>
<code> [38]  :EndFor</code>
<code class="emphasize">→[39]  :If ~0∊⍴links</code>
<code class="emphasize">→[40]      links.onMouseUp←⊂'OnSelectLink'</code>
<code> [41]  :EndIf</code>
<code> [42] </code>
<code class="emphasize">→[43]  ∆←''</code>
<code class="emphasize">→[44]  ∆,←⊂'Caption' 'Close'</code>
<code class="emphasize">→[45]  ∆,←⊂'Posn'((20+⊃AddPosnAndSize ref),15)</code>
<code class="emphasize">→[46]  ∆,←⊂'Size'(⍬ 120)</code>
<code class="emphasize">→[47]  ∆,←⊂'Default' 1</code>
<code class="emphasize">→[48]  ∆,←⊂'Cancel' 1</code>
<code class="emphasize">→[49]  n2.Close←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[50]  n2.Close.onSelect←1</code>
<code class="emphasize">→[51]  n2.Form.Size←((15+⊃AddPosnAndSize n2.Close),30+⌈/{2⊃AddPosnAndSize ⍵}¨⎕WN n2.Form)</code>
<code class="emphasize">→[52]  ⎕DQ n2.Form</code>
<code> [53] ⍝Done</code>
</div>
<code class="header" id="listing_2">#.Launchy.Launchy.AskForKeyboardShortcutForLNK &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←AskForKeyboardShortcutForLNK n</code>
<code> [1]  ⍝</code>
<code class="emphasize">→[2]   r←''</code>
<code class="emphasize">→[3]   n2←⎕NS''</code>
<code class="emphasize">→[4]   ∆←''</code>
<code class="emphasize">→[5]   ∆,←⊂'Caption' 'Launchy: LNK Keyboard Shortcut'</code>
<code class="emphasize">→[6]   ∆,←⊂'Size'(180 400)</code>
<code class="emphasize">→[7]   ∆,←⊂'Posn'(n.Form.Posn+10)</code>
<code class="emphasize">→[8]   ∆,←⊂'MinButton' 0</code>
<code class="emphasize">→[9]   ∆,←⊂'MaxButton' 0</code>
<code class="emphasize">→[10]  n2.Form←n.Form.⎕NEW'Form'∆</code>
<code> [11] </code>
<code class="emphasize">→[12]  ∆←''</code>
<code class="emphasize">→[13]  ∆,←⊂'Posn'(10 10)</code>
<code class="emphasize">→[14]  ∆,←⊂'Caption' '&amp;Define shortcut key for starting Dyalog'</code>
<code class="emphasize">→[15]  ∆,←⊂'Style' 'Check'</code>
<code class="emphasize">→[16]  n2.YesNo←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[17]  n2.YesNo.onSelect←'OnSelectTriggerShortcutKeyForLKN'</code>
<code> [18] </code>
<code class="emphasize">→[19]  ∆←''</code>
<code class="emphasize">→[20]  ∆,←⊂'Posn'(35 10)</code>
<code class="emphasize">→[21]  ∆,←⊂'Caption' 'Modifier:'</code>
<code class="emphasize">→[22]  n2.Label1←n2.Form.⎕NEW'Label'∆</code>
<code> [23] </code>
<code class="emphasize">→[24]  ∆←''</code>
<code class="emphasize">→[25]  ∆,←⊂'Posn'(60 10)</code>
<code class="emphasize">→[26]  ∆,←⊂'Size'(⍬ 140)</code>
<code class="emphasize">→[27]  ∆,←⊂'Font'n.aplFont</code>
<code class="emphasize">→[28]  items←'Ctrl' 'Shift' 'Alt' 'Ctrl+Shift' 'Ctrl+Alt' 'Shift+Alt' 'Ctrl+Shift+Alt'</code>
<code class="emphasize">→[29]  ∆,←⊂'Items'items</code>
<code class="emphasize">→[30]  ∆,←⊂'SelItems'((≢items)↑1)</code>
<code class="emphasize">→[31]  ∆,←⊂'Active' 0</code>
<code class="emphasize">→[32]  n2.Modifier←n2.Form.⎕NEW'Combo'∆</code>
<code class="emphasize">→[33]  n2.Modifier.Text←'Ctrl'</code>
<code> [34] </code>
<code class="emphasize">→[35]  ∆←''</code>
<code class="emphasize">→[36]  ∆,←⊂'Posn'(35(20+2⊃+⌿↑n2.Modifier.(Posn Size)))</code>
<code class="emphasize">→[37]  ∆,←⊂'Caption' 'Trigger key:'</code>
<code class="emphasize">→[38]  n2.Label2←n2.Form.⎕NEW'Label'∆</code>
<code> [39] </code>
<code class="emphasize">→[40]  ∆←''</code>
<code class="emphasize">→[41]  ∆,←⊂'Posn'(60(20+2⊃+⌿↑n2.Modifier.(Posn Size)))</code>
<code class="emphasize">→[42]  ∆,←⊂'Size'(⍬ 100)</code>
<code class="emphasize">→[43]  ∆,←⊂'Font'n.aplFont</code>
<code class="emphasize">→[44]  items←(,¨⎕A,⎕D),'F',¨¯2↑¨'0',¨⍕¨⍳12</code>
<code class="emphasize">→[45]  ∆,←⊂'Items'items</code>
<code class="emphasize">→[46]  ∆,←⊂'SelItems'((≢items)↑1)</code>
<code class="emphasize">→[47]  ∆,←⊂'Active' 0</code>
<code class="emphasize">→[48]  n2.TriggerKey←n2.Form.⎕NEW'Combo'∆</code>
<code> [49] </code>
<code class="emphasize">→[50]  ∆←''</code>
<code class="emphasize">→[51]  ∆,←⊂'Posn'((15+1⊃+⌿↑n2.TriggerKey.(Posn Size))10)</code>
<code class="emphasize">→[52]  ∆,←⊂'Caption' 'Note that you can start only just ONE instance of Dyalog with this.'</code>
<code class="emphasize">→[53]  n2.Label3←n2.Form.⎕NEW'Label'∆</code>
<code> [54] </code>
<code class="emphasize">→[55]  ∆←''</code>
<code class="emphasize">→[56]  ∆,←⊂'Caption' '&amp;OK'</code>
<code class="emphasize">→[57]  n2.ok←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[58]  n2.ok.Size[1]+←⌈0.15×n2.ok.Size[1]</code>
<code class="emphasize">→[59]  n2.ok.Size[2]←100</code>
<code class="emphasize">→[60]  n2.ok.Posn←(n2.Form.Size[1]-n2.ok.Size[1]+10)10</code>
<code class="emphasize">→[61]  n2.ok.onSelect←1</code>
<code class="emphasize">→[62]  n2.Form.n←n2</code>
<code> [63] </code>
<code class="emphasize">→[64]  :If 0&lt;≢res←⎕DQ n2.Form</code>
<code class="emphasize">→[65]  :AndIf n2.ok≡1⊃res</code>
<code class="emphasize">→[66]  :AndIf n2.YesNo.State</code>
<code class="emphasize">→[67]      r←n2.Modifier.Text,'+',n2.TriggerKey.Text</code>
<code> [68]  :EndIf</code>
<code class="emphasize">→[69]  :Trap 0 ⋄ 2 ⎕NQ n2.Form'Close' ⋄ :EndTrap</code>
<code> [70]  ⍝Done</code>
</div>
<code class="header" id="listing_3">#.Launchy.Launchy.AskForRideAndPort &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (flag port rideExe)←AskForRideAndPort y</code>
<code class="emphasize">→[1]   (n caption)←2↑y,⊂''</code>
<code class="emphasize">→[2]   flag←0 ⋄ rideExe←''</code>
<code class="emphasize">→[3]   port←n.∆Port</code>
<code> [4]  </code>
<code class="emphasize">→[5]   n2←⎕NS''</code>
<code> [6]  </code>
<code class="emphasize">→[7]   ∆←''</code>
<code class="emphasize">→[8]   ∆,←⊂'Posn'(50 50+n.Form.Posn)</code>
<code class="emphasize">→[9]   ∆,←⊂'Size'(160 310)</code>
<code class="emphasize">→[10]  ∆,←⊂'Caption'('Ride for ',caption)</code>
<code class="emphasize">→[11]  ∆,←⊂'Coord' 'Pixel'</code>
<code class="emphasize">→[12]  ∆,←⊂'SysMenu' 0</code>
<code class="emphasize">→[13]  ∆,←⊂'Sizeable' 0</code>
<code class="emphasize">→[14]  n2.Form←n.Form.⎕NEW'Form'∆</code>
<code> [15] </code>
<code class="emphasize">→[16]  n2.Tip←⎕NEW⊂'TipField'</code>
<code> [17] </code>
<code class="emphasize">→[18]  ∆←''</code>
<code class="emphasize">→[19]  ∆,←⊂'Caption' 'Port to be used:'</code>
<code class="emphasize">→[20]  ∆,←⊂'Posn'(15 15)</code>
<code class="emphasize">→[21]  n2.RideListen←n2.Form.⎕NEW'Label'∆</code>
<code> [22] </code>
<code class="emphasize">→[23]  ∆←''</code>
<code class="emphasize">→[24]  ∆,←⊂'Posn'((n2.RideListen.Posn[1]+2),(2⊃AddPosnAndSize n2.RideListen))</code>
<code class="emphasize">→[25]  ∆,←⊂'Size'(⍬ 50)</code>
<code class="emphasize">→[26]  ∆,←⊂'FieldType' 'Numeric'</code>
<code class="emphasize">→[27]  ∆,←⊂'Value'n.∆Port</code>
<code class="emphasize">→[28]  ∆,←⊂'MaxLength' 7</code>
<code class="emphasize">→[29]  ∆,←⊂'Active' 1</code>
<code class="emphasize">→[30]  ∆,←⊂'TipObj'n2.Tip</code>
<code class="emphasize">→[31]  ∆,←⊂'Tip'('Increase with PgUp ' 'Decrease with PgDn ' 'Restore with F3 ')</code>
<code class="emphasize">→[32]  n2.Port←n2.Form.⎕NEW'Edit'∆</code>
<code class="emphasize">→[33]  n2.Port.Size-←5</code>
<code class="emphasize">→[34]  n2.Port.(onGotFocus onLostFocus)←'OnPortGotFocus' 'OnPortLostFocus'</code>
<code class="emphasize">→[35]  n2.Port.onKeyPress←'OnKeyPressInPortNo'n</code>
<code> [36] </code>
<code class="emphasize">→[37]  ∆←''</code>
<code class="emphasize">→[38]  ∆,←⊂'Posn'((20+⊃AddPosnAndSize n2.Port),15)</code>
<code class="emphasize">→[39]  ∆,←⊂'Caption' 'Ride &amp;version:'</code>
<code class="emphasize">→[40]  n2.Label2←n2.Form.⎕NEW'Label'∆</code>
<code> [41] </code>
<code class="emphasize">→[42]  ∆←''</code>
<code class="emphasize">→[43]  ∆,←⊂'Items'(G.RideVersions[;1])</code>
<code class="emphasize">→[44]  ∆,←⊂'SelItems'(G.RideVersions[;2]≡¨⊂G.RideVersion)</code>
<code class="emphasize">→[45]  ∆,←⊂'Posn'(n2.Label2.Posn[1],(2⊃AddPosnAndSize n2.Label2))</code>
<code class="emphasize">→[46]  ∆,←⊂'Size'(⍬ 80)</code>
<code class="emphasize">→[47]  n2.RideVersion←n2.Form.⎕NEW'Combo'∆</code>
<code> [48] </code>
<code class="emphasize">→[49]  ∆←''</code>
<code class="emphasize">→[50]  ∆,←⊂'Caption' 'Give me a Ride'</code>
<code class="emphasize">→[51]  ∆,←⊂'Default' 1</code>
<code class="emphasize">→[52]  ∆,←⊂'Size'((n.reset.Size[1]),90)</code>
<code class="emphasize">→[53]  n2.Yes←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[54]  n2.Yes.Size[1]+←2</code>
<code class="emphasize">→[55]  n2.Yes.Posn←(n2.Form.Size[1]-n2.Yes.Size[1]+10),10</code>
<code> [56] </code>
<code class="emphasize">→[57]  ∆←''</code>
<code class="emphasize">→[58]  ∆,←⊂'Caption' '&amp;Just APL'</code>
<code class="emphasize">→[59]  ∆,←⊂'Size'((n.reset.Size[1]),n2.Yes.Size[2])</code>
<code class="emphasize">→[60]  n2.No←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[61]  n2.No.Size[1]←n2.Yes.Size[1]</code>
<code class="emphasize">→[62]  n2.No.Posn←(n2.Yes.Posn[1],10+2⊃AddPosnAndSize n2.Yes)</code>
<code> [63] </code>
<code class="emphasize">→[64]  ∆←''</code>
<code class="emphasize">→[65]  ∆,←⊂'Caption' 'Cancel'</code>
<code class="emphasize">→[66]  ∆,←⊂'Cancel' 1</code>
<code class="emphasize">→[67]  ∆,←⊂'Size'((n.reset.Size[1]),n2.Yes.Size[2])</code>
<code class="emphasize">→[68]  n2.Cancel←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[69]  n2.Cancel.Size[1]←n2.Yes.Size[1]</code>
<code class="emphasize">→[70]  n2.Cancel.Posn←(n2.Yes.Posn[1],n2.Form.Size[2]-n2.Yes.Size[2]+10)</code>
<code> [71] </code>
<code class="emphasize">→[72]  n2.Buttons←n2.(Yes No Cancel)</code>
<code class="emphasize">→[73]  n2.Buttons.onSelect←1</code>
<code class="emphasize">→[74]  n2.Form.n←n2</code>
<code> [75] </code>
<code class="emphasize">→[76]  :Repeat</code>
<code class="emphasize">→[77]      ⎕NQ n2.Port'GotFocus' ⋄ res←⎕DQ n2.Form</code>
<code class="emphasize">→[78]      :If n2.Cancel≡⊃res</code>
<code class="emphasize">→[79]          flag←¯1</code>
<code> [80]      :Else</code>
<code class="emphasize">→[81]          :If n2.Yes≡⊃res</code>
<code class="emphasize">→[82]              :If ~0∊⍴n2.Port.Text</code>
<code class="emphasize">→[83]              :AndIf ⊃⎕VFI n2.Port.Text</code>
<code class="emphasize">→[84]              :AndIf {(0&lt;⍵)∧(65536&gt;⍵)}n2.Port.Value</code>
<code class="emphasize">→[85]                  flag←1</code>
<code class="emphasize">→[86]                  port←n2.Port.Value</code>
<code class="emphasize">→[87]                  n.∆Port←port</code>
<code> [88]              :EndIf</code>
<code class="emphasize">→[89]              rideExe←⊃G.RideVersions[G.RideVersions[;1]⍳n2.RideVersion.(SelItems/Items);2]</code>
<code> [90]          :Else</code>
<code class="emphasize">→[91]              port←flag←0</code>
<code> [92]          :EndIf</code>
<code> [93]      :EndIf</code>
<code class="emphasize">→[94]  :Until flag≢⍬</code>
<code class="emphasize">→[95]  1 ⎕NQ n2.Form'Close'</code>
<code class="emphasize">→[96]  n2.n←⍬</code>
<code> [97] ⍝Done</code>
</div>
<code class="header" id="listing_4">#.Launchy.Launchy.AskForShowCommandLineParms &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> AskForShowCommandLineParms←{</code>
<code class="emphasize">→[1]      ⎕THIS.∆AskForCommandLineParms←0 ⍝ Ask just once per session</code>
<code class="emphasize">→[2]      m←⊂'You have specified parameters on the command line.'</code>
<code class="emphasize">→[3]      m,←⊂'Would you like to display them?'</code>
<code class="emphasize">→[4]      m,←'' '(This question will be asked only once per session)'</code>
<code class="emphasize">→[5]      YesOrNo m</code>
<code> [6]  }</code>
</div>
<code class="header" id="listing_5">#.Launchy.Launchy.CeateMenu_Edit &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CeateMenu_Edit n</code>
<code class="emphasize">→[1]   ∆←''</code>
<code class="emphasize">→[2]   ∆,←⊂'Caption' 'INI file'</code>
<code class="emphasize">→[3]   ∆,←⊂'HintObj'n.statusbarMsg</code>
<code class="emphasize">→[4]   ∆,←⊂'Hint' 'Starts Notepad on the Dyalog launcher''s INI file(s)'</code>
<code class="emphasize">→[5]   n.editINI←n.MenuEdit.⎕NEW'MenuItem'∆</code>
<code class="emphasize">→[6]   n.editINI.onSelect←'OnEditINI'</code>
<code> [7]  </code>
<code class="emphasize">→[8]   ∆←''</code>
<code class="emphasize">→[9]   ∆,←⊂'Caption' 'Edit Registry entries'</code>
<code class="emphasize">→[10]  ∆,←⊂'HintObj'n.statusbarMsg</code>
<code class="emphasize">→[11]  ∆,←⊂'Hint' 'Starts RegEdit on the currently selected version of Dyalog'</code>
<code class="emphasize">→[12]  n.regEdit←n.MenuEdit.⎕NEW'MenuItem'∆</code>
<code class="emphasize">→[13]  n.regEdit.onSelect←'OnRegEdit'</code>
<code> [14] </code>
<code class="emphasize">→[15]  ∆←''</code>
<code class="emphasize">→[16]  ∆,←⊂'Caption' 'DSS credentials'</code>
<code class="emphasize">→[17]  ∆,←⊂'HintObj'n.statusbarMsg</code>
<code class="emphasize">→[18]  ∆,←⊂'Hint' 'Overwrite the DSS credentials for all installed APLs in one step'</code>
<code class="emphasize">→[19]  n.editCredentials←n.MenuEdit.⎕NEW'MenuItem'∆</code>
<code class="emphasize">→[20]  n.editCredentials.onSelect←'OnEditCredentials'</code>
<code> [21] ⍝Done</code>
</div>
<code class="header" id="listing_6">#.Launchy.Launchy.CheckCredentials &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (flag bool)←CheckCredentials versions</code>
<code class="emphasize">→[1]   regPaths←{'HKCU\Software\Dyalog\',⍵,'\Patch\'}¨versions</code>
<code class="emphasize">→[2]   passwords←{##.WinReg.GetString ⍵,'Password'}¨regPaths</code>
<code class="emphasize">→[3]   userids←{##.WinReg.GetString ⍵,'UserID'}¨regPaths</code>
<code class="emphasize">→[4]   :If 0=flag←∧/bool←(0&lt;≢¨userids)∧(0&lt;≢¨passwords)</code>
<code class="emphasize">→[5]       msg←''</code>
<code class="emphasize">→[6]       msg,←⊂'Note that for ',(⍕+/~bool),' Dyalog installation user-id/password is not set:'</code>
<code class="emphasize">→[7]       msg,←'   '∘,¨(~bool)/versions</code>
<code class="emphasize">→[8]       msg,←⊂''</code>
<code class="emphasize">→[9]       msg,←⊂'Would you like to ignore those?'</code>
<code class="emphasize">→[10]      msg,←⊂'(Otherwise execute "Edit &gt; DSS Credentials" before trying again)'</code>
<code class="emphasize">→[11]  :AndIf 'Launchy: Patches'YesOrNo2 msg</code>
<code class="emphasize">→[12]      flag←1</code>
<code> [13]  :EndIf</code>
<code> [14] ⍝Done</code>
</div>
<code class="header" id="listing_7">#.Launchy.Launchy.CheckDefaults &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←CheckDefaults type</code>
<code> [1]  ⍝ Checks which controls are different from defaults and hightlight them.</code>
<code class="emphasize">→[2]   r←1</code>
<code class="emphasize">→[3]   :Select type</code>
<code class="emphasize">→[4]   :Case 'APL_Version'</code>
<code> [5]       ⍝ Not any more</code>
<code class="emphasize">→[6]   :Case 'WSSIZE'</code>
<code class="emphasize">→[7]       wssize←GetWsSize n</code>
<code class="emphasize">→[8]       f←wssize≢Ini.WSSIZE.default</code>
<code class="emphasize">→[9]       n.wssize_Label.BCol←ColorCode f</code>
<code class="emphasize">→[10]  :Case 'DEBUGFLAG'</code>
<code class="emphasize">→[11]      f←Ini.WS_CHECK.default≠⊃⊃n.debug.SelItems/n.debug.Items</code>
<code class="emphasize">→[12]      n.DebugGroup.BCol←ColorCode f</code>
<code class="emphasize">→[13]  :Case 'RIDE'</code>
<code class="emphasize">→[14]      f←n.RIDEflag.State≠Ini.RIDE.tick</code>
<code class="emphasize">→[15]      n.RIDEflag.BCol←ColorCode f</code>
<code class="emphasize">→[16]  :Case 'RUNASADMIN'</code>
<code class="emphasize">→[17]      n.runAsAdmin.BCol←ColorCode×n.runAsAdmin.State</code>
<code class="emphasize">→[18]  :Case 'EXEC_MY_SETUP'</code>
<code class="emphasize">→[19]      n.ExecMySetup.BCol←ColorCode×n.ExecMySetup.State≢1</code>
<code class="emphasize">→[20]  :Case 'STOP_IN_SETUP'</code>
<code class="emphasize">→[21]      n.StopSetup.BCol←ColorCode×n.StopSetup.State≢0</code>
<code class="emphasize">→[22]  :Case 'DYALOGWSLOADEDSTOP'</code>
<code class="emphasize">→[23]      n.DyalogWSLoadedStop.BCol←ColorCode×n.DyalogWSLoadedStop.State≢0</code>
<code class="emphasize">→[24]  :Case 'DYALOGSTARTUPDEBUG'</code>
<code class="emphasize">→[25]      n.DYALOGSTARTUPDEBUG.BCol←ColorCode×n.DYALOGSTARTUPDEBUG.State≢0</code>
<code class="emphasize">→[26]  :Case 'DYALOGSTARTUPSTOP'</code>
<code class="emphasize">→[27]      n.DYALOGSTARTUPSTOP.BCol←ColorCode×n.DYALOGSTARTUPSTOP.State≢0</code>
<code> [28]  :Else</code>
<code class="emphasize">→[29]      .    ⍝ Not yet</code>
<code> [30]  :EndSelect</code>
<code class="emphasize">→[31]  l←n.(AplVersionGroup wssize_Label DebugGroup RIDEflag runAsAdmin ExecMySetup StopSetup DyalogWSLoadedStop)</code>
<code class="emphasize">→[32]  n.reset.Active←∨/0&lt;+/¨l.BCol</code>
<code> [33] ⍝Done</code>
</div>
<code class="header" id="listing_8">#.Launchy.Launchy.CheckDyalogForRunning &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  CheckDyalogForRunning←{</code>
<code class="emphasize">→[1]       v←⍵</code>
<code class="emphasize">→[2]       l←⎕CMD'tasklist'                       ⍝ Get list</code>
<code class="emphasize">→[3]       l←3↓l                                  ⍝ Drop headers</code>
<code class="emphasize">→[4]       m←↑U.{' 'Split DMB ⍵}¨l  ⍝ Transform into matrix</code>
<code class="emphasize">→[5]       m[;1]←⎕C m[;1]</code>
<code class="emphasize">→[6]       0=+/b←m[;1]∊'dyalog.exe' 'dyalogrt.exe' 'dyalog.dll' 'dyalogrt.exe':0</code>
<code class="emphasize">→[7]       m←b⌿m</code>
<code class="emphasize">→[8]       no←+⌿m[;3]∘.≡'Console' 'Services'</code>
<code class="emphasize">→[9]       msg←⊂'Be aware:'</code>
<code class="emphasize">→[10]      msg,←(0≠no)/('Number of Dyalog '∘,¨'EXEs' 'Services',¨⊂' currently running: '),¨⍕¨no</code>
<code class="emphasize">→[11]      ShowMsg2 msg:</code>
<code class="emphasize">→[12]      1:r←0</code>
<code> [13]  }</code>
</div>
<code class="header" id="listing_9">#.Launchy.Launchy.CheckForNewVersion &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←CheckForNewVersion dummy</code>
<code class="emphasize">→[1]   r←⍬</code>
<code class="emphasize">→[2]   api←⎕NEW ##.GitHubAPIv3(,⊂'aplteam')</code>
<code class="emphasize">→[3]   :Trap 0</code>
<code class="emphasize">→[4]       tag←api.GetLatestTag'Launchy'</code>
<code> [5]   :Else</code>
<code class="emphasize">→[6]       TellCommunicationWithGitHubFailed'Launchy'</code>
<code class="emphasize">→[7]       :Return</code>
<code> [8]   :EndTrap</code>
<code class="emphasize">→[9]   flag←api.CheckForUpdate'Launchy'({⍵↑⍨¯1+⌊/⍵⍳'+-'}2⊃Version)</code>
<code class="emphasize">→[10]  :If ~flag</code>
<code class="emphasize">→[11]      TellLaunchyIsUp2Date ⍬</code>
<code> [12]  :Else</code>
<code class="emphasize">→[13]      msg←⊂'There is a better version available on GitHub.'</code>
<code class="emphasize">→[14]      msg,←'' 'Would you like to download this version?'</code>
<code class="emphasize">→[15]      :If YesOrNo msg</code>
<code class="emphasize">→[16]          :Trap 0</code>
<code class="emphasize">→[17]              url←api.GetRelease'Launchy' 'EXE'</code>
<code> [18]          :Else</code>
<code class="emphasize">→[19]              dmx←⎕DMX</code>
<code class="emphasize">→[20]              TellCommunicationWithGitHubFailed'Launchy'</code>
<code class="emphasize">→[21]              :Return</code>
<code> [22]          :EndTrap</code>
<code class="emphasize">→[23]          :If 0=≢url</code>
<code class="emphasize">→[24]              n TellErrorWhileCheckingForBetterVersion''</code>
<code> [25]          :Else</code>
<code class="emphasize">→[26]              A.GoToWebPage url</code>
<code> [27]          :EndIf</code>
<code> [28]      :EndIf</code>
<code> [29]  :EndIf</code>
<code> [30] ⍝Done</code>
</div>
<code class="header" id="listing_10">#.Launchy.Launchy.CheckRc &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> {r}←msg CheckRc rc</code>
<code class="emphasize">→[1]  r←0</code>
<code class="emphasize">→[2]  msg←,⊆msg</code>
<code class="emphasize">→[3]  ((⍴msg)⊃msg)←((⍴msg)⊃msg),'; rc=',⍕rc</code>
<code class="emphasize">→[4]  :If 0≠rc</code>
<code class="emphasize">→[5]      'Launchy problem'ShowMsg2 msg</code>
<code> [6]  :EndIf</code>
</div>
<code class="header" id="listing_11">#.Launchy.Launchy.CheckRide &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> {r}←CheckRide n</code>
<code class="emphasize">→[1]  r←⍬</code>
<code class="emphasize">→[2]  :If Ini.RIDE.active</code>
<code class="emphasize">→[3]      n.RIDEflag.Active←14≤GetVersionOfSelectedAPL n</code>
<code> [4]  :EndIf</code>
</div>
<code class="header" id="listing_12">#.Launchy.Launchy.CollectCommandLineParms &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (parms flag)←n CollectCommandLineParms port</code>
<code> [1]  ⍝ Returns a vector</code>
<code class="emphasize">→[2]   parms←''</code>
<code class="emphasize">→[3]   :If 0≠port</code>
<code class="emphasize">→[4]       parms,←⊂'RIDE_INIT=SERVE::',(⍕port)       ⍝ Make it listen to ride</code>
<code> [5]   :EndIf</code>
<code class="emphasize">→[6]   parms,←⊂'MAXWS=',n.wssize.Text</code>
<code class="emphasize">→[7]   parms,←⊂GetDebugCode ⍬</code>
<code class="emphasize">→[8]   :If 0&lt;Ini.⎕NC'STD_CMD'</code>
<code class="emphasize">→[9]   :AndIf 0&lt;≢Ini.STD_CMD.⎕NL 2</code>
<code class="emphasize">→[10]      parms,←Ini.STD_CMD.{{⍵,'=',{0=1↑0⍴⍵:⍕⍵ ⋄ '"',⍵,'"'}⍎⍵}¨' '~¨⍨↓⎕NL 2}⍬</code>
<code> [11]  :EndIf</code>
<code class="emphasize">→[12]  :If n.StopSetup.State</code>
<code class="emphasize">→[13]      parms,←⊂'-stop_in_setup=1'</code>
<code> [14]  :EndIf</code>
<code class="emphasize">→[15]  :If n.DYALOGSTARTUPDEBUG.State</code>
<code class="emphasize">→[16]      parms,←⊂'DYALOGSTARTUPDEBUG=1'</code>
<code> [17]  :EndIf</code>
<code class="emphasize">→[18]  :If n.DYALOGSTARTUPSTOP.State</code>
<code class="emphasize">→[19]      parms,←⊂'DYALOGSTARTUPSTOP=1'</code>
<code> [20]  :EndIf</code>
<code class="emphasize">→[21]  :If n.DyalogWSLoadedStop.State</code>
<code class="emphasize">→[22]      parms,←⊂'DYALOGWSLOADEDSTOP=1'</code>
<code> [23]  :EndIf</code>
<code class="emphasize">→[24]  parms,←⊂'-exec_setup=',⍕n.ExecMySetup.State</code>
<code class="emphasize">→[25]  clp1←GetCommandLineParmsFromINI                ⍝ INI definition (if any)</code>
<code class="emphasize">→[26]  parms,←clp1</code>
<code class="emphasize">→[27]  clp2←GetCommandLineParmsFromGUI                ⍝ Come from the GUI</code>
<code class="emphasize">→[28]  parms,←clp2</code>
<code class="emphasize">→[29]  parms←(0&lt;≢¨parms)/parms</code>
<code class="emphasize">→[30]  :If 0&lt;+/bool←{'""'≡(1↑⍵),¯1↑⍵}¨parms</code>
<code class="emphasize">→[31]      ws←(bool⍳1)⊃parms</code>
<code class="emphasize">→[32]      parms←(~bool)/parms</code>
<code> [33]  :Else</code>
<code class="emphasize">→[34]      ws←''</code>
<code> [35]  :EndIf</code>
<code class="emphasize">→[36]  parms←parms[⍒(,⊂'-cef_all')⍳parms]</code>
<code class="emphasize">→[37]  :If 0&lt;≢ws</code>
<code class="emphasize">→[38]      parms,←⊂ws</code>
<code> [39]  :EndIf</code>
<code class="emphasize">→[40]  flag←⊃0&lt;≢clp1,∊clp2</code>
<code> [41] ⍝Done</code>
</div>
<code class="header" id="listing_13">#.Launchy.Launchy.ColorCode &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←ColorCode flag</code>
<code> [1] ⍝ Returns the color code for drawing attention to non-defaults settings</code>
<code class="emphasize">→[2]  :If flag</code>
<code class="emphasize">→[3]      r←255 215 255</code>
<code> [4]  :Else</code>
<code class="emphasize">→[5]      r←0</code>
<code> [6]  :EndIf</code>
</div>
<code class="header" id="listing_14">#.Launchy.Launchy.CreateBatFile &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> CreateBatFile←{</code>
<code class="emphasize">→[1]      parms←⍵</code>
<code class="emphasize">→[2]      bat←parms.file</code>
<code class="emphasize">→[3]      bat,←' ',parms.lpParms</code>
<code class="emphasize">→[4]      filename←'bat'F.GetTempFilename2''</code>
<code class="emphasize">→[5]      _←(⊂bat)F.NPUT filename 1</code>
<code class="emphasize">→[6]      filename</code>
<code> [7]  }</code>
</div>
<code class="header" id="listing_15">#.Launchy.Launchy.CreateShortcut &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {success}←CreateShortcut(exe filename parms keyboardShortcut)</code>
<code> [1]  ⍝ Creates a shortcut (LNK file) pointing to "exe" with command line parameters "parms".</code>
<code> [2]  ⍝ Returns 1 in case the shortcut was successfuly created, otherwise 0.</code>
<code class="emphasize">→[3]   'Specified EXE does not exist'⎕SIGNAL 11/⍨~⎕NEXISTS exe</code>
<code class="emphasize">→[4]   'wsh'⎕WC'OLEClient' 'WScript.Shell'</code>
<code class="emphasize">→[5]   path←1⊃⎕NPARTS filename</code>
<code class="emphasize">→[6]   filename←(≢path)↓filename</code>
<code class="emphasize">→[7]   filename←'.lnk'{⍵↓⍨(-≢⍺)×⍺≡⎕C(-≢⍺)↑⍵}filename</code>
<code class="emphasize">→[8]   filename←'-'@(⍸filename∊'\/')⊣filename</code>
<code class="emphasize">→[9]   lnk←wsh.CreateShortcut(⊂path,filename,'.lnk')</code>
<code class="emphasize">→[10]  lnk.TargetPath←'"',exe,'"'</code>
<code class="emphasize">→[11]  lnk.Arguments←parms</code>
<code class="emphasize">→[12]  lnk.WorkingDirectory←1⊃⎕NPARTS exe</code>
<code class="emphasize">→[13]  :If 0&lt;≢keyboardShortcut</code>
<code class="emphasize">→[14]      lnk.Hotkey←keyboardShortcut</code>
<code> [15]  :EndIf</code>
<code class="emphasize">→[16]  :Trap 0</code>
<code class="emphasize">→[17]      lnk.Save</code>
<code class="emphasize">→[18]      success←1</code>
<code> [19]  :Else</code>
<code class="emphasize">→[20]      success←0</code>
<code> [21]  :EndTrap</code>
</div>
<code class="header" id="listing_16">#.Launchy.Launchy.EditCredentials &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>   {r}←EditCredentials dummy</code>
<code class="emphasize">→[1]    r←''</code>
<code class="emphasize">→[2]    n2←⎕NS''</code>
<code class="emphasize">→[3]    ∆←''</code>
<code class="emphasize">→[4]    ∆,←⊂'Coord' 'Pixel'</code>
<code class="emphasize">→[5]    ∆,←⊂'Caption' 'Launchy: DSS Credentials'</code>
<code class="emphasize">→[6]    ∆,←⊂'Size'(275 370)</code>
<code class="emphasize">→[7]    ∆,←⊂'Posn'(40 30)</code>
<code class="emphasize">→[8]    ∆,←⊂'Sizeable' 0</code>
<code class="emphasize">→[9]    ∆,←⊂'MaxButton' 0</code>
<code class="emphasize">→[10]   ∆,←⊂'MinButton' 0</code>
<code class="emphasize">→[11]   ∆,←⊂'Icon'#.IconObj</code>
<code class="emphasize">→[12]   n2.Form←n.Form.⎕NEW'Form'∆</code>
<code> [13]  </code>
<code class="emphasize">→[14]   ∆←''</code>
<code class="emphasize">→[15]   ∆,←⊂'Caption' 'User-ID:'</code>
<code class="emphasize">→[16]   ∆,←⊂'Posn'(5 13)</code>
<code class="emphasize">→[17]   ∆,←⊂'Attach'('Top' 'Left' 'Top' 'Left')</code>
<code class="emphasize">→[18]   n2.Lbl_Userid←n2.Form.⎕NEW'Label'∆</code>
<code> [19]  </code>
<code class="emphasize">→[20]   ∆←''</code>
<code class="emphasize">→[21]   ∆,←⊂'Posn'((1⊃AddPosnAndSize n2.Lbl_Userid),10)</code>
<code class="emphasize">→[22]   ∆,←⊂'Text'(30⍴'W')</code>
<code class="emphasize">→[23]   ∆,←⊂'Attach'('Top' 'Left' 'Top' 'Left')</code>
<code class="emphasize">→[24]   n2.UserID←n2.Form.⎕NEW'Edit'∆</code>
<code class="emphasize">→[25]   n2.UserID.Text←''</code>
<code class="emphasize">→[26]   n2.UserID.Size[1]-←4</code>
<code> [27]  </code>
<code class="emphasize">→[28]   ∆←''</code>
<code class="emphasize">→[29]   ∆,←⊂'Caption' 'Password:'</code>
<code class="emphasize">→[30]   ∆,←⊂'Posn'((8+1⊃AddPosnAndSize n2.UserID),13)</code>
<code class="emphasize">→[31]   ∆,←⊂'Attach'('Top' 'Left' 'Top' 'Left')</code>
<code class="emphasize">→[32]   n2.Lbl_password←n2.Form.⎕NEW'Label'∆</code>
<code> [33]  </code>
<code class="emphasize">→[34]   ∆←''</code>
<code class="emphasize">→[35]   ∆,←⊂'Posn'((1⊃AddPosnAndSize n2.Lbl_password),10)</code>
<code class="emphasize">→[36]   ∆,←⊂'Text'(30⍴'W')</code>
<code class="emphasize">→[37]   ∆,←⊂'Attach'('Top' 'Left' 'Top' 'Left')</code>
<code class="emphasize">→[38]   ∆,←⊂'Password' '*'</code>
<code class="emphasize">→[39]   n2.Password←n2.Form.⎕NEW'Edit'∆</code>
<code class="emphasize">→[40]   n2.Password.Text←''</code>
<code class="emphasize">→[41]   n2.Password.Size[1]-←4</code>
<code> [42]  </code>
<code class="emphasize">→[43]   ∆←''</code>
<code class="emphasize">→[44]   ∆,←⊂'Posn'((5+1⊃AddPosnAndSize n2.Password),10)</code>
<code class="emphasize">→[45]   ∆,←⊂'Attach'('Top' 'Left' 'Top' 'Left')</code>
<code class="emphasize">→[46]   ∆,←⊂'Caption' 'Show password'</code>
<code class="emphasize">→[47]   ∆,←⊂'Style' 'Check'</code>
<code class="emphasize">→[48]   n2.ShowPassword←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[49]   n2.ShowPassword.onSelect←'OnTogglePassword'</code>
<code> [50]  </code>
<code class="emphasize">→[51]   ∆←''</code>
<code class="emphasize">→[52]   ∆,←⊂'Posn'((8+1⊃AddPosnAndSize n2.ShowPassword),15)</code>
<code class="emphasize">→[53]   ∆,←⊂'Size'(70,(n2.Form.Size[2]-40))</code>
<code class="emphasize">→[54]   ∆,←⊂'Attach'('Top' 'Left' 'Top' 'Left')</code>
<code class="emphasize">→[55]   ∆,←⊂'Caption' 'Distribute'</code>
<code class="emphasize">→[56]   n2.DistributeGroup←n2.Form.⎕NEW'Group'∆</code>
<code> [57]  </code>
<code class="emphasize">→[58]   ∆←''</code>
<code class="emphasize">→[59]   ∆,←⊂'Posn'(20 5)</code>
<code class="emphasize">→[60]   ∆,←⊂'State' 1</code>
<code class="emphasize">→[61]   ∆,←⊂'Style' 'Radio'</code>
<code class="emphasize">→[62]   ∆,←⊂'Attach'('Top' 'Left' 'Top' 'Left')</code>
<code class="emphasize">→[63]   ∆,←⊂'Caption' 'All versions of APL'</code>
<code class="emphasize">→[64]   n2.AllVersions←n2.DistributeGroup.⎕NEW'Button'∆</code>
<code> [65]  </code>
<code class="emphasize">→[66]   ∆←''</code>
<code class="emphasize">→[67]   ∆,←⊂'Posn'(45 5)</code>
<code class="emphasize">→[68]   ∆,←⊂'State' 0</code>
<code class="emphasize">→[69]   ∆,←⊂'Style' 'Radio'</code>
<code class="emphasize">→[70]   ∆,←⊂'Attach'('Top' 'Left' 'Top' 'Left')</code>
<code class="emphasize">→[71]   ∆,←⊂'Caption'((⊃n.List.(SelItems/∆Orig)),' only')</code>
<code class="emphasize">→[72]   n2.CurrentVersionOnly←n2.DistributeGroup.⎕NEW'Button'∆</code>
<code> [73]  </code>
<code class="emphasize">→[74]   ∆←''</code>
<code class="emphasize">→[75]   ∆,←⊂'Size'(⍬ 80)</code>
<code class="emphasize">→[76]   ∆,←⊂'Caption' 'OK'</code>
<code class="emphasize">→[77]   ∆,←⊂'Default' 1</code>
<code class="emphasize">→[78]   n2.OkBtn←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[79]   n2.OkBtn.onSelect←1</code>
<code class="emphasize">→[80]   n2.OkBtn.Posn←(15+⊃AddPosnAndSize n2.DistributeGroup),10</code>
<code> [81]  </code>
<code class="emphasize">→[82]   ∆←''</code>
<code class="emphasize">→[83]   ∆,←⊂'Posn'(n2.OkBtn.Posn+0,10+n2.OkBtn.Size[2])</code>
<code class="emphasize">→[84]   ∆,←⊂'Size'(⍬(n2.OkBtn.Size[2]))</code>
<code class="emphasize">→[85]   ∆,←⊂'Caption' 'Cancel'</code>
<code class="emphasize">→[86]   ∆,←⊂'Cancel' 1</code>
<code class="emphasize">→[87]   n2.CancelBtn←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[88]   n2.CancelBtn.onSelect←1</code>
<code> [89]  </code>
<code class="emphasize">→[90]   n2.Form.Posn←0 30+n.Form.Posn+⌊0.5×n.Form.Size-n2.Form.Size</code>
<code class="emphasize">→[91]   rk←GetRegPathForCurrentDyalogVersion ⍬</code>
<code class="emphasize">→[92]   n2.UserID.Text←R.GetString rk,'\Patch\UserID'</code>
<code class="emphasize">→[93]   n2.Password.Text←R.GetString rk,'\Patch\Password'</code>
<code> [94]  </code>
<code class="emphasize">→[95]   ⎕NQ n2.UserID'GotFocus' ⋄ res←⎕DQ n2.Form</code>
<code class="emphasize">→[96]   :If ~0∊⍴res</code>
<code class="emphasize">→[97]   :AndIf n2.OkBtn≡⎕IO⊃res</code>
<code class="emphasize">→[98]       :If n2.AllVersions.State</code>
<code class="emphasize">→[99]           :For thisAPL :In G.AplVersions</code>
<code class="emphasize">→[100]              rk2←(1⊃'\'U.SplitPath rk),thisAPL,'\Patch\'</code>
<code class="emphasize">→[101]              R.PutString(rk2,'userid')n2.UserID.Text</code>
<code class="emphasize">→[102]              R.PutString(rk2,'password')n2.Password.Text</code>
<code> [103]          :EndFor</code>
<code> [104]      :Else</code>
<code class="emphasize">→[105]          R.PutString(rk,'\Patch\UserID')n2.UserID.Text</code>
<code class="emphasize">→[106]          R.PutString(rk,'\Patch\Password')n2.Password.Text</code>
<code> [107]      :EndIf</code>
<code> [108]  :EndIf</code>
<code class="emphasize">→[109]  {}{6::⍬ ⋄ 1 ⎕NQ n2.Form'Close'}⍬</code>
<code> [110] ⍝Done</code>
</div>
<code class="header" id="listing_17">#.Launchy.Launchy.EditINI &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←EditINI n</code>
<code class="emphasize">→[1]   r←⍬</code>
<code class="emphasize">→[2]   n.Form.Active←0</code>
<code class="emphasize">→[3]   n.ok.Active←0</code>
<code class="emphasize">→[4]   filename1←∆HomeDir,'\launchy.ini'</code>
<code class="emphasize">→[5]   ns←⎕NS''</code>
<code class="emphasize">→[6]   ns.GeneralIni←was1←⊃F.NGET filename1</code>
<code class="emphasize">→[7]   filename2←∆HomeDir,'\Launchy_',S.GetComputerName,'.ini'</code>
<code class="emphasize">→[8]   :If exists←F.IsFile filename2</code>
<code class="emphasize">→[9]       ns.ComputerSpecificIni←was2←⊃F.NGET filename2</code>
<code> [10]  :EndIf</code>
<code class="emphasize">→[11]  msg←''</code>
<code class="emphasize">→[12]  :If exists</code>
<code class="emphasize">→[13]      ns.⎕ED↑'GeneralIni' 'ComputerSpecificIni'</code>
<code class="emphasize">→[14]      :If ∨/flags←(was1≢ns.GeneralIni)(was2≢ns.ComputerSpecificIni)</code>
<code class="emphasize">→[15]          :If 1⊃flags</code>
<code class="emphasize">→[16]              (⊂ns.GeneralIni)F.NPUT filename1 1</code>
<code> [17]          :EndIf</code>
<code class="emphasize">→[18]          :If 2⊃flags</code>
<code class="emphasize">→[19]              (⊂ns.ComputerSpecificIni)F.NPUT filename2 1</code>
<code> [20]          :EndIf</code>
<code class="emphasize">→[21]          msg←⊂'You have changed ',((+/flags)⊃'one' 'both'),' of Launchy''s INI files.'</code>
<code> [22]      :EndIf</code>
<code> [23]  :Else</code>
<code class="emphasize">→[24]      ns.⎕ED'GeneralIni'</code>
<code class="emphasize">→[25]      :If was1≢ns.GeneralIni</code>
<code class="emphasize">→[26]          (⊂ns.GeneralIni)F.NPUT filename1 1</code>
<code class="emphasize">→[27]          msg←⊂'You have changed Launchy''s INI file.'</code>
<code> [28]      :EndIf</code>
<code> [29]  :EndIf</code>
<code class="emphasize">→[30]  :If ~0∊⍴msg</code>
<code class="emphasize">→[31]      msg,←'' 'In order to make Launchy honour changes restart Launchy.'</code>
<code class="emphasize">→[32]      ShowMsg2 msg</code>
<code> [33]  :EndIf</code>
<code class="emphasize">→[34]  n.Form.Active←1</code>
<code class="emphasize">→[35]  n.ok.Active←1</code>
<code> [36] ⍝Done</code>
</div>
<code class="header" id="listing_18">#.Launchy.Launchy.ExchangeIn &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> ExchangeIn←{</code>
<code> [1] ⍝ 'abc_de' ←→ '._' Exchange 'abc.de'</code>
<code class="emphasize">→[2]      w←⍵</code>
<code class="emphasize">→[3]      0=+/b←w=⍺[1]:w</code>
<code class="emphasize">→[4]      (b/w)←⍺[2]</code>
<code class="emphasize">→[5]      w</code>
<code> [6]  }</code>
</div>
<code class="header" id="listing_19">#.Launchy.Launchy.ExecuteIn &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> ExecuteIn←{</code>
<code> [1] ⍝ Returns either a path defined by Ini.CONFIG.homedir or the installation directory</code>
<code class="emphasize">→[2]      ~0∊⍴wp←{0::'' ⋄ ⍎⍵}'Ini.CONFIG.workdir':Ini.CONFIG.workdir</code>
<code class="emphasize">→[3]      ⍵</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_20">#.Launchy.Launchy.FindRIDEexe &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←FindRIDEexe path</code>
<code class="emphasize">→[1]  F.Dir path,'*.exe'</code>
</div>
<code class="header" id="listing_21">#.Launchy.Launchy.GetAllControls &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetAllControls←{</code>
<code> [1] ⍝ Returns a list of refs pointing to all controls of type ⍺ (default: "Edit") recursively.</code>
<code class="emphasize">→[2]      ⍺←⊂'Edit'</code>
<code class="emphasize">→[3]      ⍺←⊆⍺</code>
<code class="emphasize">→[4]      l←⊃,/⍺{⍺ ⎕WN ⍵}¨⊂⍵</code>
<code class="emphasize">→[5]      0∊⍴gl←'Group'⎕WN ⍵:l</code>
<code class="emphasize">→[6]      l,⊃,/⍺∘∇¨gl</code>
<code> [7]  }</code>
</div>
<code class="header" id="listing_22">#.Launchy.Launchy.GetAplList &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  GetAplList←{</code>
<code> [1]  ⍝ Returns all installed versions of APL that fit the current</code>
<code> [2]  ⍝ settings of the radio buttons in WidthGroup and UnicodeGroup</code>
<code class="emphasize">→[3]       list←⍵</code>
<code class="emphasize">→[4]       bool←∨/¨'-64 '∘⍷¨list</code>
<code class="emphasize">→[5]       flag←1 0≡{⍵.State}¨⎕WN n.WidthGroup</code>
<code class="emphasize">→[6]       list←(~⍣flag⊣bool)/list</code>
<code class="emphasize">→[7]       bool←∨/¨'Unicode'∘⍷¨list</code>
<code class="emphasize">→[8]       flag←0 1≡{⍵.State}¨⎕WN n.UnicodeGroup</code>
<code class="emphasize">→[9]       list←(~⍣flag⊣bool)/list</code>
<code class="emphasize">→[10]      list</code>
<code> [11]  }</code>
</div>
<code class="header" id="listing_23">#.Launchy.Launchy.GetCommandLineParmsFromGUI &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetCommandLineParmsFromGUI</code>
<code> [1] ⍝ Returns the command line parms specified in the GUI, if any, as nested vector (if not empty)</code>
<code class="emphasize">→[2]  r_←r←n.cmdLineArgs.Text</code>
<code class="emphasize">→[3]  r_[¯1↓1↓⍸{{⍵∨≠\⍵}'"'=⍵}r]←'⌹'  ⍝ All spaces between double quotes become "⌹"</code>
<code class="emphasize">→[4]  (r r_)←({~'  '⍷⍵}r_)∘/¨r r_    ⍝ Remove double spaces from r according to r_</code>
<code class="emphasize">→[5]  r←1↓¨(' '=' ',r_)⊂' ',r        ⍝ Split at spaces</code>
<code> [6] ⍝Done</code>
</div>
<code class="header" id="listing_24">#.Launchy.Launchy.GetCommandLineParmsFromINI &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetCommandLineParmsFromINI</code>
<code class="emphasize">→[1]  r←''</code>
<code class="emphasize">→[2]  :If 0&lt;Ini.CONFIG.⎕NC'CommandLine'</code>
<code class="emphasize">→[3]  :AndIf 0&lt;≢Ini.CONFIG.CommandLine</code>
<code class="emphasize">→[4]      r←⊆Ini.CONFIG.CommandLine</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_25">#.Launchy.Launchy.GetCurrentlySelectedAPL &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetCurrentlySelectedAPL</code>
<code class="emphasize">→[1]  :If 0=+/n.List.SelItems</code>
<code class="emphasize">→[2]      r←''</code>
<code> [3]  :Else</code>
<code class="emphasize">→[4]      r←G.CurrentAPL←(n.List.SelItems⍳1)⊃n.List.∆Orig</code>
<code> [5]  :EndIf</code>
<code> [6] ⍝Done</code>
</div>
<code class="header" id="listing_26">#.Launchy.Launchy.GetDebugCode &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetDebugCode←{</code>
<code> [1] ⍝ Return either an empty vector or one of: "-Dc ", "-Dw ", "-DW "</code>
<code class="emphasize">→[2]      l←{(~';'∊⍵):'' ⋄ ⍵↑⍨1+-';'⍳⍨⌽⍵}¨Ini.WS_CHECK.list</code>
<code class="emphasize">→[3]      ' '~⍨(n.debug.SelItems⍳1)⊃l</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_27">#.Launchy.Launchy.GetDefaultForIconify &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetDefaultForIconify←{</code>
<code class="emphasize">→[1]      0=Ini.CONFIG.⎕NC'iconify':0</code>
<code class="emphasize">→[2]      Ini.CONFIG.iconify</code>
<code> [3]  }</code>
</div>
<code class="header" id="listing_28">#.Launchy.Launchy.GetDyalogAppPath &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetDyalogAppPath</code>
<code> [1] ⍝ Returns the key for the definition of the "Open" command in the Registry</code>
<code class="emphasize">→[2]  r←'HKEY_CLASSES_ROOT\Applications\dyalog.exe\shell\open\command'</code>
<code class="emphasize">→[3]  :If ~R.DoesKeyExist r</code>
<code class="emphasize">→[4]      r←'HKEY_CLASSES_ROOT\dwsfile\shell\open\command'</code>
<code class="emphasize">→[5]  :AndIf ~R.DoesKeyExist r</code>
<code class="emphasize">→[6]      r←''</code>
<code> [7]  :EndIf</code>
</div>
<code class="header" id="listing_29">#.Launchy.Launchy.GetDyalogRegKey &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetDyalogRegKey apl</code>
<code> [1] ⍝ Returns the Registry key (path) to the currently selected APL</code>
<code class="emphasize">→[2]  r←'HKCU\Software\Dyalog\',apl,'\'</code>
</div>
<code class="header" id="listing_30">#.Launchy.Launchy.GetFileTime &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetFileTime←{</code>
<code class="emphasize">→[1]      (('FileTime' 1)W.DirX ⍵)[1;W.COL_LastWriteDate]</code>
<code> [2]  }</code>
</div>
<code class="header" id="listing_31">#.Launchy.Launchy.GetFolder &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetFolder←{</code>
<code class="emphasize">→[1]      ~0∊⍴Ini.CONFIG.workdir:Ini.CONFIG.workdir</code>
<code class="emphasize">→[2]      GetInstallPath G.CurrentAPL</code>
<code> [3]  }</code>
</div>
<code class="header" id="listing_32">#.Launchy.Launchy.GetFontSize &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetFontSize</code>
<code class="emphasize">→[1]  r←16</code>
<code> [2] ⍝ :If 0&lt;Ini.⎕NC'FONT'</code>
<code> [3] ⍝ :AndIf 0&lt;Ini.FONT.⎕NC'size'</code>
<code> [4] ⍝     r←Ini.FONT.size</code>
<code> [5] ⍝ :EndIf</code>
</div>
<code class="header" id="listing_33">#.Launchy.Launchy.GetInstallDirFor &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetInstallDirFor←{</code>
<code> [1] ⍝ Returns the installation directory names in ⍵</code>
<code class="emphasize">→[2]      key←'HKCU\Software\Dyalog\',⍵,'\dyalog'</code>
<code class="emphasize">→[3]      R.GetString key</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_34">#.Launchy.Launchy.GetInstallPath &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetInstallPath ty</code>
<code> [1] ⍝ Return the proper installation path depending on the version selected</code>
<code class="emphasize">→[2]  r←R.GetString({⍵↓⍨¯1×'\'=¯1↑⍵}GetDyalogRegKey ty),'\dyalog'</code>
<code class="emphasize">→[3]  :If ~0∊⍴r←F.NormalizePath r</code>
<code class="emphasize">→[4]      r,←'\'</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_35">#.Launchy.Launchy.GetJson &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (rc msg ns)←{userAgent}GetJson gitPath</code>
<code> [1]  ⍝ Takes a path which must specify a valid GitHub API URL and returns the data from GitHub.\\</code>
<code> [2]  ⍝ ⍵</code>
<code> [3]  ⍝ : Project URL, for example 'api.github.com/repos/aplteam/fire/releases/latest'</code>
<code> [4]  ⍝ ⍺ (optional)</code>
<code> [5]  ⍝ : Specifies the user agent. Defaults to "aplteam". **Must not** be empty!</code>
<code> [6]  ⍝</code>
<code> [7]  ⍝ Result:</code>
<code> [8]  ⍝ `rc`</code>
<code> [9]  ⍝  : Either 0 for okay or an error code.\\</code>
<code> [10] ⍝ `msg`</code>
<code> [11] ⍝ : Is empty in case rc←→0 but might offer addtional information otherwise.</code>
<code> [12] ⍝ `ns`</code>
<code> [13] ⍝ : Namespace with data from GitHub</code>
<code class="emphasize">→[14]  userAgent←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 'aplteam'}'userAgent'</code>
<code class="emphasize">→[15]  gitPath{⍺,⍨⍵/⍨⍵≢(⍴⍵)↑⍺}←'https://'</code>
<code class="emphasize">→[16]  ns←⎕NS''</code>
<code class="emphasize">→[17]  ns.⎕FX'r←∆List;⎕IO' '⍝ List all variables and possible references in this namespace' '⎕IO←0' 'r←{⍵,[0.5]⍎¨⍵}'' ''~¨⍨↓⎕NL 2 9'</code>
<code class="emphasize">→[18]  ns.(version status url title details zipURL publishedAt)←⊂''</code>
<code class="emphasize">→[19]  :Trap 90</code>
<code class="emphasize">→[20]      fixVersion←{100 100 1000 10000⊥⍵}</code>
<code class="emphasize">→[21]      currentVersion←fixVersion 4↑(⎕IO+1)⊃'.'⎕VFI version</code>
<code class="emphasize">→[22]      ⎕USING←'System.Net,system.dll' 'System.IO' 'System.Text'</code>
<code class="emphasize">→[23]      cp←ServicePointManager.SecurityProtocol   ⍝ current protocol</code>
<code class="emphasize">→[24]      ServicePointManager.SecurityProtocol←SecurityProtocolType.Tls12</code>
<code class="emphasize">→[25]      req←WebRequest.CreateHttp⊂gitPath</code>
<code class="emphasize">→[26]      req.UserAgent←userAgent        ⍝ MUST NOT be empty: required by the github api!</code>
<code class="emphasize">→[27]      res←req.GetResponse</code>
<code class="emphasize">→[28]      ServicePointManager.SecurityProtocol←cp</code>
<code class="emphasize">→[29]      :If res.StatusCode≠res.StatusCode.OK</code>
<code class="emphasize">→[30]          ns.status←'Error Checking'</code>
<code class="emphasize">→[31]          :Return</code>
<code> [32]      :EndIf</code>
<code class="emphasize">→[33]      ts←⎕NEW StreamReader res.GetResponseStream   ⍝ text stream</code>
<code class="emphasize">→[34]      jd←ts.ReadToEnd</code>
<code class="emphasize">→[35]      data←⎕JSON jd</code>
<code class="emphasize">→[36]      ns.version←fixVersion 4↑(1+⎕IO)⊃'.'⎕VFI(data.tag_name∊⎕D,'.')/data.tag_name</code>
<code> [37]  :Else</code>
<code class="emphasize">→[38]      ns.status←{⍵↓⍨2+⍵⍳':'}{⍵↑⍨1⍳⍨(⎕UCS 8 10)⍷⍵}⍕⎕EXCEPTION</code>
<code> [39]  :EndTrap</code>
<code class="emphasize">→[40]  :If ns.version&gt;currentVersion</code>
<code class="emphasize">→[41]      ns.status←'Better one available'</code>
<code class="emphasize">→[42]      ns.version←data.tag_name</code>
<code class="emphasize">→[43]      ns.(url title details zipURL)←data.(html_url name body zipball_url)</code>
<code class="emphasize">→[44]      ns.publishedAt←{(10↑⍵),' ',8↑11↓⍵}data.published_at</code>
<code> [45]  :Else</code>
<code class="emphasize">→[46]      ns.status←'Current'</code>
<code> [47]  :EndIf</code>
<code> [48] ⍝Done</code>
</div>
<code class="header" id="listing_36">#.Launchy.Launchy.GetMajorAndMinor &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetMajorAndMinor←{</code>
<code class="emphasize">→[1]      ⍺←'.'</code>
<code class="emphasize">→[2]      ⊃⊃(//)⎕VFI ⍵/⍨2&gt;+\⍺=⍵</code>
<code> [3]  }</code>
</div>
<code class="header" id="listing_37">#.Launchy.Launchy.GetPathToDesktop &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetPathToDesktop</code>
<code class="emphasize">→[1]  'wsh'⎕WC'OLEClient' 'WScript.Shell'</code>
<code class="emphasize">→[2]  r←wsh.SpecialFolders.Item(⊂'Desktop')</code>
</div>
<code class="header" id="listing_38">#.Launchy.Launchy.GetProperPath &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetProperPath dummy</code>
<code class="emphasize">→[1]  rk←GetRegPathForCurrentDyalogVersion</code>
<code class="emphasize">→[2]  r←GetInstallPath GetCurrentlySelectedAPL</code>
</div>
<code class="header" id="listing_39">#.Launchy.Launchy.GetRef2n &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetRef2n←{</code>
<code class="emphasize">→[1]      0&lt;⍵.⎕NC'n':⍵.n</code>
<code class="emphasize">→[2]      ∇ ⍵.##</code>
<code> [3]  }</code>
</div>
<code class="header" id="listing_40">#.Launchy.Launchy.GetRideExeName &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetRideExeName←{</code>
<code class="emphasize">→[1]      pathToExe←⍵</code>
<code class="emphasize">→[2]      'expand'F.NormalizePath⊃⊃F.Dir pathToExe,'\Ride-*.exe'</code>
<code> [3]  }</code>
</div>
<code class="header" id="listing_41">#.Launchy.Launchy.GetRidePathForVersion &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetRidePathForVersion←{</code>
<code class="emphasize">→[1]      version←⍵</code>
<code class="emphasize">→[2]      .</code>
<code> [3]  }</code>
</div>
<code class="header" id="listing_42">#.Launchy.Launchy.GetVersionOfSelectedAPL &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetVersionOfSelectedAPL←{</code>
<code class="emphasize">→[1]      version←GetCurrentlySelectedAPL</code>
<code class="emphasize">→[2]      ''≡version~' ':0</code>
<code class="emphasize">→[3]      ⊃(//)⎕VFI 3⊃' 'U.Split version</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_43">#.Launchy.Launchy.GetWsSize &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetWsSize←{</code>
<code class="emphasize">→[1]      n←⍵</code>
<code class="emphasize">→[2]      0&lt;+/n.wssize.SelItems:n.wssize.((SelItems⍳1)⊃Items)</code>
<code class="emphasize">→[3]      val←⊃(//)⎕VFI{⍵/⍨⍵∊⎕D}n.wssize.Text</code>
<code class="emphasize">→[4]      0=≢val:''⊣ShowMsg2'Invalid WSSIZE'</code>
<code class="emphasize">→[5]      type←1 ⎕C{⍵/⍨~⍵∊⎕D}n.wssize.Text</code>
<code class="emphasize">→[6]      ~(⊂type)∊'' 'MB' 'GB':''⊣ShowMsg2'Invalid WSSIZE'</code>
<code class="emphasize">→[7]      GetWsSize_ val type</code>
<code> [8]  }</code>
</div>
<code class="header" id="listing_44">#.Launchy.Launchy.GetWsSize_ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetWsSize_←{</code>
<code class="emphasize">→[1]      (val type)←⍵</code>
<code class="emphasize">→[2]      type({0&lt;≢⍺:⍺ ⋄ 16&gt;⍵:'GB' ⋄ 'MB'})←val  ⍝ If no type then everything lower than 16 gets GB and MB otherwise</code>
<code class="emphasize">→[3]      (⍕val),type</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_45">#.Launchy.Launchy.IfAtLeastVersion &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> IfAtLeastVersion←{</code>
<code> [1]  ⍝ ⍵ is supposed to be a number like 15 or 17.1, representing a version of Dyalog APL.</code>
<code> [2]  ⍝ Returns a Boolean that is 1 only if the current version is at least as good.</code>
<code class="emphasize">→[3]      ⍵≤{⊃(//)⎕VFI ⍵/⍨2&gt;+\'.'=⍵}2⊃# ⎕WG'APLVersion'</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_46">#.Launchy.Launchy.IsRideAvailable &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> IsRideAvailable←{</code>
<code class="emphasize">→[1]      version←⍵</code>
<code class="emphasize">→[2]      0=Ini.RIDE.active:0</code>
<code class="emphasize">→[3]      f1←0&lt;Ini.RIDE.⎕NC'path2ride',⍕version</code>
<code class="emphasize">→[4]      f2←0&lt;Ini.RIDE.⎕NC'path2ride'</code>
<code class="emphasize">→[5]      0&lt;f1+f2</code>
<code> [6]  }</code>
</div>
<code class="header" id="listing_47">#.Launchy.Launchy.LaunchDyalog &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{workspace}LaunchDyalog(ty ws dseType port)</code>
<code> [1]  ⍝ Compiles the "batch script" and finally launches any version of Dyalog.</code>
<code class="emphasize">→[2]   r←1</code>
<code class="emphasize">→[3]   workspace←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'workspace'</code>
<code class="emphasize">→[4]   p←GetInstallPath ty</code>
<code class="emphasize">→[5]   :If 0=≢p</code>
<code class="emphasize">→[6]       r←TellRegistryProblem ty</code>
<code> [7]   :Else</code>
<code class="emphasize">→[8]       parms←##.OS.CreateParms_WinExecute</code>
<code class="emphasize">→[9]       parms.file←p,'Dyalog.exe'</code>
<code class="emphasize">→[10]      (parms.lpParms flag)←n CollectCommandLineParms port</code>
<code class="emphasize">→[11]      :If 0≠port</code>
<code class="emphasize">→[12]          parms.lpParms←('RIDE_INIT=SERVE::',(⍕port)),' ',parms.lpParms   ⍝ Make it listen to ride</code>
<code> [13]      :EndIf</code>
<code class="emphasize">→[14]      parms.lpParms,←{0=≢⍵:⍵ ⋄ ⊂' ',⍵}workspace                           ⍝ ⍺ might be a workspace name</code>
<code class="emphasize">→[15]      parms.lpDirectory←ExecuteIn ¯1↓⊃⎕NPARTS parms.file</code>
<code class="emphasize">→[16]      parms.lpDirectory{F.IsDir ⍺:⍺ ⋄ ⍵}←''                               ⍝ Flatten in case the directory does not exist</code>
<code class="emphasize">→[17]      parms.show←0≡port</code>
<code class="emphasize">→[18]      n.showCmd.Checked←AskForShowCommandLineParms⍣(flag∧∆AskForCommandLineParms∧0=n.showCmd.Checked)⊣n.showCmd.Checked</code>
<code class="emphasize">→[19]      :If 0≠n.showCmd.Checked ShowCmd parms n.runAsAdmin.State</code>
<code class="emphasize">→[20]          parms.lpParms←⊃,/' ',¨parms.lpParms</code>
<code class="emphasize">→[21]          (success rc msg)←n.runAsAdmin.State ##.OS.WinExecute parms</code>
<code class="emphasize">→[22]          :If 1≠success</code>
<code class="emphasize">→[23]              ShowMsg2'Error! Could not start:' ''parms.file('in ',parms.lpDirectory)(S.IsRunningAsAdmin/'with admin rights')</code>
<code> [24]          :EndIf</code>
<code> [25]      :Else</code>
<code class="emphasize">→[26]          r←0</code>
<code> [27]      :EndIf</code>
<code> [28]  :EndIf</code>
<code> [29] ⍝Done</code>
</div>
<code class="header" id="listing_48">#.Launchy.Launchy.LaunchWindowsAPL &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←n LaunchWindowsAPL rf</code>
<code class="emphasize">→[1]   r←⍬</code>
<code class="emphasize">→[2]   :If 0=≢ws←GetWsSize n</code>
<code class="emphasize">→[3]       rf.Active←1</code>
<code class="emphasize">→[4]       ⎕NQ n.wssize'GotFocus'</code>
<code class="emphasize">→[5]       :Return</code>
<code> [6]   :Else</code>
<code class="emphasize">→[7]       n.wssize.Text←ws</code>
<code> [8]   :EndIf</code>
<code class="emphasize">→[9]   G.CurrentAPL←GetCurrentlySelectedAPL</code>
<code class="emphasize">→[10]  (status cmd port rideExe)←SelectRide n</code>
<code class="emphasize">→[11]  :If ¯1≢status                                              ⍝ ¯1 = User has cancelled</code>
<code class="emphasize">→[12]      :If LaunchDyalog G.CurrentAPL ws''port</code>
<code class="emphasize">→[13]          :If 0&lt;≢rideExe</code>
<code class="emphasize">→[14]              ⎕DL 0.5</code>
<code class="emphasize">→[15]              cmd StartRide rideExe</code>
<code> [16]          :EndIf</code>
<code class="emphasize">→[17]          rf.Active←1</code>
<code class="emphasize">→[18]          :If n.iconify.Checked</code>
<code class="emphasize">→[19]              n.Form ⎕WS'State' 1</code>
<code> [20]          :EndIf</code>
<code> [21]      :EndIf</code>
<code> [22]  :EndIf</code>
</div>
<code class="header" id="listing_49">#.Launchy.Launchy.LoadPatch &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  LoadPatch←{</code>
<code> [1]  ⍝ Load the "Patch" workspace for the currently selected APL version.</code>
<code class="emphasize">→[2]       CheckDyalogForRunning GetCurrentlySelectedAPL:</code>
<code class="emphasize">→[3]       parms←##.OS.CreateParms_WinExecute</code>
<code class="emphasize">→[4]       aplPath←GetInstallPath GetCurrentlySelectedAPL</code>
<code class="emphasize">→[5]       parms.file←aplPath,'Base\Dyalog.exe"'</code>
<code class="emphasize">→[6]       parms.lpParms←'"',aplPath,'WS\Patch.dws"'</code>
<code class="emphasize">→[7]       parms.lpParms,←' session_file=null MAXWS=32000 '</code>
<code class="emphasize">→[8]       parms.lpDirectory←{⍵↓⍨-'\/'∊⍨¯1↑⍵}aplPath</code>
<code class="emphasize">→[9]       rc←1 ##.OS.WinExecute parms</code>
<code class="emphasize">→[10]      0,0/⎕DL 1:</code>
<code class="emphasize">→[11]      1:r←0</code>
<code> [12]  }</code>
</div>
<code class="header" id="listing_50">#.Launchy.Launchy.LoadPatches &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←LoadPatches dummy</code>
<code class="emphasize">→[1]   r←⍬</code>
<code class="emphasize">→[2]   q←('Patch just ',GetCurrentlySelectedAPL,'?')'' '(No = all versions of Dyalog!)'</code>
<code class="emphasize">→[3]   →(¯1≡res←YesNoCancel q)/0</code>
<code class="emphasize">→[4]   :If 1≡res</code>
<code class="emphasize">→[5]       r←LoadPatch ⍬</code>
<code> [6]   :Else</code>
<code class="emphasize">→[7]       (flag bool)←CheckCredentials G.AplVersions</code>
<code class="emphasize">→[8]       :If flag</code>
<code class="emphasize">→[9]           :For this :In bool/G.AplVersions</code>
<code class="emphasize">→[10]              parms←##.OS.CreateParms_WinExecute</code>
<code class="emphasize">→[11]              aplPath←GetInstallPath this</code>
<code class="emphasize">→[12]              parms.file←aplPath,'Base\Dyalog.exe"'</code>
<code class="emphasize">→[13]              parms.lpParms←'"',aplPath,'WS\Patch.dws"'</code>
<code class="emphasize">→[14]              parms.lpParms,←' session_file=null MAXWS=32000 '</code>
<code class="emphasize">→[15]              rc←1 ##.OS.WinExecute parms</code>
<code class="emphasize">→[16]              ⎕DL 0.25</code>
<code> [17]          :EndFor</code>
<code> [18]      :EndIf</code>
<code> [19]  :EndIf</code>
</div>
<code class="header" id="listing_51">#.Launchy.Launchy.NL &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←NL</code>
<code class="emphasize">→[1]  r←⎕UCS 13 10</code>
</div>
<code class="header" id="listing_52">#.Launchy.Launchy.Off &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Off</code>
<code class="emphasize">→[1]  :If U.IsDevelopment</code>
<code class="emphasize">→[2]      →</code>
<code> [3]  :Else</code>
<code class="emphasize">→[4]      ⎕OFF</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_53">#.Launchy.Launchy.OnAbout &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnAbout←{</code>
<code> [1] ⍝</code>
<code class="emphasize">→[2]      n←GetRef2n⊃⍵</code>
<code class="emphasize">→[3]      About n</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_54">#.Launchy.Launchy.OnActivateApp &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnActivateApp←{</code>
<code> [1] ⍝ Makes sure that the app gets restored when activated</code>
<code class="emphasize">→[2]      n←⍺</code>
<code class="emphasize">→[3]      ~n.iconify.Checked:1</code>
<code class="emphasize">→[4]      n.Form.State←0</code>
<code class="emphasize">→[5]      1</code>
<code> [6]  }</code>
</div>
<code class="header" id="listing_55">#.Launchy.Launchy.OnChangeRide &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnChangeRide←{</code>
<code class="emphasize">→[1]      _←CheckDefaults'RIDE'</code>
<code class="emphasize">→[2]      1</code>
<code> [3]  }</code>
</div>
<code class="header" id="listing_56">#.Launchy.Launchy.OnChangeWinCoord &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←OnChangeWinCoord msg</code>
<code> [1] ⍝ Saves all Windows coordinates (height, width, x, y) in the Windows Registry</code>
<code> [2] ⍝ and on the internal global variables</code>
<code class="emphasize">→[3]  r←1</code>
<code class="emphasize">→[4]  G.(ED_Rows ED_Cols ED_FirstX ED_FirstY)←n.(editHeight editWidth x y).Value</code>
<code class="emphasize">→[5]  _←SaveInRegistry ⍬</code>
<code> [6] ⍝Done</code>
</div>
<code class="header" id="listing_57">#.Launchy.Launchy.OnChanged &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnChanged←{</code>
<code> [1] ⍝</code>
<code class="emphasize">→[2]      CheckDefaults ⍺</code>
<code> [3]  }</code>
</div>
<code class="header" id="listing_58">#.Launchy.Launchy.OnCheckForNewVersion &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnCheckForNewVersion msg</code>
<code class="emphasize">→[1]  #.CursorObj←1</code>
<code class="emphasize">→[2]  CheckForNewVersion ⍬</code>
<code class="emphasize">→[3]  #.CursorObj←0</code>
<code> [4] ⍝⍎Done</code>
</div>
<code class="header" id="listing_59">#.Launchy.Launchy.OnCreateLNK &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  OnCreateLNK msg</code>
<code class="emphasize">→[1]   G.CurrentAPL←GetCurrentlySelectedAPL</code>
<code class="emphasize">→[2]   arg←⊃n CollectCommandLineParms 0</code>
<code class="emphasize">→[3]   ref2←⎕NS''</code>
<code class="emphasize">→[4]   ∆←''</code>
<code class="emphasize">→[5]   ∆,←⊂'FileMode' 'Write'</code>
<code class="emphasize">→[6]   ∆,←⊂'Caption' 'Name of the LNK file to be saved'</code>
<code class="emphasize">→[7]   ∆,←⊂'Directory'GetPathToDesktop</code>
<code class="emphasize">→[8]   ∆,←⊂'file'('My ',{'-'@(⍸⍵∊'/\')⊣⍵}G.CurrentAPL)</code>
<code class="emphasize">→[9]   ∆,←⊂'Filters'(⊂'*.lnk' 'LNK files (*.lnk)')</code>
<code class="emphasize">→[10]  ref←n.Form.⎕NEW'FileBox'∆</code>
<code class="emphasize">→[11]  ref.onFileBoxOK←'OnFileBoxOK'ref2</code>
<code class="emphasize">→[12]  ref.onFileBoxCancel←'OnFileBoxCancel'ref2</code>
<code class="emphasize">→[13]  res←⎕DQ ref</code>
<code class="emphasize">→[14]  :If ref2._OK</code>
<code class="emphasize">→[15]      exe←(GetInstallPath G.CurrentAPL),'dyalog.exe'</code>
<code class="emphasize">→[16]      filename←ref.Directory,'.lnk'{⍵↓⍨(-≢⍺)×⍺≡⎕C(-≢⍺)↑⍵}ref.File</code>
<code class="emphasize">→[17]      keyboardShortcut←AskForKeyboardShortcutForLNK n</code>
<code class="emphasize">→[18]      :If 0=CreateShortcut exe filename(⊃,/' ',¨arg)keyboardShortcut</code>
<code class="emphasize">→[19]          'Launchy error'ShowMsg2'An error occurred while attempting to create an LNK file'</code>
<code> [20]      :EndIf</code>
<code> [21]  :EndIf</code>
<code> [22]  ⍝Done</code>
</div>
<code class="header" id="listing_60">#.Launchy.Launchy.OnDYALOGSTARTUPDEBUG &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnDYALOGSTARTUPDEBUG←{</code>
<code class="emphasize">→[1]      _←CheckDefaults'DYALOGSTARTUPDEBUG'</code>
<code class="emphasize">→[2]      1</code>
<code> [3]  }</code>
</div>
<code class="header" id="listing_61">#.Launchy.Launchy.OnDYALOGSTARTUPSTOP &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnDYALOGSTARTUPSTOP←{</code>
<code class="emphasize">→[1]      _←CheckDefaults'DYALOGSTARTUPSTOP'</code>
<code class="emphasize">→[2]      1</code>
<code> [3]  }</code>
</div>
<code class="header" id="listing_62">#.Launchy.Launchy.OnEditCredentials &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnEditCredentials←{</code>
<code class="emphasize">→[1]      EditCredentials ⍬</code>
<code> [2]  }</code>
</div>
<code class="header" id="listing_63">#.Launchy.Launchy.OnEditINI &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnEditINI←{</code>
<code class="emphasize">→[1]      n←GetRef2n⊃,⍵</code>
<code class="emphasize">→[2]      _←EditINI n</code>
<code class="emphasize">→[3]      0</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_64">#.Launchy.Launchy.OnFileBoxCancel &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnFileBoxCancel←{</code>
<code class="emphasize">→[1]      ref←⍺</code>
<code class="emphasize">→[2]      ref._OK←0</code>
<code class="emphasize">→[3]      1</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_65">#.Launchy.Launchy.OnFileBoxOK &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnFileBoxOK←{</code>
<code class="emphasize">→[1]      ref←⍺</code>
<code class="emphasize">→[2]      ref._OK←1</code>
<code class="emphasize">→[3]      1</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_66">#.Launchy.Launchy.OnGitHubReleaseNotes &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnGitHubReleaseNotes←{</code>
<code class="emphasize">→[1]      url←'github.com/aplteam/Launchy/releases'</code>
<code class="emphasize">→[2]      _←U.GoToWebPage'https://',url</code>
<code class="emphasize">→[3]      0</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_67">#.Launchy.Launchy.OnGoToGitHub &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnGoToGitHub←{</code>
<code class="emphasize">→[1]      U.GoToWebPage'https://github.com/aplteam/Launchy'</code>
<code> [2]  }</code>
</div>
<code class="header" id="listing_68">#.Launchy.Launchy.OnHandleOption &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnHandleOption←{</code>
<code class="emphasize">→[1]      rf←1⊃⍵</code>
<code class="emphasize">→[2]      rf.Checked←~rf.Checked</code>
<code class="emphasize">→[3]      0</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_69">#.Launchy.Launchy.OnHandleTipToggler &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnHandleTipToggler←{</code>
<code class="emphasize">→[1]      rf←1⊃⍵</code>
<code class="emphasize">→[2]      rf.Checked←~rf.Checked</code>
<code class="emphasize">→[3]      n←GetRef2n rf</code>
<code class="emphasize">→[4]      _←rf.Checked ToggleTipVisibility n</code>
<code class="emphasize">→[5]      0</code>
<code> [6]  }</code>
</div>
<code class="header" id="listing_70">#.Launchy.Launchy.OnHelp &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  OnHelp←{</code>
<code> [1]  ⍝ Attempts to view Launchy's help file in the user's browser</code>
<code class="emphasize">→[2]       path←{0=≢⍵:F.PWD ⋄ G.Home,'/HTML'}⎕WSID</code>
<code class="emphasize">→[3]       fn←path,'/launchy_manual.html'</code>
<code class="emphasize">→[4]       flag←⎕NEXISTS fn</code>
<code class="emphasize">→[5]       ((fn=' ')/fn)←⊂'%20'</code>
<code class="emphasize">→[6]       fn←⊃,/fn</code>
<code class="emphasize">→[7]       flag:0⊣U.GoToWebPage'file:///',fn</code>
<code class="emphasize">→[8]       tx←'Could not find the file:' '' 'launchy_manual.html'</code>
<code class="emphasize">→[9]       tx,←'' 'in the folder:' ''G.Home</code>
<code class="emphasize">→[10]      _←'Launchy Help'ShowMsg2 tx</code>
<code class="emphasize">→[11]      0</code>
<code> [12]  }</code>
</div>
<code class="header" id="listing_71">#.Launchy.Launchy.OnIconify &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnIconify←{</code>
<code class="emphasize">→[1]      rf←1⊃⍵</code>
<code class="emphasize">→[2]      rf.Checked←~rf.Checked</code>
<code> [3]  }</code>
</div>
<code class="header" id="listing_72">#.Launchy.Launchy.OnKeyPressInList &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←OnKeyPressInList msg</code>
<code class="emphasize">→[1]   ref←⊃msg</code>
<code class="emphasize">→[2]   key←3⊃msg</code>
<code class="emphasize">→[3]   r←0</code>
<code class="emphasize">→[4]   n←GetRef2n ref</code>
<code class="emphasize">→[5]   n.Form.∆Reset←0</code>
<code class="emphasize">→[6]   :If 0 117 0≡3↓msg</code>
<code class="emphasize">→[7]       ⎕NQ n.List'GotFocus'</code>
<code> [8]   :Else</code>
<code class="emphasize">→[9]       :If 'ER'≡key</code>
<code class="emphasize">→[10]          r←(2↑msg),'EP' 27 27 0</code>
<code class="emphasize">→[11]      :ElseIf (≢key)∊0 2</code>
<code class="emphasize">→[12]          r←1</code>
<code> [13]      :Else</code>
<code class="emphasize">→[14]          bool←key∘≡¨⊃¨ref.Items</code>
<code class="emphasize">→[15]          :If 0&lt;+/bool</code>
<code class="emphasize">→[16]              ref.SelItems←bool</code>
<code class="emphasize">→[17]              G.CurrentAPL←⊃bool/n.List.∆Orig</code>
<code> [18]          :EndIf</code>
<code> [19]      :EndIf</code>
<code> [20]  :EndIf</code>
<code> [21] ⍝Done</code>
</div>
<code class="header" id="listing_73">#.Launchy.Launchy.OnKeyPressInPortNo &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  OnKeyPressInPortNo←{</code>
<code class="emphasize">→[1]       (rf key keyNo meta)←⍵[1 3 5 6]</code>
<code class="emphasize">→[2]       (meta=0)∧'F3'≡key:(rf.SelText←2⍴1+⍴,rf.Text){1}rf.Value←⍺.∆Port</code>
<code class="emphasize">→[3]       0≠meta:1</code>
<code class="emphasize">→[4]       these←33 34        ⍝ PgUp, PgDwn</code>
<code class="emphasize">→[5]       ~keyNo∊these:1</code>
<code class="emphasize">→[6]       v←rf.Value</code>
<code class="emphasize">→[7]       v←1000⌈v+(¯1 1)[1+keyNo=33]</code>
<code class="emphasize">→[8]       rf.Value←v</code>
<code class="emphasize">→[9]       rf.SelText←2⍴1+⍴,rf.Text</code>
<code class="emphasize">→[10]      0</code>
<code> [11]  }</code>
</div>
<code class="header" id="listing_74">#.Launchy.Launchy.OnKeyPressInPushButton &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnKeyPressInPushButton←{</code>
<code class="emphasize">→[1]      0 117 0≢3↓⍵:1</code>
<code class="emphasize">→[2]      n←GetRef2n⊃⍵</code>
<code class="emphasize">→[3]      _←⎕NQ n.List'GotFocus'</code>
<code class="emphasize">→[4]      0</code>
<code> [5]  }</code>
</div>
<code class="header" id="listing_75">#.Launchy.Launchy.OnLaunchAPL &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←OnLaunchAPL arg</code>
<code class="emphasize">→[1]   rf←1⊃,arg                                                   ⍝ Ref to the button</code>
<code class="emphasize">→[2]   rf.Active←0</code>
<code class="emphasize">→[3]   n←GetRef2n rf</code>
<code class="emphasize">→[4]   n LaunchWindowsAPL rf</code>
<code class="emphasize">→[5]   :If n.Form.∆Reset</code>
<code class="emphasize">→[6]       n.List.SelItems←n.List.∆DefaultSelection</code>
<code class="emphasize">→[7]       n.Form.∆Reset←0</code>
<code> [8]   :EndIf</code>
<code class="emphasize">→[9]   rf.Active←1</code>
<code class="emphasize">→[10]  n.runAsAdmin.State←0</code>
<code class="emphasize">→[11]  n.runAsAdmin.BCol←0</code>
<code class="emphasize">→[12]  r←0</code>
<code> [13] ⍝Done</code>
</div>
<code class="header" id="listing_76">#.Launchy.Launchy.OnLetsCrash &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnLetsCrash←{</code>
<code class="emphasize">→[1]      .</code>
<code> [2]  }</code>
</div>
<code class="header" id="listing_77">#.Launchy.Launchy.OnLoadPatch &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnLoadPatch←{</code>
<code class="emphasize">→[1]      LoadPatches ⍬</code>
<code> [2]  }</code>
</div>
<code class="header" id="listing_78">#.Launchy.Launchy.OnLoadPatches &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnLoadPatches←{</code>
<code class="emphasize">→[1]      LoadPatches ⍬</code>
<code> [2]  }</code>
</div>
<code class="header" id="listing_79">#.Launchy.Launchy.OnMakeDefault &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  OnMakeDefault←{</code>
<code class="emphasize">→[1]       n←GetRef2n⊃⍵</code>
<code class="emphasize">→[2]       ~n.ok.Active:0</code>
<code class="emphasize">→[3]       1≠+/n.List.SelItems:0</code>
<code class="emphasize">→[4]       G.Default←⊃n.List.SelItems/n.List.∆Orig</code>
<code class="emphasize">→[5]       regKey←GetAplLauncherRegistryKey,'DefaultAPL'</code>
<code class="emphasize">→[6]       _←{0::0 ⋄ R.PutString regKey G.Default}⍬</code>
<code class="emphasize">→[7]       (aplList orig)←GetListOfAPLs G</code>
<code class="emphasize">→[8]       (aplList indents orig)←MassageAplList aplList orig</code>
<code class="emphasize">→[9]       whichVersion←orig≡¨⊂G.Default</code>
<code class="emphasize">→[10]      n.List.(Items ∆Orig)←aplList orig</code>
<code class="emphasize">→[11]      n.List.SelItems←whichVersion</code>
<code class="emphasize">→[12]      0</code>
<code> [13]  }</code>
</div>
<code class="header" id="listing_80">#.Launchy.Launchy.OnMenuOptionsDropDown &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←OnMenuOptionsDropDown msg</code>
<code> [1] ⍝ Used to de-activate the command related to the default APL when not appropriate for "General"</code>
<code class="emphasize">→[2]  r←1</code>
<code class="emphasize">→[3]  n←GetRef2n⊃,msg</code>
<code class="emphasize">→[4]  flag←G.Default≡⊃n.List.(SelItems/∆Orig)</code>
<code class="emphasize">→[5]  n.(MakeDefault SelectDefault).Active←(~flag)∧n.ok.Active</code>
<code class="emphasize">→[6]  n.SelectDefault.Checked←flag</code>
<code> [7] ⍝Done</code>
</div>
<code class="header" id="listing_81">#.Launchy.Launchy.OnMoveFocusToList &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←OnMoveFocusToList msg</code>
<code class="emphasize">→[1]  r←0</code>
<code class="emphasize">→[2]  n←GetRef2n⊃,msg</code>
<code class="emphasize">→[3]  {}⎕NQ n.List'GotFocus'</code>
<code class="emphasize">→[4]  {}⎕NQ n.List'KeyPress' 'DC' 0 40 4  ⍝ "DC" is required to get around bug 15644</code>
<code> [5] ⍝Done</code>
</div>
<code class="header" id="listing_82">#.Launchy.Launchy.OnOnlineHelp &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnOnlineHelp←{</code>
<code class="emphasize">→[1]      n←GetRef2n⊃,⍵</code>
<code class="emphasize">→[2]      buff←U.DLB⊃n.List.(SelItems/Items)</code>
<code class="emphasize">→[3]      version←4⊃' 'U.Split buff</code>
<code class="emphasize">→[4]      url←'http://help.dyalog.com/',version,'/'</code>
<code class="emphasize">→[5]      _←U.GoToWebPage url</code>
<code class="emphasize">→[6]      0</code>
<code> [7]  }</code>
</div>
<code class="header" id="listing_83">#.Launchy.Launchy.OnPortGotFocus &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnPortGotFocus←{</code>
<code class="emphasize">→[1]      n←GetRef2n⊃,⍵</code>
<code class="emphasize">→[2]      n.Port.SelText←1,8</code>
<code class="emphasize">→[3]      1</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_84">#.Launchy.Launchy.OnPortLostFocus &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnPortLostFocus←{</code>
<code class="emphasize">→[1]      n←GetRef2n⊃,⍵</code>
<code class="emphasize">→[2]      n.Port.SelText←1 1</code>
<code class="emphasize">→[3]      1</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_85">#.Launchy.Launchy.OnPresetAPLs &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnPresetAPLs←{</code>
<code class="emphasize">→[1]      rf←1⊃⍵</code>
<code class="emphasize">→[2]      rf.Checked←~rf.Checked</code>
<code> [3]  }</code>
</div>
<code class="header" id="listing_86">#.Launchy.Launchy.OnQuit &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnQuit←{</code>
<code class="emphasize">→[1]      0⊣{6::⍬ ⋄ ⎕NQ n.Form'Close'}⍬</code>
<code> [2]  }</code>
</div>
<code class="header" id="listing_87">#.Launchy.Launchy.OnRegEdit &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnRegEdit←{</code>
<code class="emphasize">→[1]      vers←⊃n.List.(SelItems/∆Orig)</code>
<code class="emphasize">→[2]      path←'Computer\HKEY_CURRENT_USER\Software\Dyalog\'</code>
<code class="emphasize">→[3]      rk←path,vers</code>
<code class="emphasize">→[4]      _←R.PutString'Software\Microsoft\Windows\CurrentVersion\Applets\Regedit\LastKey'rk</code>
<code class="emphasize">→[5]      _←1 ##.OS.WinExecute'RegEdit.Exe'</code>
<code class="emphasize">→[6]      ⍬</code>
<code> [7]  }</code>
</div>
<code class="header" id="listing_88">#.Launchy.Launchy.OnReleaseNotes &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  OnReleaseNotes←{</code>
<code class="emphasize">→[1]       path←{0=≢⍵:F.PWD ⋄ G.Home,'/HTML'}⎕WSID</code>
<code class="emphasize">→[2]       fn←path,'\ReleaseNotes.html'</code>
<code class="emphasize">→[3]       flag←⎕NEXISTS fn</code>
<code class="emphasize">→[4]       ((fn=' ')/fn)←⊂'%20'</code>
<code class="emphasize">→[5]       fn←⊃,/fn</code>
<code class="emphasize">→[6]       flag:0⊣U.GoToWebPage'file:///',fn</code>
<code class="emphasize">→[7]       tx←'Could not find the file:' 'ReleaseNotes.html'</code>
<code class="emphasize">→[8]       tx,←'in the folder:'G.Home</code>
<code class="emphasize">→[9]       _←'Launchy Release Notes'ShowMsg2 tx</code>
<code class="emphasize">→[10]      0</code>
<code> [11]  }</code>
</div>
<code class="header" id="listing_89">#.Launchy.Launchy.OnResetDefaults &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  OnResetDefaults←{</code>
<code> [1]  ⍝ Restore all defaults</code>
<code class="emphasize">→[2]       n.wssize.SelItems←n.wssize.Items≡¨⊂Ini.WSSIZE.default</code>
<code class="emphasize">→[3]       n.debug.SelItems←Ini.WS_CHECK.default=⊃¨Ini.WS_CHECK.list</code>
<code class="emphasize">→[4]       n.(AplVersionGroup wssize_Label DebugGroup RIDEflag runAsAdmin ExecMySetup StopSetup DyalogWSLoadedStop RIDEflag DYALOGSTARTUPDEBUG DYALOGSTARTUPSTOP).BCol←0</code>
<code class="emphasize">→[5]       n.RIDEflag.State←Ini.RIDE.tick</code>
<code class="emphasize">→[6]       n.StopSetup.State←0</code>
<code class="emphasize">→[7]       n.DyalogWSLoadedStop.State←0</code>
<code class="emphasize">→[8]       n.ExecMySetup.State←Ini.EXEC_SETUP.default</code>
<code class="emphasize">→[9]       n.statusbarMsg.Text←'APL, WSSIZE and debug flags back on defaults'</code>
<code class="emphasize">→[10]      n.reset.Active←0</code>
<code class="emphasize">→[11]      n.runAsAdmin.State←0</code>
<code class="emphasize">→[12]      _←CheckRide n</code>
<code class="emphasize">→[13]      n.DYALOGSTARTUPDEBUG.State←0</code>
<code class="emphasize">→[14]      n.DYALOGSTARTUPSTOP.State←0</code>
<code class="emphasize">→[15]      ⍬</code>
<code> [16] ⍝Done</code>
<code> [17]  }</code>
</div>
<code class="header" id="listing_90">#.Launchy.Launchy.OnRightAlign &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnRightAlign←{</code>
<code> [1] ⍝ Make sure that a new window is right aligned.</code>
<code class="emphasize">→[2]      w←n.editWidth.Value</code>
<code class="emphasize">→[3]      n.x.Value←(⌈ScreenSize[2]÷2⊃G.SE_FontSize)-w+2</code>
<code class="emphasize">→[4]      _←1 ⎕NQ n.x'Change'</code>
<code class="emphasize">→[5]      ⍬</code>
<code> [6]  }</code>
</div>
<code class="header" id="listing_91">#.Launchy.Launchy.OnRunRide &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnRunRide←{</code>
<code class="emphasize">→[1]      _←StartRide 2⊃⍺</code>
<code class="emphasize">→[2]      ⍬</code>
<code> [3]  }</code>
</div>
<code class="header" id="listing_92">#.Launchy.Launchy.OnSelectAplVersion &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  type OnSelectAplVersion msg</code>
<code> [1]  ⍝ Toggle some options depending on the APL version selected</code>
<code class="emphasize">→[2]   rf←1⊃msg</code>
<code class="emphasize">→[3]   ty←G.Default</code>
<code class="emphasize">→[4]   flag←'11.0'≢ty</code>
<code class="emphasize">→[5]   _←ReadWinCoords ⍬</code>
<code class="emphasize">→[6]   _←SaveWinCoord G.LastSelectedVersion</code>
<code class="emphasize">→[7]   _←GetWinCoords ⍬</code>
<code class="emphasize">→[8]   _←RefreshWindowCoords ⍬</code>
<code class="emphasize">→[9]   G.LastSelectedVersion←G.Default</code>
<code class="emphasize">→[10]  CheckRide n</code>
<code class="emphasize">→[11]  CheckDefaults type</code>
</div>
<code class="header" id="listing_93">#.Launchy.Launchy.OnSelectDefault &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnSelectDefault←{</code>
<code class="emphasize">→[1]      n←GetRef2n⊃⍵</code>
<code class="emphasize">→[2]      ~n.ok.Active:0</code>
<code class="emphasize">→[3]      n.List.SelItems←n.List.∆Orig≡¨⊂G.Default</code>
<code class="emphasize">→[4]      flag←((n.List.SelItems⍳1)⊃n.List.∆Orig)∨.≠' '</code>
<code class="emphasize">→[5]      n.ok.Active←flag</code>
<code class="emphasize">→[6]      0</code>
<code> [7]  }</code>
</div>
<code class="header" id="listing_94">#.Launchy.Launchy.OnSelectLink &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnSelectLink←{</code>
<code class="emphasize">→[1]      rf←⊃⍵</code>
<code class="emphasize">→[2]      0=+/'https://'⍷rf.Caption:1</code>
<code class="emphasize">→[3]      n←GetRef2n rf</code>
<code class="emphasize">→[4]      _←U.GoToWebPage rf.Caption</code>
<code class="emphasize">→[5]      1</code>
<code> [6]  }</code>
</div>
<code class="header" id="listing_95">#.Launchy.Launchy.OnSelectList &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnSelectList←{</code>
<code class="emphasize">→[1]      ref←1⊃,⍵</code>
<code class="emphasize">→[2]      n←GetRef2n ref</code>
<code class="emphasize">→[3]      flag←((ref.SelItems⍳1)⊃ref.∆Orig)∨.≠' '</code>
<code class="emphasize">→[4]      n.OnlineHelp.Active←n.ok.Active←flag</code>
<code class="emphasize">→[5]      _←⎕NQ n.List'GotFocus'</code>
<code class="emphasize">→[6]      1</code>
<code> [7]  }</code>
</div>
<code class="header" id="listing_96">#.Launchy.Launchy.OnSelectTriggerShortcutKeyForLKN &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnSelectTriggerShortcutKeyForLKN←{</code>
<code class="emphasize">→[1]      n←GetRef2n 1⊃,⍵</code>
<code class="emphasize">→[2]      n.(Modifier TriggerKey).Active←~n.(Modifier TriggerKey).Active</code>
<code class="emphasize">→[3]      1</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_97">#.Launchy.Launchy.OnSpinnerKeyPress &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  OnSpinnerKeyPress←{</code>
<code> [1]  ⍝ Handles "Up/PgUp" &amp; "Down/PgDn" as well as "Home" and "End" speficially.</code>
<code class="emphasize">→[2]       rf←1⊃⍵                             ⍝ Ref to spinner</code>
<code class="emphasize">→[3]       kc←3⊃⍵                             ⍝ Key code</code>
<code class="emphasize">→[4]       0 1∊⍨⍴kc:1                         ⍝ We investigate commands only</code>
<code class="emphasize">→[5]       'UC'≡kc:{0}rf.Thumb+←1             ⍝ 1 up</code>
<code class="emphasize">→[6]       'US'≡kc:{0}rf.Thumb+←rf.Step       ⍝ Step up</code>
<code class="emphasize">→[7]       'DC'≡kc:{0}rf.Thumb-←1             ⍝ 1 down</code>
<code class="emphasize">→[8]       'DS'≡kc:{0}rf.Thumb-←rf.Step       ⍝ Step down</code>
<code class="emphasize">→[9]       'LL'≡kc:{0}rf.Thumb←rf.Limits[2]   ⍝ Max</code>
<code class="emphasize">→[10]      'RL'≡kc:{0}rf.Thumb←rf.Limits[1]   ⍝ Min</code>
<code class="emphasize">→[11]      1                                  ⍝ Pass</code>
<code> [12]  }</code>
</div>
<code class="header" id="listing_98">#.Launchy.Launchy.OnStandardKeyPress &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  OnStandardKeyPress←{</code>
<code> [1]  ⍝ Handles Alt+F4 and F6</code>
<code class="emphasize">→[2]       flag←{6≠≢⍵:0</code>
<code class="emphasize">→[3]           115 4≡2↑4↓⍵</code>
<code class="emphasize">→[4]       }⍵</code>
<code class="emphasize">→[5]       flag:⎕NQ n.Form'Close'             ⍝ Is it Alt+F4? Quit!</code>
<code class="emphasize">→[6]       0 117 0≡3↓⍵:0⊣⎕NQ n.List'GotFocus' ⍝ F6? Give focus to list of APLs</code>
<code class="emphasize">→[7]       ref←⊃⍵</code>
<code class="emphasize">→[8]       n.wssize≢ref:1</code>
<code class="emphasize">→[9]       'ER'≢3⊃⍵:1</code>
<code class="emphasize">→[10]      0⊣⎕NQ n.wssize'KeyPress' 'TB'</code>
<code> [11]  }</code>
</div>
<code class="header" id="listing_99">#.Launchy.Launchy.OnStartExplorer &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←OnStartExplorer dummy</code>
<code> [1] ⍝ Start Windows Explorer in the installation directory of the currently selected version of Dyalog</code>
<code class="emphasize">→[2]  r←0</code>
<code class="emphasize">→[3]  {}StartExplorer GetProperPath ⍬</code>
<code> [4] ⍝Done</code>
</div>
<code class="header" id="listing_100">#.Launchy.Launchy.OnStartExplorerInHelpDir &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←OnStartExplorerInHelpDir dummy</code>
<code> [1] ⍝ Start Windows Explorer in the help directory of the currently selected version of Dyalog</code>
<code class="emphasize">→[2]  r←0</code>
<code class="emphasize">→[3]  {}StartExplorer(GetProperPath ⍬),'/help/'</code>
<code> [4] ⍝Done</code>
</div>
<code class="header" id="listing_101">#.Launchy.Launchy.OnTogglePassword &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnTogglePassword←{</code>
<code class="emphasize">→[1]      n2.Password.Password←(1+(1⊃⍵).State)⊃'*' ''</code>
<code> [2]  }</code>
</div>
<code class="header" id="listing_102">#.Launchy.Launchy.RefreshWindowCoords &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  RefreshWindowCoords←{</code>
<code> [1]  ⍝ Write the values of some globals to the appropriate fields.</code>
<code> [2]  ⍝ Necessary to update the (edit &amp; possibly tracer) window coordinates</code>
<code> [3]  ⍝ to the screen after a change of the selected APL version</code>
<code class="emphasize">→[4]       n.editHeight.Value←G.ED_Rows</code>
<code class="emphasize">→[5]       n.editWidth.Value←G.ED_Cols</code>
<code class="emphasize">→[6]       n.x.Value←G.ED_FirstX</code>
<code class="emphasize">→[7]       n.y.Value←G.ED_FirstY</code>
<code class="emphasize">→[8]       ⍬</code>
<code> [9]   }</code>
</div>
<code class="header" id="listing_103">#.Launchy.Launchy.RestoreDefaults &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> RestoreDefaults←{</code>
<code> [1] ⍝</code>
<code class="emphasize">→[2]      n.wssize.SelItems←n.wssize.Items≡¨⊂Ini.WSSIZE.default</code>
<code class="emphasize">→[3]      n.debug.SelItems←(⍴n.debug.Items)↑1</code>
<code class="emphasize">→[4]      n.statusbarMsg.Text←'APL, WSSIZE and debug flags back on defaults'</code>
<code class="emphasize">→[5]      ⍬</code>
<code> [6]  }</code>
</div>
<code class="header" id="listing_104">#.Launchy.Launchy.SaveInRegistry &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  SaveInRegistry←{</code>
<code> [1]  ⍝ Save Windows coordinates of the currently selected APL in Registry</code>
<code class="emphasize">→[2]       regKey←GetDyalogRegKey G.Default</code>
<code class="emphasize">→[3]       _←R.PutString(regKey,'\edit_rows')(⍕G.ED_Rows)</code>
<code class="emphasize">→[4]       _←R.PutString(regKey,'\edit_cols')(⍕G.ED_Cols)</code>
<code class="emphasize">→[5]       _←R.PutString(regKey,'\edit_first_x')(⍕G.ED_FirstX)</code>
<code class="emphasize">→[6]       _←R.PutString(regKey,'\edit_first_y')(⍕G.ED_FirstY)</code>
<code class="emphasize">→[7]       ~n.tracerFlag.State:⍬                                      ⍝ Tracer is different? Done!</code>
<code class="emphasize">→[8]       _←R.PutString(regKey,'\trace_first_x')(⍕G.ED_FirstX)</code>
<code class="emphasize">→[9]       _←R.PutString(regKey,'\trace_first_y')(⍕G.ED_FirstY)</code>
<code class="emphasize">→[10]      ⍬</code>
<code> [11]  }</code>
</div>
<code class="header" id="listing_105">#.Launchy.Launchy.SayGoodByeAfterError &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←SayGoodByeAfterError parms</code>
<code class="emphasize">→[1]   r←''</code>
<code class="emphasize">→[2]   #.CursorObj←0</code>
<code class="emphasize">→[3]   flag←0&lt;parms.⎕NC'addToErrMsg'</code>
<code class="emphasize">→[4]   ⎕TRAP←0 'S'</code>
<code class="emphasize">→[5]   dmx←⎕DMX</code>
<code class="emphasize">→[6]   crashedIn←'#.HandleError.'{⊃⍵↓⍨+/∧\⍺∘≡¨(⍴⍺)↑¨⍵}1↓⎕XSI</code>
<code class="emphasize">→[7]   :If flag</code>
<code class="emphasize">→[8]       msg←⊂'Launchy has crashed in ',parms.addToErrMsg</code>
<code> [9]   :Else</code>
<code class="emphasize">→[10]      msg←⊂'Launchy has crashed.'</code>
<code> [11]  :EndIf</code>
<code class="emphasize">→[12]  msg,←⊂'For additional information check this folder:'</code>
<code class="emphasize">→[13]  msg,←⊂parms.errorFolder</code>
<code class="emphasize">→[14]  msg,←⊂'Consider sending the error WS to kai@aplteam.com.'</code>
<code class="emphasize">→[15]  msg,←⊂''</code>
<code class="emphasize">→[16]  msg,←⊂'Error message: ',1⊃⎕DM</code>
<code class="emphasize">→[17]  msg,←⊂''</code>
<code class="emphasize">→[18]  msg,←⊂'You might want to check your INI file in case you''ve changed it'</code>
<code class="emphasize">→[19]  ShowMsg2 msg</code>
<code> [20] ⍝Done</code>
</div>
<code class="header" id="listing_106">#.Launchy.Launchy.SelectRide &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (status cmd port rideExe)←SelectRide n</code>
<code> [1]  ⍝ status:</code>
<code> [2]  ⍝ ¯1 means user has cancelled</code>
<code> [3]  ⍝  0 means just APL</code>
<code> [4]  ⍝  1 means APL and Ride</code>
<code class="emphasize">→[5]   status←0 ⋄ cmd←'' ⋄ port←0 ⋄ rideExe←''</code>
<code class="emphasize">→[6]   :If n.RIDEflag.Active</code>
<code class="emphasize">→[7]   :AndIf 0≠n.RIDEflag.State</code>
<code class="emphasize">→[8]       caption←GetCurrentlySelectedAPL</code>
<code class="emphasize">→[9]       (status port rideExe)←AskForRideAndPort n caption</code>
<code class="emphasize">→[10]      :If ¯1=status  ⍝ Cancelled?</code>
<code class="emphasize">→[11]          port←0</code>
<code> [12]      :Else</code>
<code class="emphasize">→[13]          status←1</code>
<code class="emphasize">→[14]          :If 0≠port</code>
<code class="emphasize">→[15]              cmd←'SET RIDE_CONNECT=',Ini.RIDE.connect,':',(⍕port)</code>
<code> [16]          :EndIf</code>
<code> [17]      :EndIf</code>
<code> [18]  :EndIf</code>
<code> [19] ⍝Done</code>
</div>
<code class="header" id="listing_107">#.Launchy.Launchy.SetActiveTo &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> SetActiveTo←{</code>
<code> [1] ⍝ Use this to set the "Active" property of a group ⍺ and all its children to ⍵</code>
<code class="emphasize">→[2]      ⍺.Active←⍵</code>
<code class="emphasize">→[3]      ⍵{⍵.Active←⍺}¨⍎¨⎕WN⍕⍺</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_108">#.Launchy.Launchy.ShowCmd &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  ShowCmd←{</code>
<code> [1]  ⍝</code>
<code class="emphasize">→[2]       (parms adminFlag)←⍵</code>
<code class="emphasize">→[3]       m←⊂'Are you sure that you want this to be executed',(adminFlag/' with admin rights'),'?'</code>
<code class="emphasize">→[4]       m,←⊂''</code>
<code class="emphasize">→[5]       m,←⊂parms.file</code>
<code class="emphasize">→[6]       m,←U.DMB parms.lpParms~⊂''</code>
<code class="emphasize">→[7]       ⍺:WantToExecute m</code>
<code class="emphasize">→[8]       1</code>
<code> [9]   }</code>
</div>
<code class="header" id="listing_109">#.Launchy.Launchy.ShowMsg2 &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{caption}ShowMsg2 msg</code>
<code class="emphasize">→[1]   r←0</code>
<code class="emphasize">→[2]   caption←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 'Launchy'}'caption'</code>
<code class="emphasize">→[3]   n2←⎕NS''</code>
<code class="emphasize">→[4]   msg←⊆msg</code>
<code> [5]  </code>
<code class="emphasize">→[6]   ∆←''</code>
<code class="emphasize">→[7]   ∆,←⊂'MaxButton' 0</code>
<code class="emphasize">→[8]   ∆,←⊂'MinButton' 0</code>
<code class="emphasize">→[9]   ∆,←⊂'SysMenu' 0</code>
<code class="emphasize">→[10]  ∆,←⊂'Sizeable' 0</code>
<code class="emphasize">→[11]  :If 0&lt;⎕NC'n'</code>
<code class="emphasize">→[12]      ∆,←⊂'Posn'((n.Form.Posn+50))</code>
<code> [13]  :EndIf</code>
<code class="emphasize">→[14]  ∆,←⊂'Size'(300 2000)</code>
<code class="emphasize">→[15]  ∆,←⊂'Coord' 'Pixel'</code>
<code class="emphasize">→[16]  ∆,←⊂'Caption'caption</code>
<code class="emphasize">→[17]  :If 0&lt;⎕NC'n'</code>
<code class="emphasize">→[18]      n2.Form←n.Form.⎕NEW'Form'∆</code>
<code> [19]  :Else</code>
<code class="emphasize">→[20]      n2.Form←⎕NEW'Form'∆</code>
<code> [21]  :EndIf</code>
<code> [22] </code>
<code class="emphasize">→[23]  startAt←10 10</code>
<code class="emphasize">→[24]  i←0</code>
<code class="emphasize">→[25]  :For this :In msg</code>
<code class="emphasize">→[26]      i+←1</code>
<code class="emphasize">→[27]      ∆←''</code>
<code class="emphasize">→[28]      ∆,←⊂'Caption'(i⊃,msg)</code>
<code class="emphasize">→[29]      ∆,←⊂'Posn'startAt</code>
<code class="emphasize">→[30]      rf←n2.Form.⎕NEW'Label'∆</code>
<code class="emphasize">→[31]      ⍎'n2.Label',(¯2↑'00',⍕i),'←rf'</code>
<code class="emphasize">→[32]      startAt[1]+←rf.Size[1]</code>
<code> [33]  :EndFor</code>
<code> [34] </code>
<code class="emphasize">→[35]  ∆←''</code>
<code class="emphasize">→[36]  ∆,←⊂'Caption' 'OK'</code>
<code class="emphasize">→[37]  ∆,←⊂'Default' 1</code>
<code class="emphasize">→[38]  ∆,←⊂'Posn'((25+1⊃AddPosnAndSize rf),10)</code>
<code class="emphasize">→[39]  ∆,←⊂'Size'(⍬ 80)</code>
<code class="emphasize">→[40]  n2.OK←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[41]  n2.OK.Size[1]+←3</code>
<code class="emphasize">→[42]  n2.OK.onSelect←1</code>
<code> [43] </code>
<code class="emphasize">→[44]  n2.Form.Size[1]←10+1⊃AddPosnAndSize n2.OK</code>
<code class="emphasize">→[45]  n2.Form.Size[2]←10+(⌈/2⊃¨AddPosnAndSize¨'Label'⎕WN n2.Form)⌈2⊃AddPosnAndSize n2.OK</code>
<code> [46] </code>
<code class="emphasize">→[47]  ⎕NQ n2.OK'GotFocus' ⋄ res←n2.Form.Wait</code>
<code> [48] ⍝Done</code>
</div>
<code class="header" id="listing_110">#.Launchy.Launchy.StartExplorer &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> StartExplorer←{</code>
<code class="emphasize">→[1]      path←⍵</code>
<code class="emphasize">→[2]      parms←##.OS.CreateParms_WinExecute</code>
<code class="emphasize">→[3]      parms.file←'Explorer'</code>
<code class="emphasize">→[4]      parms.lpParms←'/e',(~0∊⍴path)/' /select,',F.NormalizePath path</code>
<code class="emphasize">→[5]      ##.OS.WinExecute parms</code>
<code> [6]  }</code>
</div>
<code class="header" id="listing_111">#.Launchy.Launchy.StartRide &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{cmd}StartRide pathToExe</code>
<code class="emphasize">→[1]   r←0</code>
<code class="emphasize">→[2]   cmd←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'cmd'</code>
<code class="emphasize">→[3]   parms←##.OS.CreateParms_WinExecute</code>
<code class="emphasize">→[4]   bat←''</code>
<code class="emphasize">→[5]   :If 9=⎕NC'Ini'</code>
<code class="emphasize">→[6]   :AndIf 2=Ini.RIDE.⎕NC'profile'</code>
<code class="emphasize">→[7]   :AndIf 0≠≢Ini.RIDE.profile</code>
<code class="emphasize">→[8]       bat,←'SET RIDE_PREFS=',Ini.RIDE.profile,'&amp;'</code>
<code> [9]   :EndIf</code>
<code class="emphasize">→[10]  :If 0≠≢cmd</code>
<code class="emphasize">→[11]      bat,←' ',cmd,'&amp;'</code>
<code> [12]  :EndIf</code>
<code class="emphasize">→[13]  parms.file←'bat'F.GetTempFilename2''</code>
<code class="emphasize">→[14]  parms.show←0</code>
<code class="emphasize">→[15]  bat,←' "',('"'~⍨GetRideExeName pathToExe),'"'</code>
<code class="emphasize">→[16]  (⊂bat)F.NPUT parms.file 1</code>
<code class="emphasize">→[17]  (success rc msg)←##.OS.WinExecute parms</code>
<code class="emphasize">→[18]  :If 0=success</code>
<code class="emphasize">→[19]      'Could not start Ride'CheckRc rc</code>
<code> [20]  :EndIf</code>
<code class="emphasize">→[21]  {⎕DL 1 ⋄ F.DeleteFile ⍵}&amp;parms.file</code>
<code> [22] ⍝Done</code>
</div>
<code class="header" id="listing_112">#.Launchy.Launchy.TellCommunicationWithGitHubFailed &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> TellCommunicationWithGitHubFailed←{</code>
<code class="emphasize">→[1]      msg←⊂'The attempt to communicate with GitHub in order to check for a new version of ',⍵,' failed.'</code>
<code class="emphasize">→[2]      msg,←'' 'Please try again later.'</code>
<code class="emphasize">→[3]      #.CursorObj←0</code>
<code class="emphasize">→[4]      _←'Update check'ShowMsg2 msg</code>
<code class="emphasize">→[5]      1:shy←0</code>
<code> [6]  }</code>
</div>
<code class="header" id="listing_113">#.Launchy.Launchy.TellDownloadProblem &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> TellDownloadProblem←{</code>
<code class="emphasize">→[1]      msg←⊂'The attempt to download the new version from GitHub failed.'</code>
<code class="emphasize">→[2]      msg,←'' 'Please try again later.'</code>
<code class="emphasize">→[3]      #.CursorObj←0</code>
<code class="emphasize">→[4]      _←'Update check'ShowMsg2 msg</code>
<code class="emphasize">→[5]      1:shy←0</code>
<code> [6]  }</code>
</div>
<code class="header" id="listing_114">#.Launchy.Launchy.TellErrorWhileCheckingForBetterVersion &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> TellErrorWhileCheckingForBetterVersion←{</code>
<code class="emphasize">→[1]      msg←'Checking for updates failed due to an unexpected error:'(↑1↓⍵)</code>
<code class="emphasize">→[2]      #.CursorObj←0</code>
<code class="emphasize">→[3]      _←'Check for updates'ShowMsg2 msg</code>
<code class="emphasize">→[4]      1:shy←⍬</code>
<code> [5]  }</code>
</div>
<code class="header" id="listing_115">#.Launchy.Launchy.TellLaunchyIsUp2Date &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> TellLaunchyIsUp2Date←{</code>
<code class="emphasize">→[1]      msg←⊂'Launchy is up to date.'</code>
<code class="emphasize">→[2]      #.CursorObj←0</code>
<code class="emphasize">→[3]      _←'Update check'ShowMsg2 msg</code>
<code class="emphasize">→[4]      1:shy←0</code>
<code> [5]  }</code>
</div>
<code class="header" id="listing_116">#.Launchy.Launchy.TellRegistryProblem &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> TellRegistryProblem←{</code>
<code class="emphasize">→[1]      msg←⊂'Could not find the installation path for:'</code>
<code class="emphasize">→[2]      msg,←⊂'    ',⍵</code>
<code class="emphasize">→[3]      msg,←⊂'in the registry. The is a serious problem with your Windows Registry!'</code>
<code class="emphasize">→[4]      msg,←'' 'Launchy cannot continue.'</code>
<code class="emphasize">→[5]      _←ShowMsg2 msg</code>
<code class="emphasize">→[6]      Off</code>
<code> [7]  }</code>
</div>
<code class="header" id="listing_117">#.Launchy.Launchy.ThereIsAWorkingDir &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←ThereIsAWorkingDir</code>
<code class="emphasize">→[1]  :If r←2=Ini.CONFIG.⎕NC'workdir'</code>
<code class="emphasize">→[2]  :AndIf r←0&lt;≢Ini.CONFIG.workdir</code>
<code class="emphasize">→[3]      r←F.IsDir Ini.CONFIG.workdir</code>
<code> [4]  :EndIf</code>
</div>
<code class="header" id="listing_118">#.Launchy.Launchy.ValueOrDefault &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> ValueOrDefault←{</code>
<code> [1] ⍝ Returns either ⍵ if not empty or ⍺ which defaults to 50</code>
<code> [2] ⍝ Useful for setting size etc.</code>
<code class="emphasize">→[3]      ⍺←50</code>
<code class="emphasize">→[4]      ⍬≡⍵:⍺</code>
<code class="emphasize">→[5]      ⍵</code>
<code> [6]  }</code>
</div>
<code class="header" id="listing_119">#.Launchy.Launchy.WantToExecute &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  flag←WantToExecute question</code>
<code class="emphasize">→[1]   n2←⎕NS''</code>
<code class="emphasize">→[2]   question←⊆question</code>
<code> [3]  </code>
<code class="emphasize">→[4]   ∆←''</code>
<code class="emphasize">→[5]   ∆,←⊂'MaxButton' 0</code>
<code class="emphasize">→[6]   ∆,←⊂'MinButton' 0</code>
<code class="emphasize">→[7]   ∆,←⊂'SysMenu' 0</code>
<code class="emphasize">→[8]   ∆,←⊂'Sizeable' 0</code>
<code class="emphasize">→[9]   ∆,←⊂'Posn'((n.Form.Posn+50))</code>
<code class="emphasize">→[10]  ∆,←⊂'Size'(300 400)</code>
<code class="emphasize">→[11]  ∆,←⊂'Coord' 'Pixel'</code>
<code class="emphasize">→[12]  ∆,←⊂'Caption' 'Launchy'</code>
<code class="emphasize">→[13]  n2.Form←⎕NEW'Form'∆</code>
<code> [14] </code>
<code class="emphasize">→[15]  n2.MyFont←n2.Form.⎕NEW'Font'(('PName' 'APL385 Unicode')('Size'GetFontSize))</code>
<code class="emphasize">→[16]  n2.Form.FontObj←n2.MyFont</code>
<code class="emphasize">→[17]  fontSizes←n2.Form.GetTextSize¨question</code>
<code class="emphasize">→[18]  n2.Form.Size[1]←100+{(≢⍵)×4+⌈/⍵}⊃¨fontSizes</code>
<code class="emphasize">→[19]  n2.Form.Size[2]←40+⌈/2⊃¨fontSizes</code>
<code> [20] </code>
<code class="emphasize">→[21]  startAt←10 10</code>
<code class="emphasize">→[22]  i←0</code>
<code class="emphasize">→[23]  :For this :In question</code>
<code class="emphasize">→[24]      i+←1</code>
<code class="emphasize">→[25]      ∆←''</code>
<code class="emphasize">→[26]      ∆,←⊂'Caption'(i⊃,question)</code>
<code class="emphasize">→[27]      ∆,←⊂'Posn'startAt</code>
<code class="emphasize">→[28]      rf←n2.Form.⎕NEW'Label'∆</code>
<code class="emphasize">→[29]      ⍎'n2.Label',(¯2↑'00',⍕i),'←rf'</code>
<code class="emphasize">→[30]      startAt[1]+←rf.Size[1]-6</code>
<code> [31]  :EndFor</code>
<code> [32] </code>
<code class="emphasize">→[33]  ∆←''</code>
<code class="emphasize">→[34]  ∆,←⊂'Caption' 'Yes'</code>
<code class="emphasize">→[35]  ∆,←⊂'Default' 1</code>
<code class="emphasize">→[36]  ∆,←⊂'Posn'((25+1⊃AddPosnAndSize rf),10)</code>
<code class="emphasize">→[37]  ∆,←⊂'Size'(⍬ 80)</code>
<code class="emphasize">→[38]  n2.OK←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[39]  n2.OK.Size[1]+←3</code>
<code class="emphasize">→[40]  n2.OK.onSelect←1</code>
<code> [41] </code>
<code class="emphasize">→[42]  ∆←''</code>
<code class="emphasize">→[43]  ∆,←⊂'Caption' 'No'</code>
<code class="emphasize">→[44]  ∆,←⊂'Cancel' 1</code>
<code class="emphasize">→[45]  ∆,←⊂'Posn'(n2.OK.Posn[1],10+2⊃AddPosnAndSize n2.OK)</code>
<code class="emphasize">→[46]  ∆,←⊂'Size'(⍬ 80)</code>
<code class="emphasize">→[47]  n2.Cancel←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[48]  n2.Cancel.Size[1]+←3</code>
<code class="emphasize">→[49]  n2.Cancel.onSelect←1</code>
<code> [50] </code>
<code class="emphasize">→[51]  n2.Form.Size[1]←10+1⊃AddPosnAndSize n2.OK</code>
<code class="emphasize">→[52]  n2.Form.Size[2]←10+(⌈/2⊃¨AddPosnAndSize¨'Label'⎕WN n2.Form)⌈2⊃AddPosnAndSize n2.Cancel</code>
<code> [53] </code>
<code class="emphasize">→[54]  ⎕NQ n2.OK'GotFocus' ⋄ res←n2.Form.Wait</code>
<code class="emphasize">→[55]  :If 0=≢res</code>
<code class="emphasize">→[56]  :OrIf n2.Cancel≡⊃res</code>
<code class="emphasize">→[57]      flag←0</code>
<code> [58]  :Else</code>
<code class="emphasize">→[59]      flag←1</code>
<code> [60]  :EndIf</code>
<code> [61]  ⍝Done</code>
</div>
<code class="header" id="listing_120">#.Launchy.Launchy.YesNoCancel &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{caption}YesNoCancel question</code>
<code> [1]  ⍝ Returns 1 for OK, 0 for No and ¯1 for Cancel</code>
<code class="emphasize">→[2]   caption←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 'Launchy'}'caption'</code>
<code class="emphasize">→[3]   ∆←⊂'MsgBox'</code>
<code class="emphasize">→[4]   ∆,←⊂caption</code>
<code class="emphasize">→[5]   ∆,←⊂'Text'question</code>
<code class="emphasize">→[6]   ∆,←⊂'Style' 'Query'</code>
<code class="emphasize">→[7]   ∆,←⊂'Btns'('YES' 'NO' 'CANCEL')</code>
<code class="emphasize">→[8]   ∆,←⊂'Event'('MsgBtn1' 'MsgBtn2' 'MsgBtn3')1</code>
<code class="emphasize">→[9]   'ms'⎕WC ∆</code>
<code class="emphasize">→[10]  r←(1 0 ¯1)[('MsgBtn1' 'MsgBtn2' 'MsgBtn3')⍳⊂2⊃⎕DQ'ms']</code>
</div>
<code class="header" id="listing_121">#.Launchy.Launchy.YesOrNo &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> flag←{caption}YesOrNo question</code>
<code class="emphasize">→[1]  caption←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 'Launchy'}'caption'</code>
<code class="emphasize">→[2]  ∆←⊂'MsgBox'</code>
<code class="emphasize">→[3]  ∆,←⊂caption</code>
<code class="emphasize">→[4]  ∆,←⊂'Text'question</code>
<code class="emphasize">→[5]  ∆,←⊂'Style' 'Query'</code>
<code class="emphasize">→[6]  ∆,←⊂'Event'('MsgBtn1' 'MsgBtn2')1</code>
<code class="emphasize">→[7]  'ms'⎕WC ∆</code>
<code class="emphasize">→[8]  flag←'MsgBtn1'≡2⊃⎕DQ'ms'</code>
</div>
<code class="header" id="listing_122">#.Launchy.Launchy.YesOrNo2 &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  flag←{caption}YesOrNo2 question</code>
<code class="emphasize">→[1]   #.CursorObj←0</code>
<code class="emphasize">→[2]   caption←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 'Launchy'}'caption'</code>
<code class="emphasize">→[3]   n2←⎕NS''</code>
<code class="emphasize">→[4]   question←⊆question</code>
<code> [5]  </code>
<code class="emphasize">→[6]   ∆←''</code>
<code class="emphasize">→[7]   ∆,←⊂'MaxButton' 0</code>
<code class="emphasize">→[8]   ∆,←⊂'MinButton' 0</code>
<code class="emphasize">→[9]   ∆,←⊂'SysMenu' 0</code>
<code class="emphasize">→[10]  ∆,←⊂'Sizeable' 0</code>
<code class="emphasize">→[11]  ∆,←⊂'Posn'((n.Form.Posn+50))</code>
<code class="emphasize">→[12]  ∆,←⊂'Size'(300 400)</code>
<code class="emphasize">→[13]  ∆,←⊂'Coord' 'Pixel'</code>
<code class="emphasize">→[14]  ∆,←⊂'Caption'caption</code>
<code class="emphasize">→[15]  n2.Form←⎕NEW'Form'∆</code>
<code> [16] </code>
<code class="emphasize">→[17]  startAt←10 10</code>
<code class="emphasize">→[18]  i←0</code>
<code class="emphasize">→[19]  :For this :In question</code>
<code class="emphasize">→[20]      i+←1</code>
<code class="emphasize">→[21]      ∆←''</code>
<code class="emphasize">→[22]      ∆,←⊂'Caption'(i⊃,question)</code>
<code class="emphasize">→[23]      ∆,←⊂'Posn'startAt</code>
<code class="emphasize">→[24]      rf←n2.Form.⎕NEW'Label'∆</code>
<code class="emphasize">→[25]      ⍎'n2.Label',(¯2↑'00',⍕i),'←rf'</code>
<code class="emphasize">→[26]      startAt[1]+←rf.Size[1]</code>
<code> [27]  :EndFor</code>
<code> [28] </code>
<code class="emphasize">→[29]  ∆←''</code>
<code class="emphasize">→[30]  ∆,←⊂'Caption' 'Yes'</code>
<code class="emphasize">→[31]  ∆,←⊂'Default' 1</code>
<code class="emphasize">→[32]  ∆,←⊂'Posn'((25+1⊃AddPosnAndSize rf),10)</code>
<code class="emphasize">→[33]  ∆,←⊂'Size'(⍬ 80)</code>
<code class="emphasize">→[34]  n2.OK←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[35]  n2.OK.Size[1]+←3</code>
<code class="emphasize">→[36]  n2.OK.onSelect←1</code>
<code> [37] </code>
<code class="emphasize">→[38]  ∆←''</code>
<code class="emphasize">→[39]  ∆,←⊂'Caption' 'No'</code>
<code class="emphasize">→[40]  ∆,←⊂'Cancel' 1</code>
<code class="emphasize">→[41]  ∆,←⊂'Posn'(n2.OK.Posn[1],10+2⊃AddPosnAndSize n2.OK)</code>
<code class="emphasize">→[42]  ∆,←⊂'Size'(⍬ 80)</code>
<code class="emphasize">→[43]  n2.Cancel←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[44]  n2.Cancel.Size[1]+←3</code>
<code class="emphasize">→[45]  n2.Cancel.onSelect←1</code>
<code> [46] </code>
<code class="emphasize">→[47]  n2.Form.Size[1]←10+1⊃AddPosnAndSize n2.OK</code>
<code class="emphasize">→[48]  n2.Form.Size[2]←10+(⌈/2⊃¨AddPosnAndSize¨'Label'⎕WN n2.Form)⌈2⊃AddPosnAndSize n2.Cancel</code>
<code> [49] </code>
<code class="emphasize">→[50]  ⎕NQ n2.OK'GotFocus' ⋄ res←n2.Form.Wait</code>
<code class="emphasize">→[51]  :If 0∊⍴res</code>
<code class="emphasize">→[52]  :OrIf n2.Cancel≡⊃res</code>
<code class="emphasize">→[53]      flag←0</code>
<code> [54]  :Else</code>
<code class="emphasize">→[55]      flag←1</code>
<code> [56]  :EndIf</code>
<code> [57]  ⍝Done</code>
</div>
<code class="header" id="listing_123">#.Launchy.Launchy.RefNamespace.∆List &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←∆List type</code>
<code> [1]      ⍝ List all controls with their type and caption (if any)</code>
<code> [2]      ⍝ If "type" is empty, all controls are listed.</code>
<code> [3]      ⍝ if "type" is not empty then only controls are listed of that "type".</code>
<code> [4]      ⍝ "type" can be either a simple string or a vector of strings.</code>
<code class="emphasize">→[5]   ⎕ML←3</code>
<code class="emphasize">→[6]   refs←' '~¨⍨↓⎕NL 9</code>
<code class="emphasize">→[7]   r←↑{6 2::'-' '' ⋄ rf←⍎⍵ ⋄ (⊂⍵),(⊂rf.Type),(⊂{0::'' ⋄ ⍵.Caption}rf)}¨refs</code>
<code class="emphasize">→[8]   :If 0≠≢type</code>
<code class="emphasize">→[9]       type←{(,∘⊂∘,⍣(1=≡,⍵))⍵}type</code>
<code class="emphasize">→[10]      bool←({0::'' ⋄ ⍵.Type}∘⍎¨refs)∊type</code>
<code class="emphasize">→[11]      r←bool⌿r</code>
<code> [12]  :EndIf</code>
</div>
<code class="header" id="listing_124">#.Launchy.Launchy.RefNamespace.∆GetRefs &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> refs←∆GetRefs type</code>
<code> [1]     ⍝ Returns all references in ⎕THIS if the right argument is empty.</code>
<code> [2]     ⍝ if "type" is not empty then only references of that "type" are listed.</code>
<code> [3]     ⍝ "type" can be either a simple string or a vector of strings.</code>
<code class="emphasize">→[4]  refs←⍎¨↓⎕NL 9</code>
<code class="emphasize">→[5]  :If 0≠≢type</code>
<code class="emphasize">→[6]      type←{(,∘⊂∘,⍣(1=≡,⍵))⍵}type</code>
<code class="emphasize">→[7]      refs/⍨←refs.Type∊type</code>
<code> [8]  :EndIf</code>
</div>
<code class="header" id="listing_125">#.Launchy.Launchy.RefNamespace.∆GetMethods &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←∆GetMethods</code>
<code> [1]     ⍝ Returns a list with all methods.</code>
<code> [2]     ⍝ Those are recognized by naming convention: their names start with a ∆ char.</code>
<code class="emphasize">→[3]  r←' '~¨⍨↓'∆'⎕NL 3</code>
</div>
<code class="header" id="listing_126">#.Launchy.Launchy.SelectAPL.CreateGUI2 &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (n2 options favourite)←CreateGUI2(n aplList default)</code>
<code class="emphasize">→[1]   n2←⎕NS''</code>
<code class="emphasize">→[2]   ∆←''</code>
<code class="emphasize">→[3]   ∆,←⊂'Caption' 'Launchy: APL selector'</code>
<code class="emphasize">→[4]   ∆,←⊂'Posn'(n.Form.Posn+30 40)</code>
<code class="emphasize">→[5]   ∆,←⊂'Size'(400 600)</code>
<code class="emphasize">→[6]   ∆,←⊂'MaxButton' 0</code>
<code class="emphasize">→[7]   ∆,←⊂'MinButton' 0</code>
<code class="emphasize">→[8]   ∆,←⊂'Sizeable' 0</code>
<code class="emphasize">→[9]   ∆,←⊂'Coord' 'Pixel'</code>
<code class="emphasize">→[10]  n2.Form←n.Form.⎕NEW'Form'∆</code>
<code class="emphasize">→[11]  n2.Form.MyFont←⎕NEW'Font'(('PName' 'APL385 Unicode')('Size' 16))</code>
<code> [12] </code>
<code class="emphasize">→[13]  ∆←''</code>
<code class="emphasize">→[14]  ∆,←⊂'Posn'(15 15)</code>
<code class="emphasize">→[15]  ∆,←⊂'Size'(⍬ ⍬)</code>
<code class="emphasize">→[16]  ∆,←⊂'Items'aplList</code>
<code class="emphasize">→[17]  ∆,←⊂'Style' 'Drop'</code>
<code class="emphasize">→[18]  ∆,←⊂'Rows'(1+⊃⍴aplList)</code>
<code class="emphasize">→[19]  n2.List←n2.Form.⎕NEW'ComboEx'∆</code>
<code> [20] </code>
<code class="emphasize">→[21]  l←0</code>
<code class="emphasize">→[22]  options←bit←type←⍬</code>
<code class="emphasize">→[23]  :For i :In ⍳⍴aplList</code>
<code class="emphasize">→[24]      this←i⊃aplList</code>
<code class="emphasize">→[25]      l+←1</code>
<code class="emphasize">→[26]      ∆←''</code>
<code class="emphasize">→[27]      ∆,←⊂'Caption'this</code>
<code class="emphasize">→[28]      ∆,←⊂'Style' 'Radio'</code>
<code class="emphasize">→[29]      ∆,←⊂'FontObj'n2.Form.MyFont</code>
<code class="emphasize">→[30]      ref←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[31]      ⍎'n2.ref',(¯2↑'0',⍕l),'←ref'</code>
<code class="emphasize">→[32]      :If 1=i</code>
<code class="emphasize">→[33]          ref.Posn←(15 15)</code>
<code> [34]      :Else</code>
<code class="emphasize">→[35]          ref.Posn←(((24×type≢15↓this)+(16×bit≢this[13 14])+(⊃{+⌿↑⍵.(Posn Size)}⊃¯1↑options)),15)</code>
<code> [36]      :EndIf</code>
<code class="emphasize">→[37]      options,←ref</code>
<code class="emphasize">→[38]      bit←this[13 14]</code>
<code class="emphasize">→[39]      type←15↓this</code>
<code> [40]  :EndFor</code>
<code> [41] </code>
<code class="emphasize">→[42]  :If 0=+/default</code>
<code class="emphasize">→[43]      favourite←⊃options</code>
<code> [44]  :Else</code>
<code class="emphasize">→[45]      favourite←(default⍳1)⊃options</code>
<code> [46]  :EndIf</code>
<code class="emphasize">→[47]  favourite.State←1</code>
<code> [48] </code>
<code class="emphasize">→[49]  ∆←''</code>
<code class="emphasize">→[50]  ∆,←⊂'Size'(⍬ 90)</code>
<code class="emphasize">→[51]  ∆,←⊂'Default' 1</code>
<code class="emphasize">→[52]  ∆,←⊂'Caption' 'OK'</code>
<code class="emphasize">→[53]  n2.OK←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[54]  n2.OK.Posn←(15+1⊃⊃⌈/##.AddPosnAndSize¨options),15</code>
<code> [55] </code>
<code class="emphasize">→[56]  ∆←''</code>
<code class="emphasize">→[57]  ∆,←⊂'Size'(⍬ 90)</code>
<code class="emphasize">→[58]  ∆,←⊂'Cancel' 1</code>
<code class="emphasize">→[59]  ∆,←⊂'Caption' 'Cancel'</code>
<code class="emphasize">→[60]  n2.Cancel←n2.Form.⎕NEW'Button'∆</code>
<code class="emphasize">→[61]  n2.Cancel.Posn←((n2.OK.Posn[1])),15+2⊃+⌿↑n2.OK.(Posn Size)</code>
<code class="emphasize">→[62]  n2.Form.Size[1]←(15+⊃+⌿↑n2.OK.(Posn Size))</code>
<code class="emphasize">→[63]  n2.Form.Size[2]←(15+2⊃##.AddPosnAndSize n2.Cancel)</code>
<code> [64] </code>
<code class="emphasize">→[65]  n2.(OK Cancel).onSelect←1</code>
</div>
<code class="header" id="listing_127">#.Launchy.Launchy.SelectAPL.DQ &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←giveFocusTo DQ form</code>
<code class="emphasize">→[1]  2 ⎕NQ giveFocusTo'GotFocus' ⋄ result←⎕DQ form</code>
<code class="emphasize">→[2]  r←n2.OK≡⊃result</code>
<code> [3] ⍝Done</code>
</div>
<code class="header" id="listing_128">#.Launchy.Launchy.CheckIni_Ride &mdash; 8%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  CheckIni_Ride←{</code>
<code> [1]       0≠Ini.⎕NC'RIDE':⍬</code>
<code class="emphasize">→[2]       msg←⊂'This version of Launchy expects a section [RIDE] to be found'</code>
<code class="emphasize">→[3]       msg,←⊂'in the INI file.'</code>
<code class="emphasize">→[4]       msg,←⊂''</code>
<code class="emphasize">→[5]       msg,←⊂'That''s not the case. It will work anyway with default values'</code>
<code class="emphasize">→[6]       msg,←⊂'but your are adviced to add such a section to the INI file.'</code>
<code class="emphasize">→[7]       msg,←⊂''</code>
<code class="emphasize">→[8]       msg,←⊂'See http://aplwiki.com/Launchy for details'</code>
<code class="emphasize">→[9]       _←'RIDE'Ini.⎕NS''</code>
<code class="emphasize">→[10]      Ini.RIDE.active←1</code>
<code class="emphasize">→[11]      Ini.RIDE.port←4502</code>
<code class="emphasize">→[12]      _←ShowMsg2 msg</code>
<code class="emphasize">→[13]      ⍬</code>
<code> [14]  }</code>
</div>
<code class="header" id="listing_129">#.Launchy.Launchy.CheckForInvalidIniEntries &mdash; 20%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  CheckForInvalidIniEntries←{</code>
<code> [1]       Ini←⍵</code>
<code> [2]       0=+/'path2ride'∘{⊃⍴(⍴⍺)↓⍵}¨' '~¨⍨↓Ini.RIDE.⎕NL 2:⍬</code>
<code class="emphasize">→[3]       0=+/'path2ride'{⍺∘≡¨(⍴⍺)↑¨⍵/⍨⍺∘{⊃⍴(⍴⍺)↓⍵}¨⍵}' '~¨⍨↓Ini.RIDE.⎕NL 2:⍬</code>
<code class="emphasize">→[4]       msg←⊂'I am afraid the INI file contains an invalid definition for'</code>
<code class="emphasize">→[5]       msg,←⊂''</code>
<code class="emphasize">→[6]       msg,←⊂'[Ride]path2ride*'</code>
<code class="emphasize">→[7]       msg,←⊂''</code>
<code class="emphasize">→[8]       msg,←'' 'Therefore Launchy cannot continue.'</code>
<code class="emphasize">→[9]       _←ShowMsg2 msg</code>
<code class="emphasize">→[10]      Off 1</code>
<code> [11]  }</code>
</div>
<code class="header" id="listing_130">#.Launchy.Launchy.CheckIni_DefaultDyalog &mdash; 20%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  CheckIni_DefaultDyalog←{</code>
<code> [1]       f←IniHas_DyalogDefault Ini</code>
<code> [2]       f∧←¯1≡¯1 R.GetValue GetAplLauncherRegistryKey,'DyalogDefaultIniWarning'</code>
<code> [3]       ~f:⍬</code>
<code class="emphasize">→[4]       msg←⊂'The INI file contains an entry:'</code>
<code class="emphasize">→[5]       msg,←⊂''</code>
<code class="emphasize">→[6]       msg,←⊂'  [DYALOG]'</code>
<code class="emphasize">→[7]       msg,←⊂'  default=...'</code>
<code class="emphasize">→[8]       msg,←⊂''</code>
<code class="emphasize">→[9]       msg,←⊂'which is no longer used. You are adviced to remove'</code>
<code class="emphasize">→[10]      msg,←⊂'this from your INI file in order to avoid confusion.'</code>
<code class="emphasize">→[11]      msg,←⊂''</code>
<code class="emphasize">→[12]      msg,←⊂'Please note: you won''t see this message again.'</code>
<code class="emphasize">→[13]      _←ShowMsg2 msg</code>
<code class="emphasize">→[14]      _←R.PutValue(GetAplLauncherRegistryKey,'DyalogDefaultIniWarning')1</code>
<code class="emphasize">→[15]      ⍬</code>
<code> [16]  }</code>
</div>
<code class="header" id="listing_131">#.Launchy.Launchy.ProcessIniFile &mdash; 37%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  Ini←ProcessIniFile errParms</code>
<code> [1]  ⍝ Process the main INI file (that MUST exist) and then check whether there is also</code>
<code> [2]  ⍝ an INI file for the current machine available. If that is the case, this one</code>
<code> [3]  ⍝ is processed as well. That way one cn overwrite general values with machine</code>
<code> [4]  ⍝ dependent ones.</code>
<code> [5]   errParms.addToErrMsg←' "ProcessIniFile"'</code>
<code> [6]   iniFilename←∆HomeDir,'\Launchy.ini'</code>
<code> [7]   iniFilename2←∆HomeDir,'\Launchy_',S.GetComputerName,'.ini'</code>
<code> [8]   :If ∧/⎕NEXISTS¨iniFilename iniFilename2</code>
<code> [9]       Ini←⎕NEW ##.IniFiles(,⊂iniFilename iniFilename2)</code>
<code> [10]  :ElseIf ⎕NEXISTS iniFilename</code>
<code class="emphasize">→[11]      Ini←⎕NEW ##.IniFiles(,⊂iniFilename)</code>
<code> [12]  :Else</code>
<code class="emphasize">→[13]      :If ⎕NEXISTS iniFilename,'.removeme'</code>
<code class="emphasize">→[14]          msg←'Cannot find the requiered INI file' ''</code>
<code class="emphasize">→[15]          msg,←'However, there is a file:'(iniFilename,'.removeme')''</code>
<code class="emphasize">→[16]          msg,←'Would you like me to rename this to 'iniFilename'and then process it?'</code>
<code class="emphasize">→[17]          :If YesOrNo msg</code>
<code class="emphasize">→[18]              (rc more)←(iniFilename,'.removeme')F.MoveTo iniFilename</code>
<code class="emphasize">→[19]              :If 0=rc</code>
<code class="emphasize">→[20]                  →1</code>
<code> [21]              :Else</code>
<code class="emphasize">→[22]                  msg←⊂'Something went wrong renaming the INI file!'</code>
<code class="emphasize">→[23]                  msg,←''('(RC=',(⍕rc),{0=≢⍵:')' ⋄ '; ',⍵,')'}more)</code>
<code class="emphasize">→[24]                  ShowMsg2 msg</code>
<code class="emphasize">→[25]                  Off</code>
<code> [26]              :EndIf</code>
<code> [27]          :Else</code>
<code class="emphasize">→[28]              ShowMsg2'Cannot find the requiered INI file'</code>
<code class="emphasize">→[29]              Off</code>
<code> [30]          :EndIf</code>
<code> [31]      :Else</code>
<code class="emphasize">→[32]          ShowMsg2'Cannot find the requiered INI file'</code>
<code class="emphasize">→[33]          Off</code>
<code> [34]      :EndIf</code>
<code> [35]  :EndIf</code>
<code> [36]  Ini←PolishPath_RIDE Ini</code>
<code> [37]  Ini←Ini.Convert ⎕NS''</code>
<code> [38]  CheckIni Ini</code>
<code> [39]  errParms.⎕EX'addToErrMsg'</code>
<code> [40]  :If 0=Ini.⎕NC'EXEC_SETUP'</code>
<code class="emphasize">→[41]      'EXEC_SETUP'Ini.⎕NS''</code>
<code class="emphasize">→[42]      Ini.EXEC_SETUP.default←1   ⍝ Establish default</code>
<code> [43]  :EndIf</code>
<code> [44] ⍝Done</code>
</div>
<code class="header" id="listing_132">#.Launchy.Launchy.CheckIni_WsSizeDefault &mdash; 38%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←CheckIni_WsSizeDefault Ini</code>
<code> [1]   r←⍬</code>
<code> [2]   :If ~0∊⍴Ini.WSSIZE.default</code>
<code> [3]   :AndIf ⊃⎕VFI Ini.WSSIZE.default</code>
<code class="emphasize">→[4]       Ini.WSSIZE.default,←'M'</code>
<code> [5]   :EndIf</code>
<code> [6]   v2←{⍵↓⍨+/∧\⍵∊⎕D}Ini.WSSIZE.default</code>
<code> [7]   :If ~(⊂v2)∊,¨'M' 'MB' 'G' 'GB'</code>
<code class="emphasize">→[8]       msg←⊂'I am afraid the INI file contains an invalid definition for'</code>
<code class="emphasize">→[9]       msg,←⊂''</code>
<code class="emphasize">→[10]      msg,←⊂'[WSSIZE]'</code>
<code class="emphasize">→[11]      msg,←⊂'default'</code>
<code class="emphasize">→[12]      msg,←'' 'Therefore Launchy cannot continue.'</code>
<code class="emphasize">→[13]      ShowMsg2 msg</code>
<code class="emphasize">→[14]      Off 1</code>
<code> [15]  :EndIf</code>
</div>
<code class="header" id="listing_133">#.Launchy.Launchy.CheckIni_WsSize &mdash; 50%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←CheckIni_WsSize Ini</code>
<code> [1]   r←⍬</code>
<code> [2]   :If ~0∊⍴v←','U.Split Ini.WSSIZE.options</code>
<code> [3]       num←∊⊃¨⎕VFI¨v</code>
<code> [4]       (num/v)←{0∊⍴⍵:⍬ ⋄ {⍵,'M'}¨⍵}num/v</code>
<code> [5]       v2←↑{⍵{(⍵↑⍺)(⍵↓⍺)}+/∧\⍵∊⎕D}¨v</code>
<code> [6]       bool←v2[;2]∊,¨'M' 'MB' 'G' 'GB'</code>
<code> [7]       :If ∧/bool</code>
<code> [8]           Ini.WSSIZE.options←↑,/{⍺,',',⍵}/v</code>
<code> [9]       :Else</code>
<code class="emphasize">→[10]          msg←⊂'I am afraid the INI file contains invalid definitions for'</code>
<code class="emphasize">→[11]          msg,←⊂''</code>
<code class="emphasize">→[12]          msg,←⊂'[WSSIZE]'</code>
<code class="emphasize">→[13]          msg,←⊂'options'</code>
<code class="emphasize">→[14]          msg,←⊂'(',(⊃{⍺,',',⍵}/(~bool)/v),')'</code>
<code class="emphasize">→[15]          msg,←'' 'Therefore Launchy cannot continue.'</code>
<code class="emphasize">→[16]          ShowMsg2 msg</code>
<code class="emphasize">→[17]          Off 1</code>
<code> [18]      :EndIf</code>
<code> [19]  :EndIf</code>
</div>
<code class="header" id="listing_134">#.Launchy.Launchy.EnableEarlyRide &mdash; 50%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  EnableEarlyRide←{</code>
<code> [1]  ⍝ For debugging Launchy's EXE.</code>
<code> [2]  ⍝ Requires also a command line parameter like</code>
<code> [3]  ⍝ RIDEPORT=6000</code>
<code> [4]       ⍵=0:r←⍬</code>
<code> [5]       clp←2 ⎕NQ #'GetCommandLineArgs'</code>
<code> [6]       b←'RidePort'∘{(1 ⎕C ⍺)≡(⍴⍺)↑1 ⎕C ⍵}¨clp</code>
<code> [7]       0=+/b:r←⍬</code>
<code class="emphasize">→[8]       0=≢portno←(⍴'RidePort=')↓(b⍳1)⊃clp:r←⍬</code>
<code class="emphasize">→[9]       _←3502⌶'SERVE::',portno</code>
<code class="emphasize">→[10]      _←3502⌶1</code>
<code class="emphasize">→[11]      {_←⎕DL 1 ⋄ ∇ ⍬}⍬  ⍝ Endless loop allows user to get a ride.</code>
<code> [12]  }</code>
</div>
<code class="header" id="listing_135">#.Launchy.Launchy.GetInstalledAPLs &mdash; 55%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  list←GetInstalledAPLs dummy</code>
<code> [1]  ⍝ Examines the Registry in order to find out which versions of</code>
<code> [2]  ⍝ Dyalog are installed on the current machine</code>
<code> [3]   :If 0∊≢list←R.GetAllSubKeyNames'Software\Dyalog'</code>
<code> [4]   :OrIf 0∊≢list←(50&lt;⊃∘⍴¨R.GetAllValueNames¨(⊂'Software\Dyalog\'),¨list)/list</code>
<code class="emphasize">→[5]       msg←⊂'No version of Dyalog was found'</code>
<code class="emphasize">→[6]       msg,←⊂''</code>
<code class="emphasize">→[7]       msg,←⊂'In case you have just installed Dyalog'</code>
<code class="emphasize">→[8]       msg,←⊂'you might need to reboot your machine now.'</code>
<code class="emphasize">→[9]       'Launchy'ShowMsg2 msg</code>
<code> [10]  :Else</code>
<code> [11]      list←{⍵⌿⍨∨/'Dyalog APL/W'⍷↑⍵}list</code>
<code> [12]      list←2⊃¨'\'U.SplitPath¨list</code>
<code> [13]      list←(0&lt;⊃∘⍴¨list~¨' ')/list</code>
<code> [14]      list←list[⍒{⍎⊃{⍵/⍨⊃∘⊃∘⎕VFI¨⍵}⍵⊂⍨' '=⍵}¨list]</code>
<code> [15]  :EndIf</code>
</div>
<code class="header" id="listing_136">#.Launchy.Launchy.CreateVersions &mdash; 59%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateVersions n</code>
<code> [1]  ⍝</code>
<code> [2]   (aplList orig)←GetListOfAPLs G</code>
<code> [3]   (aplList indents orig)←MassageAplList aplList orig</code>
<code> [4]   whichVersion←orig≡¨⊂G.Default</code>
<code> [5]   :If okFlag←1=+/whichVersion                ⍝ Exactly one default - fine!</code>
<code> [6]       G.LastSelectedVersion←(whichVersion⍳1)⊃orig</code>
<code> [7]   :Else</code>
<code class="emphasize">→[8]       :If IniHas_DyalogDefault Ini</code>
<code class="emphasize">→[9]       :AndIf (⊂Ini.DYALOG.default)∊G.AplVersions</code>
<code> [10]      ⍝ We do this only once to support the user with old INI files.</code>
<code class="emphasize">→[11]          G.Default←Ini.DYALOG.default</code>
<code class="emphasize">→[12]          whichVersion←G.AplVersions≡¨⊂G.Default</code>
<code class="emphasize">→[13]          okFlag←1</code>
<code> [14]      :Else</code>
<code class="emphasize">→[15]          G.Default←⊃G.AplVersions               ⍝ Make the first one the default, at least for the time being</code>
<code class="emphasize">→[16]          whichVersion←(⍴aplList)⍴0</code>
<code class="emphasize">→[17]          whichVersion[indents⍳2]←1</code>
<code> [18]      :EndIf</code>
<code class="emphasize">→[19]      G.LastSelectedVersion←G.Default</code>
<code> [20]  :EndIf</code>
<code> [21] </code>
<code> [22]  ∆←''</code>
<code> [23]  ∆,←⊂'Caption'(' ',(⍕⍴G.AplVersions),' APL Version',((1&lt;⍴G.AplVersions)/'s'),' installed ')</code>
<code> [24]  ∆,←⊂'Posn'(8 2)</code>
<code> [25]  ∆,←⊂'Size'(50,n.Form.Size[2]-5)</code>
<code> [26]  n.AplVersionGroup←n.Form.⎕NEW'Group'∆</code>
<code> [27] </code>
<code> [28]  ∆←''</code>
<code> [29]  ∆,←⊂'Posn'(20 10)</code>
<code> [30]  ∆,←⊂'Size'(⍬(n.AplVersionGroup.Size[2]-2×10))</code>
<code> [31]  ∆,←⊂'Items'aplList</code>
<code> [32]  ∆,←⊂'indents'indents</code>
<code> [33]  ∆,←⊂'Style' 'Drop'</code>
<code> [34]  ∆,←⊂'Rows'(2+≢aplList)</code>
<code> [35]  ∆,←⊂'TipObj'n.tip</code>
<code> [36]  ∆,←⊂'Tip' 'The default version is marked with a ★'</code>
<code> [37]  ∆,←⊂'SelItems'whichVersion</code>
<code> [38]  n.List←n.AplVersionGroup.⎕NEW'ComboEx'∆</code>
<code> [39]  n.List.onKeyPress←'OnKeyPressInList'</code>
<code> [40]  n.List.onSelect←'OnSelectList'</code>
<code> [41]  n.List.∆Orig←orig</code>
<code> [42]  n.List.∆DefaultSelection←whichVersion</code>
<code> [43] </code>
<code> [44]  :If 0=okFlag</code>
<code class="emphasize">→[45]  :AndIf ~0∊≢G.AplVersions</code>
<code class="emphasize">→[46]      msg←''</code>
<code class="emphasize">→[47]      msg,←⊂'There was no default version of Dyalog defined yet.'</code>
<code class="emphasize">→[48]      msg,←⊂'This version was selected as default for you:'</code>
<code class="emphasize">→[49]      msg,←⊂''</code>
<code class="emphasize">→[50]      msg,←⊂'   ',G.Default</code>
<code class="emphasize">→[51]      msg,←⊂''</code>
<code class="emphasize">→[52]      msg,←⊂'You can change this via the "Options" menu (F4).'</code>
<code class="emphasize">→[53]      ShowMsg2 msg</code>
<code> [54]  :EndIf</code>
<code> [55] ⍝Done</code>
</div>
<code class="header" id="listing_137">#.Launchy.Launchy.MassageAplList &mdash; 60%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (list2 indents orig)←MassageAplList(list orig)</code>
<code> [1]   b←∨/¨' Unicode'∘⍷¨list</code>
<code> [2]   :If (∧/b)∨∧/~b                     ⍝ All Unicode or all Classic?</code>
<code> [3]       (list2 indents)←0 MassageAplList_ list</code>
<code> [4]   :Else                              ⍝ A mix</code>
<code class="emphasize">→[5]       (list2 indents)←1 MassageAplList_(+/b)↑list</code>
<code class="emphasize">→[6]       list2←(⊂'Unicode'),list2</code>
<code class="emphasize">→[7]       indents←0,indents</code>
<code class="emphasize">→[8]       (l3 indents2)←1 MassageAplList_(+/b)↓list</code>
<code class="emphasize">→[9]       list2,←(⊂'Classic'),l3</code>
<code class="emphasize">→[10]      indents,←0,indents2</code>
<code> [11]  :EndIf</code>
<code> [12]  bool←∨/¨'Dyalog'∘⍷¨list2</code>
<code> [13]  orig←bool\orig</code>
<code> [14]  (bool/list2)←{⍵,¨⍨{(≢⍵)↑9↑⍵}{(2 0⍕⍵),'. '}¨⍳≢⍵}bool/list2</code>
<code> [15]  list2←' ',¨list2</code>
<code> [16]  indents×←2</code>
<code> [17] ⍝ (list2 indents orig)←(~2 2⍷indents)∘/¨list2 indents orig</code>
<code> [18] ⍝Done</code>
</div>
<code class="header" id="listing_138">#.Launchy.Launchy.GetWinCoords &mdash; 64%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←GetWinCoords aplVers</code>
<code> [1]   ⍝ Set a couple of globals defining the coordinates of Edit windows and</code>
<code> [2]   ⍝ possibly also Tracer windows.</code>
<code> [3]   ⍝ Depends on the user's choice regarding the version of Dyalog.</code>
<code> [4]   r←⍬</code>
<code> [5]   :If 0∊⍴aplVers</code>
<code class="emphasize">→[6]       G.ED_Cols←80</code>
<code class="emphasize">→[7]       G.ED_Rows←50</code>
<code class="emphasize">→[8]       G.ED_FirstX←0</code>
<code class="emphasize">→[9]       G.ED_FirstY←0</code>
<code> [10]  :Else</code>
<code> [11]      rp←GetRegPathForCurrentDyalogVersion aplVers</code>
<code> [12]      G.ED_Cols←⍎'⍬'R.GetString rp,'\edit_cols'</code>
<code> [13]      G.ED_Rows←⍎'⍬'R.GetString rp,'\edit_rows'</code>
<code> [14]      G.ED_FirstX←⍎'⍬'R.GetString rp,'\edit_first_x'</code>
<code> [15]      G.ED_FirstY←⍎'⍬'R.GetString rp,'\edit_first_y'</code>
<code> [16]  :EndIf</code>
</div>
<code class="header" id="listing_139">#.Launchy.Launchy.HasWorkDir &mdash; 67%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←HasWorkDir</code>
<code> [1]  r←1</code>
<code> [2]  :If Ini.CONFIG.⎕NC'workDir'</code>
<code class="emphasize">→[3]      r←~0∊⍴Ini.CONFIG.workDir</code>
<code> [4]  :EndIf</code>
</div>
<code class="header" id="listing_140">#.Launchy.Launchy.IniHas_DyalogDefault &mdash; 67%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> IniHas_DyalogDefault←{</code>
<code> [1]      Ini←⍵</code>
<code> [2]      0=Ini.⎕NC'DYALOG':0</code>
<code class="emphasize">→[3]      0&lt;Ini.DYALOG.⎕NC'default'</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_141">#.Launchy.Launchy.GetCaption &mdash; 75%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetCaption</code>
<code> [1]  r←'Launchy ',2⊃Version</code>
<code> [2]  :If 0=≢⎕WSID ⍝ When running as an installed EXE, ⎕WSID would be empty</code>
<code class="emphasize">→[3]      r↑⍨←¯1+r⍳'+'</code>
<code> [4]  :EndIf</code>
<code> [5]  r,←S.IsRunningAsAdmin/' (elevated)'</code>
</div>
<code class="header" id="listing_142">#.Launchy.Launchy.Init1 &mdash; 77%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  Ini←Init1 homedir</code>
<code> [1]  ⍝ Establish a couple of essentials</code>
<code> [2]   U←##.APLTreeUtils2</code>
<code> [3]   F←##.FilesAndDirs</code>
<code> [4]   R←##.WinReg</code>
<code> [5]   S←##.WinSys</code>
<code> [6]   :If 0=≢homedir</code>
<code> [7]       :If U.IsDevelopment</code>
<code> [8]       :AndIf 'Launchy.exe'≢⊃,/1↓⎕NPARTS 1⊃2 ⎕NQ #'GetCommandLineArgs'</code>
<code> [9]           :If 9=##.⎕NC'CiderConfig'</code>
<code> [10]              ∆HomeDir←##.CiderConfig.HOME</code>
<code> [11]          :Else</code>
<code class="emphasize">→[12]              ∆HomeDir←F.PWD</code>
<code> [13]          :EndIf</code>
<code> [14]      :Else</code>
<code class="emphasize">→[15]          ∆HomeDir←(S.ExpandEnv'%localappdata%'),'\Launchy'</code>
<code> [16]      :EndIf</code>
<code> [17]  :Else</code>
<code class="emphasize">→[18]      ∆HomeDir←homedir</code>
<code> [19]  :EndIf</code>
<code> [20]  EnableEarlyRide 1</code>
<code> [21] ⍝Done</code>
</div>
<code class="header" id="listing_143">#.Launchy.Launchy.CreateGlobals &mdash; 80%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←CreateGlobals Ini</code>
<code> [1]   r←⍬</code>
<code> [2]   ⎕EX'G'</code>
<code> [3]   G←⎕NS''</code>
<code> [4]   G.Home←∆HomeDir</code>
<code> [5]   G.Posn←⍎Ini.CONFIG.GUI_posn R.GetString GetAplLauncherRegistryKey,'Posn'</code>
<code> [6]   G.ShowTips←1 R.GetValue GetAplLauncherRegistryKey,'ShowTips'</code>
<code> [7]   G.RestoreDefaults←0 R.GetValue GetAplLauncherRegistryKey,'RestoreDefaults'</code>
<code> [8]   G.ShowCMD←0 R.GetValue GetAplLauncherRegistryKey,'ShowCmd'</code>
<code> [9]   G.SE_FontSize←GetProperAPL_FontSize</code>
<code> [10]  G.AplVersions←GetInstalledAPLs ⍬</code>
<code> [11]  :If ','∊G.CMDs←''R.GetString GetAplLauncherRegistryKey,'CommandLineArgs'</code>
<code class="emphasize">→[12]      G.CMDs←','U.Split G.CMDs</code>
<code class="emphasize">→[13]      G.CMDs←(0&lt;≢¨G.CMDs)/G.CMDs</code>
<code class="emphasize">→[14]      G.CMDs←⊃{⍺,' ',⍵}/G.CMDs</code>
<code> [15]  :EndIf</code>
<code> [16]  G.Default←GetDefaultFromRegistry G.AplVersions</code>
<code> [17]  :If 0=≢G.RideVersions←Find_RIDE_Versions Ini</code>
<code class="emphasize">→[18]      G.RideVersion←''</code>
<code> [19]  :Else</code>
<code> [20]      G.RideVersion←2⊃⊢⌿G.RideVersions</code>
<code> [21]  :EndIf</code>
<code> [22]  G.Iconify←Ini.CONFIG.iconify R.GetValue GetAplLauncherRegistryKey,'Iconify'</code>
<code> [23]  {}GetWinCoords G.Default</code>
<code> [24] ⍝Done</code>
</div>
<code class="header" id="listing_144">#.Launchy.Launchy.Shutdown &mdash; 83%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> {r}←Shutdown testFlag</code>
<code> [1]  r←⍬</code>
<code> [2]  #.IconObj←''</code>
<code> [3]  #.onActivateApp←0</code>
<code> [4]  SavePropsInRegistry</code>
<code> [5]  :If 0=testFlag</code>
<code class="emphasize">→[6]      Off</code>
<code> [7]  :EndIf</code>
<code> [8] ⍝Done</code>
</div>
<code class="header" id="listing_145">#.Launchy.Launchy.CreateRide &mdash; 94%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateRide n</code>
<code> [1]   f←0≠≢G.RideVersions                           ⍝ At least one RIDE exe must be known</code>
<code> [2]  </code>
<code> [3]   posn←(5+⊃+⌿↑n.wssize.(Posn Size)),12</code>
<code> [4]  </code>
<code> [5]   ∆←''</code>
<code> [6]   ∆,←⊂'Style' 'Check'</code>
<code> [7]   ∆,←⊂'Caption' 'Ask for &amp;RIDE'</code>
<code> [8]   ∆,←⊂'Active'f</code>
<code> [9]   :If 0&lt;Ini.⎕NC'RIDE'</code>
<code> [10]  :AndIf 0&lt;Ini.RIDE.⎕NC'tick'</code>
<code> [11]      ∆,←⊂'State'Ini.RIDE.tick</code>
<code> [12]  :Else</code>
<code class="emphasize">→[13]      ∆,←⊂'Active' 0</code>
<code> [14]  :EndIf</code>
<code> [15]  ∆,←⊂'TipObj'n.tip</code>
<code> [16]  ∆,←⊂'Tip'('Let Launchy ask whether Dyalog should try to' 'connect to RIDE')</code>
<code> [17]  n.RIDEflag←n.Form.⎕NEW'Button'∆</code>
<code> [18]  n.RIDEflag.Posn←posn</code>
<code> [19]  n.RIDEflag.tip←GetRideMsg ⍬</code>
<code> [20]  n.RIDEflag.onSelect←'OnChangeRide'</code>
<code> [21] ⍝Done</code>
</div>
<code class="header" id="listing_146">#.Launchy.Launchy.Run &mdash; 95%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{homedir}Run testFlag</code>
<code> [1]   ⎕IO←1 ⋄ ⎕ML←1 ⋄ ⎕WX←3</code>
<code> [2]   r←⍬</code>
<code> [3]   homedir←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'homedir'</code>
<code> [4]   ##.FilesAndDirs.PolishCurrentDir</code>
<code> [5]   ⎕TRAP←##.HandleError.SetTrap ⍬</code>
<code> [6]   Init1 homedir</code>
<code> [7]   #.⎕SHADOW'ErrorParms'</code>
<code> [8]   #.ErrorParms←##.HandleError.CreateParms</code>
<code> [9]   #.ErrorParms.customFnsParent←⎕THIS</code>
<code> [10]  #.ErrorParms.customFns←'SayGoodByeAfterError'</code>
<code> [11]  :If U.IsDevelopment</code>
<code> [12]      #.ErrorParms.errorFolder←homedir,'\Errors\'</code>
<code> [13]  :Else</code>
<code class="emphasize">→[14]      #.ErrorParms.errorFolder←(S.ExpandEnv'%localappdata%'),'\Launchy\Errors\'</code>
<code> [15]  :EndIf</code>
<code> [16]  'Create!'F.CheckPath #.ErrorParms.errorFolder</code>
<code> [17]  ⎕TRAP←##.HandleError.SetTrap'#.ErrorParms'</code>
<code> [18]  Ini←Init2 #.ErrorParms</code>
<code> [19]  n←CreateGui testFlag</code>
<code> [20]  n.∆Port←Ini.RIDE.port</code>
<code> [21]  DQ'.'</code>
<code> [22] ⍝Done</code>
</div>
<code class="header" id="listing_147">#.Launchy.Launchy.CreateForm &mdash; 97%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateForm testFlag</code>
<code> [1]   n←RefNamespace.Create'Dyalog Launcher GUI'</code>
<code> [2]   :If ~U.IsDevelopment</code>
<code class="emphasize">→[3]       #.Caption←GetCaption</code>
<code> [4]   :EndIf</code>
<code> [5]   n.MyFont←⎕NEW'Font'(('PName' 'Segoe UI')('Size' 16))</code>
<code> [6]   ∆←''</code>
<code> [7]   ∆,←⊂'Caption'GetCaption</code>
<code> [8]   ∆,←⊂'Posn'G.Posn</code>
<code> [9]   ∆,←⊂'Size'(345 405)</code>
<code> [10]  ∆,←⊂'MaxButton' 0</code>
<code> [11]  ∆,←⊂'Coord' 'Pixel'</code>
<code> [12]  ∆,←⊂'Sizeable' 0</code>
<code> [13]  ∆,←⊂'FontObj'n.MyFont</code>
<code> [14]  n.Form←⎕NEW'Form'∆</code>
<code> [15]  n.Form.n←n</code>
<code> [16]  n.Form.onKeyPress←'OnStandardKeyPress'</code>
<code> [17]  n.Form.onClose←'OnClose'testFlag</code>
<code> [18] </code>
<code> [19]  n.Icon←⎕NEW'Icon'(('CBits'TheIcon.CBits)('Mask'TheIcon.Mask))</code>
<code> [20]  n.Form.IconObj←n.Icon</code>
<code> [21]  #.IconObj←n.Icon</code>
<code> [22]  ∆←''</code>
<code> [23]  ∆,←⊂'PName' 'APL385 Unicode'</code>
<code> [24]  n.aplFont←n.Form.⎕NEW'Font'∆</code>
<code> [25]  n.aplFont.Size←15</code>
<code> [26] </code>
<code> [27]  n←CreateTipObject n</code>
<code> [28] </code>
<code> [29]  ∆←''</code>
<code> [30]  ∆,←⊂'Bits'(1⊃Dyalog_BM)</code>
<code> [31]  ∆,←⊂'CMap'(2⊃Dyalog_BM)</code>
<code> [32]  ∆,←⊂'Mask'(3⊃Dyalog_BM)</code>
<code> [33]  n.Icon←⎕NEW'Icon'∆</code>
<code> [34] ⍝Done</code>
</div>
<code class="header" id="listing_148">#.Launchy.Launchy.AddPosnAndSize &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> AddPosnAndSize←{</code>
<code> [1]      +⌿↑⍵.(Posn Size)</code>
<code> [2]  }</code>
</div>
<code class="header" id="listing_149">#.Launchy.Launchy.CheckIni &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> {r}←CheckIni Ini</code>
<code> [1] ⍝ Checks certain things</code>
<code> [2]  r←⍬</code>
<code> [3]  {}CheckIni_Ride Ini</code>
<code> [4]  {}CheckIni_DefaultDyalog Ini</code>
<code> [5]  {}CheckIni_WsSize Ini</code>
<code> [6]  {}CheckIni_WsSizeDefault Ini</code>
<code> [7]  {}CheckForInvalidIniEntries Ini</code>
<code> [8] ⍝Done</code>
</div>
<code class="header" id="listing_150">#.Launchy.Launchy.CloseForm &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> CloseForm←{6::shy←⍬ ⋄ shy←2 ⎕NQ n.Form'Close'}</code>
</div>
<code class="header" id="listing_151">#.Launchy.Launchy.CopyTips &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> {r}←CopyTips ref</code>
<code> [1] ⍝ Copy the value of "Tip" in "ref" to "∆Tip" but only if it is not empty</code>
<code> [2]  r←⍬</code>
<code> [3]  :If 0&lt;≢t←ref.Tip</code>
<code> [4]      tip←⊃{⍺,(⎕UCS 10),⍵}/⊆t</code>
<code> [5]      ref.{⎕THIS.∆Tip←⍵}tip</code>
<code> [6]  :EndIf</code>
</div>
<code class="header" id="listing_152">#.Launchy.Launchy.CreateButtons &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateButtons n</code>
<code> [1]   ∆←''</code>
<code> [2]   ∆,←⊂'Caption' 'Launch APL'</code>
<code> [3]   ∆,←⊂'Size'(⍬ 80)</code>
<code> [4]   ∆,←⊂'Accelerator'(13 2)</code>
<code> [5]   ∆,←⊂'TipObj'n.tip</code>
<code> [6]   ∆,←⊂'Active'(~0∊≢G.AplVersions)</code>
<code> [7]   n.ok←n.Form.⎕NEW'Button'∆</code>
<code> [8]   n.ok.Posn[1]←n.Form.Size[1]-n.ok.Size[1]+n.SB.Size[1]+10</code>
<code> [9]   n.ok.Posn[2]←10</code>
<code> [10]  n.ok.onSelect←'OnLaunchAPL'</code>
<code> [11]  n.ok.onKeyPress←'OnKeyPressInPushButton'</code>
<code> [12]  n.ok.Tip←'"Click" with &lt;Ctrl+Enter&gt;'</code>
<code> [13] </code>
<code> [14]  ∆←''</code>
<code> [15]  ∆,←⊂'Caption' 'Create LN&amp;K'</code>
<code> [16]  ∆,←⊂'Size'(⍬ 80)</code>
<code> [17]  ∆,←⊂'TipObj'n.tip</code>
<code> [18]  ∆,←⊂'Active'(0≠≢G.AplVersions)</code>
<code> [19]  n.lnk←n.Form.⎕NEW'Button'∆</code>
<code> [20]  n.lnk.Posn[1]←n.Form.Size[1]-n.ok.Size[1]+n.SB.Size[1]+10</code>
<code> [21]  n.lnk.onSelect←'OnCreateLNK'</code>
<code> [22]  n.lnk.Tip←'Create an LNK file (shortcut) with all',(⎕UCS 10),'the parameters currently defined.'</code>
<code> [23] </code>
<code> [24]  ∆←''</code>
<code> [25]  ∆,←⊂'Caption' 'Restore defaults'</code>
<code> [26]  ∆,←⊂'Size'(⍬ 110)</code>
<code> [27]  ∆,←⊂'Active' 0</code>
<code> [28]  ∆,←⊂'TipObj'n.tip</code>
<code> [29]  ∆,←⊂'Tip' 'Restore all controls to their default settings'</code>
<code> [30]  n.reset←n.Form.⎕NEW'Button'∆</code>
<code> [31]  n.reset.Posn[1]←n.Form.Size[1]-n.ok.Size[1]+n.SB.Size[1]+10</code>
<code> [32]  n.reset.Posn[2]←n.Form.Size[2]-n.reset.Size[2]+10</code>
<code> [33]  n.reset.onSelect←'OnResetDefaults'</code>
<code> [34]  n.reset.onKeyPress←'OnKeyPressInPushButton'</code>
<code> [35] ⍝Done</code>
</div>
<code class="header" id="listing_153">#.Launchy.Launchy.CreateCommandLine &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateCommandLine n</code>
<code> [1]  </code>
<code> [2]   ∆←''</code>
<code> [3]   ∆,←⊂'Posn'(200 10)</code>
<code> [4]   ∆,←⊂'Size'(80(n.Form.Size[2]-25))</code>
<code> [5]   ∆,←⊂'Caption' '&amp;Command line parameters'</code>
<code> [6]   n.CmdLineGroup←n.Form.⎕NEW'Group'∆</code>
<code> [7]  </code>
<code> [8]   ∆←''</code>
<code> [9]   ∆,←⊂'Posn'(20 5)</code>
<code> [10]  ∆,←⊂'Size'(⍬(n.CmdLineGroup.Size[2]-10))</code>
<code> [11]  ∆,←⊂'Text'G.CMDs</code>
<code> [12]  ∆,←⊂'TipObj'n.tip</code>
<code> [13]  n.cmdLineArgs←n.CmdLineGroup.⎕NEW'Edit'∆</code>
<code> [14]  n.cmdLineArgs.Size[1]-←4</code>
<code> [15]  n.cmdLineArgs.Tip←'Add here additional "free" parameters'</code>
<code> [16]  n.cmdLineArgs.onSelect←'OnChanged' 'CMDLINE'</code>
<code> [17]  n.cmdLineArgs.onKeyPress←'OnStandardKeyPress'</code>
<code> [18] </code>
<code> [19]  ∆←''</code>
<code> [20]  ∆,←⊂'Posn'((4+⊃+⌿↑n.cmdLineArgs.(Posn Size))5)</code>
<code> [21]  ∆,←⊂'Caption' 'Save "Command line" on &amp;quit'</code>
<code> [22]  ∆,←⊂'State' 1</code>
<code> [23]  ∆,←⊂'Style' 'Check'</code>
<code> [24]  ∆,←⊂'TipObj'n.tip</code>
<code> [25]  n.saveCmdLineOnQuit←n.CmdLineGroup.⎕NEW'Button'∆</code>
<code> [26]  n.saveCmdLineOnQuit.Tip←'If ticked the contents of',SEP,'"Command line parameters"',SEP,'is saved in the Registry'</code>
<code> [27]  n.cmdLineArgs.onKeyPress←'OnStandardKeyPress'</code>
<code> [28]  ⍝Done</code>
</div>
<code class="header" id="listing_154">#.Launchy.Launchy.CreateDebugFlags &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateDebugFlags n</code>
<code> [1]   ∆←''</code>
<code> [2]   ∆,←⊂'Caption' ' Debug flags '</code>
<code> [3]   ∆,←⊂'Posn'(65 2)</code>
<code> [4]   ∆,←⊂'Size'(70 220)</code>
<code> [5]   n.DebugGroup←n.Form.⎕NEW'Group'∆</code>
<code> [6]  </code>
<code> [7]   ∆←''</code>
<code> [8]   ∆,←⊂'Caption' 'Check workspace &amp;integrity...'</code>
<code> [9]   ∆,←⊂'Posn'(15 10)</code>
<code> [10]  n.Info←n.DebugGroup.⎕NEW'Label'∆</code>
<code> [11] </code>
<code> [12]  ∆←''</code>
<code> [13]  ∆,←⊂'Style' 'Drop'</code>
<code> [14]  ∆,←⊂'Items'Ini.WS_CHECK.list</code>
<code> [15]  ∆,←⊂'SelItems'(Ini.WS_CHECK.default=⊃¨Ini.WS_CHECK.list)</code>
<code> [16]  ∆,←⊂'Posn'(40 10)</code>
<code> [17]  ∆,←⊂'Size'(⍬ 210)</code>
<code> [18]  ∆,←⊂'TipObj'n.tip</code>
<code> [19]  n.debug←n.DebugGroup.⎕NEW'Combo'∆</code>
<code> [20]  n.debug.Tip←'Specify when a workspace integrity check shall be performed.' 'The closer to a problem a check is performed the better.'</code>
<code> [21]  n.debug.onSelect←'OnChanged' 'DEBUGFLAG'</code>
<code> [22]  n.debug.onKeyPress←'OnStandardKeyPress'</code>
<code> [23] ⍝Done</code>
</div>
<code class="header" id="listing_155">#.Launchy.Launchy.CreateFlags &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateFlags n</code>
<code> [1]   startAt←10+2⊃+⌿↑n.DebugGroup.(Posn Size)</code>
<code> [2]  </code>
<code> [3]   add←22      ⍝ Horizontal distance</code>
<code> [4]   hor←60      ⍝ Horizontal starting point</code>
<code> [5]  </code>
<code> [6]   ∆←''</code>
<code> [7]   ∆,←⊂'Posn'(hor startAt)</code>
<code> [8]   hor+←add</code>
<code> [9]   ∆,←⊂'Style' 'Check'</code>
<code> [10]  ∆,←⊂'Caption' 'Run as admin o&amp;nce'</code>
<code> [11]  ∆,←⊂'TipObj'n.tip</code>
<code> [12]  n.runAsAdmin←n.Form.⎕NEW'Button'∆</code>
<code> [13]  n.runAsAdmin.Tip←⊂'Run Dyalog with admin rights (elevated mode) but just once.'</code>
<code> [14]  n.runAsAdmin.Tip,←⊂'Note: NO drag''n-drop when running as an admin!'</code>
<code> [15]  n.runAsAdmin.onSelect←'OnChanged' 'RUNASADMIN'</code>
<code> [16]  n.runAsAdmin.onKeyPress←'OnStandardKeyPress'</code>
<code> [17] </code>
<code> [18]  ∆←''</code>
<code> [19]  ∆,←⊂'Posn'(hor startAt)</code>
<code> [20]  hor+←add</code>
<code> [21]  ∆,←⊂'Style' 'Check'</code>
<code> [22]  ∆,←⊂'Caption' 'E&amp;xecute setup.dyalog'</code>
<code> [23]  ∆,←⊂'TipObj'n.tip</code>
<code> [24]  flag←F.IsFile F.NormalizePath'%USERPROFILE%\Documents\MyUCmds\setup.dyalog'</code>
<code> [25]  ∆,←⊂'Active'flag</code>
<code> [26]  ∆,←⊂'State'flag</code>
<code> [27]  n.ExecMySetup←n.Form.⎕NEW'Button'∆</code>
<code> [28]  n.ExecMySetup.Tip←''</code>
<code> [29]  n.ExecMySetup.Tip,←⊂'Toggles whether'</code>
<code> [30]  n.ExecMySetup.Tip,←⊂'%USERPROFILE%\Documents\MyUCmds\setup.dyalog'</code>
<code> [31]  n.ExecMySetup.Tip,←⊂'should be executed or not.'</code>
<code> [32]  n.ExecMySetup.Tip,←⊂'This passes -exec_setup=0|1 on the command line.'</code>
<code> [33]  n.ExecMySetup.Tip,←⊂'Setup.dyalog needs to take care of that itself.'</code>
<code> [34]  n.ExecMySetup.Tip,←⊂'Leave unticked for Dyalog''s default setup.'</code>
<code> [35]  n.ExecMySetup.onSelect←'OnChanged' 'EXEC_MY_SETUP'</code>
<code> [36]  n.ExecMySetup.onKeyPress←'OnStandardKeyPress'</code>
<code> [37] </code>
<code> [38]  ∆←''</code>
<code> [39]  ∆,←⊂'Posn'(hor startAt)</code>
<code> [40]  hor+←add</code>
<code> [41]  ∆,←⊂'Style' 'Check'</code>
<code> [42]  ∆,←⊂'Caption' '&amp;Stop in setup.dyalog'</code>
<code> [43]  ∆,←⊂'TipObj'n.tip</code>
<code> [44]  flag←##.FilesAndDirs.IsFile ##.FilesAndDirs.NormalizePath'%USERPROFILE%\Documents\MyUCmds\setup.dyalog'</code>
<code> [45]  ∆,←⊂'Active'flag</code>
<code> [46]  n.StopSetup←n.Form.⎕NEW'Button'∆</code>
<code> [47]  n.StopSetup.Tip←''</code>
<code> [48]  n.StopSetup.Tip,←⊂'If ticked -stop_in_setup is passed as command line parameter.'</code>
<code> [49]  n.StopSetup.Tip,←⊂'Setup.dyalog needs to take care of that itself.'</code>
<code> [50]  n.StopSetup.onSelect←'OnChanged' 'STOP_IN_SETUP'</code>
<code> [51]  n.StopSetup.onKeyPress←'OnStandardKeyPress'</code>
<code> [52] </code>
<code> [53]  ∆←''</code>
<code> [54]  ∆,←⊂'Posn'(hor startAt)</code>
<code> [55]  hor+←add</code>
<code> [56]  ∆,←⊂'Style' 'Check'</code>
<code> [57]  ∆,←⊂'Caption' '&amp;DyalogWSLoadedStop'</code>
<code> [58]  ∆,←⊂'TipObj'n.tip</code>
<code> [59]  n.DyalogWSLoadedStop←n.Form.⎕NEW'Button'∆</code>
<code> [60]  n.DyalogWSLoadedStop.Tip←''</code>
<code> [61]  n.DyalogWSLoadedStop.Tip,←⊂'Makes Dyalog stop at a very early stage.'</code>
<code> [62]  n.DyalogWSLoadedStop.Tip,←⊂'Useful for debugging Dyalog''s bootstrapping process.'</code>
<code> [63]  n.DyalogWSLoadedStop.onSelect←'OnChanged' 'DYALOGWSLOADEDSTOP'</code>
<code> [64]  n.DyalogWSLoadedStop.onKeyPress←'OnStandardKeyPress'</code>
<code> [65] </code>
<code> [66]  n←((hor,startAt)add)CreateStartupParms n</code>
<code> [67] ⍝Done</code>
</div>
<code class="header" id="listing_156">#.Launchy.Launchy.CreateGui &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateGui testFlag</code>
<code> [1]   n←CreateForm testFlag</code>
<code> [2]   n←CreateStatusbar n</code>
<code> [3]   n←CreateMenubar n</code>
<code> [4]   (↑,/{'MenuItem'⎕WN ⍵}¨'Menu'⎕WN n.MB).HintObj←⊂n.statusbarMsg</code>
<code> [5]   n←PolishStatusbarSize n</code>
<code> [6]   n←CreateVersions n</code>
<code> [7]   n←CreateDebugFlags n</code>
<code> [8]   n←CreateFlags n</code>
<code> [9]   n←CreateWsSize n</code>
<code> [10]  n←CreateRide n</code>
<code> [11]  n←CreateCommandLine n</code>
<code> [12]  n←CreateButtons n</code>
<code> [13]  HandleTips n</code>
<code> [14]  n.Form.∆Reset←0</code>
<code> [15]  # ⎕WS'Event' 9999 1</code>
<code> [16] ⍝Done</code>
</div>
<code class="header" id="listing_157">#.Launchy.Launchy.CreateMenu_Edit &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateMenu_Edit n</code>
<code> [1]   n.MenuEdit←n.MB.⎕NEW'Menu'(⊂'Caption' '&amp;Edit')</code>
<code> [2]  </code>
<code> [3]   ∆←''</code>
<code> [4]   ∆,←⊂'Caption' 'Launchy''s INI file(s)'</code>
<code> [5]   ∆,←⊂'Hint' 'Starts Notepad on Launchy''s INI file(s)'</code>
<code> [6]   n.editINI←n.MenuEdit.⎕NEW'MenuItem'∆</code>
<code> [7]   n.editINI.onSelect←'OnEditINI'</code>
<code> [8]  </code>
<code> [9]   ∆←''</code>
<code> [10]  ∆,←⊂'Caption' 'Dyalog Registry entries'</code>
<code> [11]  ∆,←⊂'Hint' 'Starts RegEdit on the currently selected version of Dyalog'</code>
<code> [12]  n.regEdit←n.MenuEdit.⎕NEW'MenuItem'∆</code>
<code> [13]  n.regEdit.onSelect←'OnRegEdit'</code>
<code> [14] </code>
<code> [15]  ∆←''</code>
<code> [16]  ∆,←⊂'Caption' 'DSS credentials'</code>
<code> [17]  ∆,←⊂'Hint' 'Saves DSS credentials for all installed APLs in one go'</code>
<code> [18]  n.editCredentials←n.MenuEdit.⎕NEW'MenuItem'∆</code>
<code> [19]  n.editCredentials.onSelect←'OnEditCredentials'</code>
<code> [20] ⍝Done</code>
</div>
<code class="header" id="listing_158">#.Launchy.Launchy.CreateMenu_Explore &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateMenu_Explore n</code>
<code> [1]   n.MenuExplore←n.MB.⎕NEW'Menu'(⊂'Caption' 'E&amp;xplore')</code>
<code> [2]  </code>
<code> [3]   ∆←''</code>
<code> [4]   ∆,←⊂'Caption' 'Installation directory'</code>
<code> [5]   ∆,←⊂'Hint' 'Starts Windows Explorer in installation directory of selected APL'</code>
<code> [6]   n.runExplorer←n.MenuExplore.⎕NEW'MenuItem'∆</code>
<code> [7]   n.runExplorer.onSelect←'OnStartExplorer'</code>
<code> [8]  </code>
<code> [9]   ∆←''</code>
<code> [10]  ∆,←⊂'Caption' 'Help directory'</code>
<code> [11]  ∆,←⊂'Active'HasWorkDir</code>
<code> [12]  ∆,←⊂'Hint' 'Starts Windows Explorer in the Help\ folder of the currently selected APL'</code>
<code> [13]  n.runExplorerInHelpDir←n.MenuExplore.⎕NEW'MenuItem'∆</code>
<code> [14]  n.runExplorerInHelpDir.onSelect←'OnStartExplorerInHelpDir'</code>
<code> [15] ⍝Done</code>
</div>
<code class="header" id="listing_159">#.Launchy.Launchy.CreateMenu_File &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateMenu_File n</code>
<code> [1]   n.MenuFile←n.MB.⎕NEW'Menu'(⊂'Caption' '&amp;File')</code>
<code> [2]  </code>
<code> [3]   ∆←''</code>
<code> [4]   ∆,←⊂'Caption' 'Patch Dyalog...'</code>
<code> [5]   ∆,←⊂'Hint' 'Patch all or the currently selected version of Dyalog'</code>
<code> [6]   n.loadPatch←n.MenuFile.⎕NEW'MenuItem'∆</code>
<code> [7]   n.loadPatch.onSelect←'OnLoadPatch'</code>
<code> [8]  </code>
<code> [9]   n.Sep1←n.MenuFile.⎕NEW(⊂'Separator')</code>
<code> [10] </code>
<code> [11]  n.runRide←⍬</code>
<code> [12]  :For version path :InEach ↓⍉G.RideVersions</code>
<code> [13]      ∆←''</code>
<code> [14]      ∆,←⊂'Caption'('Start Ride ',version)</code>
<code> [15] ⍝     ∆,←⊂'HintObj'n.statusbarMsg</code>
<code> [16]      txt←'Starts Ride ',version,' and listens on port ',(⍕Ini.RIDE.port),' by default.'</code>
<code> [17]      ∆,←⊂'Hint'txt</code>
<code> [18]      n.runRide,←n.MenuFile.⎕NEW'MenuItem'∆</code>
<code> [19]      (¯1↑n.runRide).onSelect←⊂'OnRunRide'(version path)</code>
<code> [20]  :EndFor</code>
<code> [21] </code>
<code> [22]  :If n.runRide≢⍬</code>
<code> [23]      n.Sep2←n.MenuFile.⎕NEW(⊂'Separator')</code>
<code> [24]  :EndIf</code>
<code> [25] </code>
<code> [26]  ∆←''</code>
<code> [27]  ∆,←⊂'Caption' 'Quit'</code>
<code> [28] ⍝ ∆,←⊂'HintObj'n.statusbarMsg</code>
<code> [29]  ∆,←⊂'Hint' 'Quit Launchy'</code>
<code> [30]  n.quit←n.MenuFile.⎕NEW'MenuItem'∆</code>
<code> [31]  n.quit.onSelect←'OnQuit'</code>
<code> [32] ⍝Done</code>
</div>
<code class="header" id="listing_160">#.Launchy.Launchy.CreateMenu_Help &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateMenu_Help n</code>
<code> [1]   n.MenuHelp←n.MB.⎕NEW'Menu'(⊂'Caption' '&amp;Help')</code>
<code> [2]  </code>
<code> [3]   ∆←''</code>
<code> [4]   ∆,←⊂'Caption'('Help on Launchy',(⎕UCS 9),'F1')</code>
<code> [5]   ∆,←⊂'Accelerator'(112 0)</code>
<code> [6]   n.Help←n.MenuHelp.⎕NEW'MenuItem'∆</code>
<code> [7]   n.Help.onSelect←'OnHelp'</code>
<code> [8]  </code>
<code> [9]   n.Sep05←n.MenuHelp.⎕NEW(⊂'Separator')</code>
<code> [10] </code>
<code> [11]  ∆←''</code>
<code> [12]  ∆,←⊂'Caption' 'View latest release notes'</code>
<code> [13]  n.ReleaseNotes←n.MenuHelp.⎕NEW'MenuItem'∆</code>
<code> [14]  n.ReleaseNotes.onSelect←'OnReleaseNotes'</code>
<code> [15] </code>
<code> [16]  ∆←''</code>
<code> [17]  ∆,←⊂'Caption' 'View all release notes" on GitHub'</code>
<code> [18]  n.ReleaseNotesGitHub←n.MenuHelp.⎕NEW'MenuItem'∆</code>
<code> [19]  n.ReleaseNotesGitHub.onSelect←'OnGitHubReleaseNotes'</code>
<code> [20] </code>
<code> [21]  n.Sep11←n.MenuHelp.⎕NEW(⊂'Separator')</code>
<code> [22] </code>
<code> [23]  ∆←''</code>
<code> [24]  ∆,←⊂'Caption' 'Check for updates...'</code>
<code> [25]  n.CheckForNewVersion←n.MenuHelp.⎕NEW'MenuItem'∆</code>
<code> [26]  n.CheckForNewVersion.onSelect←'OnCheckForNewVersion'</code>
<code> [27] </code>
<code> [28]  ∆←''</code>
<code> [29]  ∆,←⊂'Caption' 'Visit Launchy on GitHub'</code>
<code> [30]  n.GoToGitHub←n.MenuHelp.⎕NEW'MenuItem'∆</code>
<code> [31]  n.GoToGitHub.onSelect←'OnGoToGitHub'</code>
<code> [32] </code>
<code> [33]  n.Sep21←n.MenuHelp.⎕NEW(⊂'Separator')</code>
<code> [34] </code>
<code> [35]  ∆,←⊂'Caption'('Dyalog online help',(⎕UCS 9),'Shift+F1')</code>
<code> [36]  ∆,←⊂'Accelerator'(112 1)</code>
<code> [37]  n.OnlineHelp←n.MenuHelp.⎕NEW'MenuItem'∆</code>
<code> [38]  n.OnlineHelp.onSelect←'OnOnlineHelp'</code>
<code> [39]  n.OnlineHelp.Hint←'Opens online help of currently selected APL'</code>
<code> [40] </code>
<code> [41]  n.Sep31←n.MenuHelp.⎕NEW(⊂'Separator')</code>
<code> [42] </code>
<code> [43]  n.about←n.MenuHelp.⎕NEW'MenuItem'(⊂'Caption' 'About...')</code>
<code> [44]  n.about.onSelect←'OnAbout'</code>
<code> [45] </code>
<code> [46]  :If 0&lt;Ini.CONFIG.⎕NC'letscrash'</code>
<code> [47]  :AndIf Ini.CONFIG.letscrash</code>
<code> [48]      n.Sep41←n.MenuHelp.⎕NEW(⊂'Separator')</code>
<code> [49]      n.letscrash←n.MenuHelp.⎕NEW'MenuItem'(⊂'Caption' 'Let''s crash')</code>
<code> [50]      n.letscrash.onSelect←'OnLetsCrash'</code>
<code> [51]  :EndIf</code>
</div>
<code class="header" id="listing_161">#.Launchy.Launchy.CreateMenu_Options &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateMenu_Options n</code>
<code> [1]   n.MenuOptions←n.MB.⎕NEW'Menu'(⊂'Caption' '&amp;Options')</code>
<code> [2]   n.MenuOptions.onDropDown←'OnMenuOptionsDropDown'</code>
<code> [3]  </code>
<code> [4]   ∆←''</code>
<code> [5]   ∆,←⊂'Caption' 'Show command before launch'</code>
<code> [6]   ∆,←⊂'Checked'G.ShowCMD</code>
<code> [7]   ∆,←⊂'Hint' 'When ticked the command that launches APL will be shown to you'</code>
<code> [8]   n.showCmd←n.MenuOptions.⎕NEW'MenuItem'∆</code>
<code> [9]   n.showCmd.onSelect←'OnHandleOption'</code>
<code> [10] </code>
<code> [11]  ∆←''</code>
<code> [12]  ∆,←⊂'Caption' 'Show tips'</code>
<code> [13]  ∆,←⊂'Hint' 'Toggles the visibility of any tips'</code>
<code> [14]  ∆,←⊂'Checked'G.ShowTips</code>
<code> [15]  n.showTips←n.MenuOptions.⎕NEW'MenuItem'∆</code>
<code> [16]  n.showTips.onSelect←'OnHandleTipToggler'</code>
<code> [17] </code>
<code> [18]  ∆←''</code>
<code> [19]  ∆,←⊂'Caption' 'Iconify after launch'</code>
<code> [20]  ∆,←⊂'Hint' 'Iconify "Launchy" whenever the "Launch APL" button was pressed.'</code>
<code> [21]  ∆,←⊂'Checked'G.Iconify</code>
<code> [22]  ∆,←⊂'Posn' 3</code>
<code> [23]  n.iconify←n.MenuOptions.⎕NEW'MenuItem'∆</code>
<code> [24]  n.iconify.onSelect←'OnIconify'</code>
<code> [25] </code>
<code> [26]  ∆←''</code>
<code> [27]  ∆,←⊂'Caption' 'Make currently selected APL the default'</code>
<code> [28]  ∆,←⊂'Hint' 'The default version will be pre-selected at restart.'</code>
<code> [29]  ∆,←⊂'Posn' 4</code>
<code> [30]  n.MakeDefault←n.MenuOptions.⎕NEW'MenuItem'∆</code>
<code> [31]  n.MakeDefault.onSelect←'OnMakeDefault'</code>
<code> [32] </code>
<code> [33]  ∆←''</code>
<code> [34]  ∆,←⊂'Caption'('Select the default version',(⎕UCS 9),'F6')</code>
<code> [35]  ∆,←⊂'Accelerator'(117 0)</code>
<code> [36]  ∆,←⊂'Posn' 5</code>
<code> [37]  n.SelectDefault←n.MenuOptions.⎕NEW'MenuItem'∆</code>
<code> [38]  n.SelectDefault.onSelect←'OnSelectDefault'</code>
<code> [39] </code>
<code> [40]  ∆←''</code>
<code> [41]  ∆,←⊂'Caption'('Give focus to the list of APLs',(⎕UCS 9),'F5')</code>
<code> [42]  ∆,←⊂'Accelerator'(116 0)</code>
<code> [43]  ∆,←⊂'Posn' 6</code>
<code> [44]  n.MoveFocusToList←n.MenuOptions.⎕NEW'MenuItem'∆</code>
<code> [45]  n.MoveFocusToList.onSelect←'OnMoveFocusToList'</code>
<code> [46] ⍝Done</code>
</div>
<code class="header" id="listing_162">#.Launchy.Launchy.CreateMenubar &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> n←CreateMenubar n</code>
<code> [1]  n.MB←n.Form.⎕NEW(⊂'Menubar')</code>
<code> [2]  n←CreateMenu_File n</code>
<code> [3]  n←CreateMenu_Edit n</code>
<code> [4]  n←CreateMenu_Explore n</code>
<code> [5]  n←CreateMenu_Options n</code>
<code> [6]  n←CreateMenu_Help n</code>
<code> [7] ⍝Done</code>
</div>
<code class="header" id="listing_163">#.Launchy.Launchy.CreateStartupParms &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←x CreateStartupParms n</code>
<code> [1]  ⍝ Creates the checkboxes for DYALOGSTARTUPSTOP &amp; DYALOGSTARTUPDEBUG</code>
<code> [2]   (posn add)←x</code>
<code> [3]   ∆←''</code>
<code> [4]   ∆,←⊂'Style' 'Check'</code>
<code> [5]   ∆,←⊂'Caption' 'No trapping in StartUp script'</code>
<code> [6]   ∆,←⊂'TipObj'n.tip</code>
<code> [7]   ∆,←⊂'Tip'('Very early; 19.0 and better only')</code>
<code> [8]   n.DYALOGSTARTUPDEBUG←n.Form.⎕NEW'Button'∆</code>
<code> [9]   n.DYALOGSTARTUPDEBUG.Posn←posn</code>
<code> [10]  n.DYALOGSTARTUPDEBUG.onSelect←'OnDYALOGSTARTUPDEBUG'</code>
<code> [11] </code>
<code> [12]  posn[1]+←add</code>
<code> [13] </code>
<code> [14]  ∆←''</code>
<code> [15]  ∆,←⊂'Style' 'Check'</code>
<code> [16]  ∆,←⊂'Caption' 'Stop within StartUp script'</code>
<code> [17]  ∆,←⊂'TipObj'n.tip</code>
<code> [18]  ∆,←⊂'Tip'('Very early; 19.0 and better only')</code>
<code> [19]  n.DYALOGSTARTUPSTOP←n.Form.⎕NEW'Button'∆</code>
<code> [20]  n.DYALOGSTARTUPSTOP.Posn←posn</code>
<code> [21]  n.DYALOGSTARTUPSTOP.onSelect←'OnDYALOGSTARTUPSTOP'</code>
<code> [22] ⍝Done</code>
</div>
<code class="header" id="listing_164">#.Launchy.Launchy.CreateStatusbar &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateStatusbar n</code>
<code> [1]   n.SB←n.Form.⎕NEW(⊂'Statusbar')</code>
<code> [2]  </code>
<code> [3]   ∆←''</code>
<code> [4]   ∆,←⊂'Coord' 'Pixel'</code>
<code> [5]   size←((⊃{(⍕⍺),' x ',(⍕⍵)}/⌽ScreenSize))</code>
<code> [6]   ∆,←⊂'Text'size</code>
<code> [7]   n.sizeInfo←n.SB.⎕NEW'StatusField'∆</code>
<code> [8]   n.sizeInfo.Size[2]←5+2⊃n.SB.GetTextSize size</code>
<code> [9]  </code>
<code> [10]  ∆←''</code>
<code> [11]  ∆,←⊂'Coord' 'Pixel'</code>
<code> [12]  ∆,←⊂'Size'(⍬((2⊃n.SB.Size)-2⊃n.sizeInfo.Size+10))</code>
<code> [13]  n.statusbarMsg←n.SB.⎕NEW'StatusField'∆</code>
<code> [14] ⍝Done</code>
</div>
<code class="header" id="listing_165">#.Launchy.Launchy.CreateTipObject &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> n←CreateTipObject n</code>
<code> [1]  ∆←''</code>
<code> [2]  ∆,←⊂'FontObj'n.aplFont</code>
<code> [3]  n.tip←n.Form.⎕NEW'TipField'∆</code>
</div>
<code class="header" id="listing_166">#.Launchy.Launchy.CreateWsSize &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←CreateWsSize n</code>
<code> [1]   list←','U.Split Ini.WSSIZE.options</code>
<code> [2]   ∆←''</code>
<code> [3]   ∆,←⊂'Style' 'Drop'</code>
<code> [4]   ∆,←⊂'Items'list</code>
<code> [5]   ∆,←⊂'SelItems'(list≡¨⊂Ini.WSSIZE.default)</code>
<code> [6]   ∆,←⊂'Posn'((6+1⊃AddPosnAndSize n.DebugGroup),10)</code>
<code> [7]   ∆,←⊂'Size'(⍬ 80)</code>
<code> [8]   ∆,←⊂'Style' 'DropEdit'</code>
<code> [9]   ∆,←⊂'TipObj'n.tip</code>
<code> [10]  n.wssize←n.Form.⎕NEW'Combo'∆</code>
<code> [11]  n.wssize.Tip←'Use this to specify the workspace size.' 'The list comes from Launchy''s INI file.'</code>
<code> [12]  n.wssize.Tip,←⊂'You can enter anything you like; use "MB" or "GB"'</code>
<code> [13]  n.wssize.Tip,←'If you enter just digits then anything lesser' 'than 16 gets "GB" and "MB" otherwise.'</code>
<code> [14]  n.wssize.onChange←'OnChanged' 'WSSIZE'</code>
<code> [15]  n.wssize.onKeyPress←'OnStandardKeyPress'</code>
<code> [16] </code>
<code> [17]  ∆←''</code>
<code> [18]  ∆,←⊂'Caption' 'MAXWS'</code>
<code> [19]  ∆,←⊂'Posn'(¯2+n.wssize.Posn[1],6+2⊃AddPosnAndSize n.wssize)</code>
<code> [20]  n.wssize_Label←n.Form.⎕NEW'Label'∆</code>
<code> [21]  ⎕DL 0.01 ⋄ n.wssize.SelText←2⍴1+≢n.wssize.Text  ⍝ Without delay it has no effect?!</code>
<code> [22] ⍝Done</code>
</div>
<code class="header" id="listing_167">#.Launchy.Launchy.DQ &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{giveFocusTo}DQ obj</code>
<code> [1]  ⍝ :If 0=⎕NC'giveFocusTo'</code>
<code> [2]  ⍝     giveFocusTo←n.ChangeAPL</code>
<code> [3]  ⍝ :EndIf</code>
<code> [4]   :If 0=⎕NC'giveFocusTo'</code>
<code> [5]       giveFocusTo←n.List</code>
<code> [6]   :EndIf</code>
<code> [7]   ⎕NQ giveFocusTo'GotFocus' ⋄ r←⎕DQ obj</code>
<code> [8]   CloseForm ⍬</code>
<code> [9]  ⍝Done</code>
</div>
<code class="header" id="listing_168">#.Launchy.Launchy.Find_RIDE_Versions &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←Find_RIDE_Versions Ini</code>
<code> [1]  ⍝ Returns a list with all major (like 3.0) and minor (like (3.1) versions of Ride found in the</code>
<code> [2]  ⍝ path `[Ride]path2ride` is pointing to - if that exists at all.</code>
<code> [3]  ⍝ This version does not support anymore to install several builts of the same version number.</code>
<code> [4]   r←''</code>
<code> [5]   :If 0&lt;Ini.⎕NC'RIDE'</code>
<code> [6]   :AndIf 2=Ini.RIDE.⎕NC'path2ride'</code>
<code> [7]   :AndIf F.IsDir Ini.RIDE.path2ride</code>
<code> [8]       flag←'programs\dyalog'≡⎕C{⍵↑⍨-+/2&gt;+\(⌽⍵)∊'/\'}Ini.RIDE.path2ride</code>
<code> [9]       path←Ini.RIDE.path2ride,flag/'\..'</code>
<code> [10]  :AndIf 0≠≢list←F.ListDirs path,'\Dyalog\'</code>
<code> [11]      list2←↑,/F.ListDirs¨list,¨'\'</code>
<code> [12]  :AndIf 0≠≢allRides←('resources'∘{⍺≡(-⍴⍺)↑⍵}¨list2)/list2</code>
<code> [13]      versionFiles←allRides,¨⊂'\app\_\version'</code>
<code> [14]  :AndIf ∨/bool←F.IsFile versionFiles</code>
<code> [15]      (allRides versionFiles)←bool∘/¨allRides versionFiles</code>
<code> [16]      versionNos←⊃∘F.NGET¨versionFiles</code>
<code> [17]      ind←∪#{⍵⍳⍵}versionNos</code>
<code> [18]      allRides←'expand'F.NormalizePath allRides,¨⊂'\..'</code>
<code> [19]      r←(versionNos,[1.5]allRides)[ind;]</code>
<code> [20]      r←(4≤{⊃⊃(//)⎕VFI 1⊃2↑1↓¨⍵⊂⍨'.'=⍵}¨'.',¨versionNos)⌿r</code>
<code> [21]  :EndIf</code>
</div>
<code class="header" id="listing_169">#.Launchy.Launchy.GetAplLauncherRegistryKey &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetAplLauncherRegistryKey</code>
<code> [1] ⍝ Return the folder name in the Windows Registry for Launchy</code>
<code> [2]  r←'HKEY_CURRENT_USER\Software\APLTree\Launchy\'</code>
</div>
<code class="header" id="listing_170">#.Launchy.Launchy.GetDefaultFromRegistry &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetDefaultFromRegistry←{</code>
<code> [1] ⍝ Returns the default version as defined in the Windows Registry</code>
<code> [2] ⍝ or an ampty vector if there is no such thing as of yet.</code>
<code> [3]      ''R.GetString GetAplLauncherRegistryKey,'DefaultVersion'</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_171">#.Launchy.Launchy.GetListOfAPLs &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (list orig)←GetListOfAPLs G</code>
<code> [1]  ⍝ `list` is a two-item vector with all APLs installed Unicode [1] and Classic [2].</code>
<code> [2]  ⍝ With each item the list is sorted from 64 down to 32 bit.</code>
<code> [3]  ⍝ `orig` is sorted in the same way but is a vector of vectors.</code>
<code> [4]   list←orig←G.AplVersions</code>
<code> [5]   list←'APL/W '⎕R'APL/W-32 '⊣list</code>
<code> [6]   default←G.AplVersions≡¨⊂G.Default</code>
<code> [7]   :If 0≠≢list←'[0-9]$'⎕R'&amp; Classic'⊣list</code>
<code> [8]       list←list[ind←⍒(↑list)[;14 15]]</code>
<code> [9]       default←default[ind]</code>
<code> [10]      orig←orig[ind]</code>
<code> [11]      list←list[ind←⍒↑(-⍴'Unicode')↑¨list]</code>
<code> [12]      default←default[ind]</code>
<code> [13]      orig←orig[ind]</code>
<code> [14]      :If 0&lt;+/default</code>
<code> [15]          (default/list)←⊂(⊃default/list),' ★'</code>
<code> [16]      :EndIf</code>
<code> [17]  :EndIf</code>
<code> [18] ⍝Done</code>
</div>
<code class="header" id="listing_172">#.Launchy.Launchy.GetProperAPL_FontSize &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetProperAPL_FontSize</code>
<code> [1]  'fnt'⎕WC'Font'('PName'Ini.FONT.name)('Size'Ini.FONT.size)</code>
<code> [2]  'f'⎕WC'Form'('Coord' 'Pixel')('Visible' 0)</code>
<code> [3]  f.FontObj←fnt</code>
<code> [4]  'f.l'⎕WC'Label'('Caption' '99')</code>
<code> [5]  r←f.l.GetTextSize'9'</code>
</div>
<code class="header" id="listing_173">#.Launchy.Launchy.GetRegPathForCurrentDyalogVersion &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetRegPathForCurrentDyalogVersion←{</code>
<code> [1] ⍝ Returns full registry path for the currently selected version</code>
<code> [2] ⍝ of Dyalog APL in case  ⍵ is empty the default version is chosen.</code>
<code> [3]      v←{0∊⍴⍵:G.Default ⋄ ⍵}⍵</code>
<code> [4]      GetRegPathForDyalog,v</code>
<code> [5]  }</code>
</div>
<code class="header" id="listing_174">#.Launchy.Launchy.GetRegPathForDyalog &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetRegPathForDyalog</code>
<code> [1]  r←'Software\Dyalog\'</code>
</div>
<code class="header" id="listing_175">#.Launchy.Launchy.GetRideMsg &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetRideMsg←{</code>
<code> [1]      tip←⊂'RIDE is an alternative to the built-in IDE.'</code>
<code> [2]      tip,←⊂'You will still be asked whether you want a Ride or not.'</code>
<code> [3]      tip</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_176">#.Launchy.Launchy.HandleTips &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> HandleTips n</code>
<code> [1] ⍝ Called once after the GUI was created.</code>
<code> [2] ⍝ Switches the Tips off, which makes sure that within every control the Tip is copied to ∆Tip and then set to ''</code>
<code> [3] ⍝ We then enable Tips if requested; that copied ∆Tip back to Tip.</code>
<code> [4] ⍝ This is required because a Tipfield has no "Visible" proeprty.</code>
<code> [5]  0 ToggleTipVisibility n                ⍝ Make sure we copy all Tips over to ∆Tip</code>
<code> [6]  {}1 ToggleTipVisibility⍣G.ShowTips⊣n     ⍝ Bring them back depending on G.ShowTips</code>
</div>
<code class="header" id="listing_177">#.Launchy.Launchy.Init2 &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Ini←Init2 errorParms</code>
<code> [1] ⍝ Establish a couple of essentials</code>
<code> [2]  Ini←ProcessIniFile errorParms</code>
<code> [3]  CreateGlobals Ini</code>
<code> [4]  {}SetScaledPixel ⍬</code>
<code> [5]  ∆AskForCommandLineParms←1</code>
<code> [6] ⍝Done</code>
</div>
<code class="header" id="listing_178">#.Launchy.Launchy.MassageAplList_ &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (l2 indents)←level MassageAplList_ l</code>
<code> [1]   b←∨/¨'-64'∘⍷¨l</code>
<code> [2]   indents←⍬</code>
<code> [3]   l2←⊂'64 bit'</code>
<code> [4]   noOf←+/b</code>
<code> [5]   l2,←noOf↑l</code>
<code> [6]   indents,←level,noOf⍴1+level</code>
<code> [7]   l2,←⊂'32 bit'</code>
<code> [8]   noOf←+/~b</code>
<code> [9]   l2,←(-noOf)↑l</code>
<code> [10]  indents,←level,noOf⍴1+level</code>
<code> [11] ⍝Done</code>
</div>
<code class="header" id="listing_179">#.Launchy.Launchy.OnClose &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> OnClose←{</code>
<code> [1]      testFlag←⍺</code>
<code> [2]      _←⎕NQ # 9999</code>
<code> [3]      _←Shutdown testFlag</code>
<code> [4]      1</code>
<code> [5]  }</code>
</div>
<code class="header" id="listing_180">#.Launchy.Launchy.PolishPath_RIDE &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Ini←PolishPath_RIDE Ini</code>
<code> [1] ⍝ If the RIDE paths contain the string "[you]" then name is replaced by ⎕AN.</code>
<code> [2]  name←'path2ride'</code>
<code> [3]  :If Ini.Exist'Ride'name</code>
<code> [4]      data←⊃Ini.Get'RIDE'name</code>
<code> [5]      data←'\[you]'⎕R ⎕AN⍠('IC' 1)⊣data</code>
<code> [6]      data Ini.Put'RIDE'name</code>
<code> [7]  :EndIf</code>
<code> [8] ⍝Done</code>
</div>
<code class="header" id="listing_181">#.Launchy.Launchy.PolishStatusbarSize &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> PolishStatusbarSize←{</code>
<code> [1]      n←⍵</code>
<code> [2]      n.SB.Posn[1]-←3</code>
<code> [3]      n.SB.Size[1]+←3</code>
<code> [4]      n.statusbarMsg.Size[1]+←2</code>
<code> [5]      n.sizeInfo.Size[1]+←2</code>
<code> [6]      n</code>
<code> [7]  }</code>
</div>
<code class="header" id="listing_182">#.Launchy.Launchy.SEP &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←SEP</code>
<code> [1]  r←⎕UCS 10</code>
</div>
<code class="header" id="listing_183">#.Launchy.Launchy.SavePropsInRegistry &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  SavePropsInRegistry</code>
<code> [1]  ⍝ Save options in the Windows Registry for each user</code>
<code> [2]   regPath←GetAplLauncherRegistryKey</code>
<code> [3]   key←regPath,'Posn'</code>
<code> [4]   :Trap 0 ⋄ R.PutString key(⍕n.Form.Posn-S.(GetSystemMetrics SM_CXMENUSIZE),0) ⋄ :EndTrap</code>
<code> [5]   key←regPath,'ShowTips'</code>
<code> [6]   :Trap 0 ⋄ R.PutValue key n.showTips.Checked ⋄ :EndTrap</code>
<code> [7]   key←regPath,'RestoreDefaults'</code>
<code> [8]   :Trap 0 ⋄ R.PutValue key n.restoreDefaults.Checked ⋄ :EndTrap</code>
<code> [9]   key←regPath,'ShowCmd'</code>
<code> [10]  :Trap 0 ⋄ R.PutValue key n.showCmd.Checked ⋄ :EndTrap</code>
<code> [11]  cmds←n.cmdLineArgs.Text</code>
<code> [12]  :If n.saveCmdLineOnQuit.State</code>
<code> [13]      key←regPath,'CommandLineArgs'</code>
<code> [14]      :Trap 0 ⋄ R.PutString key cmds ⋄ :EndTrap</code>
<code> [15]  :EndIf</code>
<code> [16]  key←regPath,'ShowAPLs'</code>
<code> [17]  :Trap 0 ⋄ R.PutValue key n.presentAPLs.Checked ⋄ :EndTrap</code>
<code> [18]  key←regPath,'Iconify'</code>
<code> [19]  :Trap 0 ⋄ R.PutValue key n.iconify.Checked ⋄ :EndTrap</code>
<code> [20]  key←regPath,'DefaultVersion'</code>
<code> [21]  :Trap 0 ⋄ R.PutString key G.Default ⋄ :EndTrap</code>
<code> [22] ⍝Done</code>
</div>
<code class="header" id="listing_184">#.Launchy.Launchy.ScreenSize &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> R←ScreenSize</code>
<code> [1]  ⍝⍝ Return the client area size of the (main) screen</code>
<code> [2]  R←S.(GetSystemMetrics¨SM_CYFULLSCREEN SM_CXFULLSCREEN)</code>
</div>
<code class="header" id="listing_185">#.Launchy.Launchy.SetScaledPixel &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> SetScaledPixel←{</code>
<code> [1]      11::⍬      ⍝ Versions prior to 14.1 will DOMAIN ERROR</code>
<code> [2]      _←2035⌶'ScaledPixel'</code>
<code> [3]      ⍬</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_186">#.Launchy.Launchy.ToggleTipVisibility &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←flag ToggleTipVisibility n</code>
<code> [1]  ⍝ Toggles the visibility of all tips depending on n.showTips.Checked</code>
<code> [2]   r←⍬</code>
<code> [3]   :If 0&lt;≢list←{⍵/⍨{11::0 ⋄ 1⊣⍵ ⎕WG'Tip'}¨⍵}{⍵.⍎¨' '~¨⍨↓⍵.⎕NL 9}n</code>
<code> [4]       :If flag</code>
<code> [5]           list←({⊃2=⍵.⎕NC'∆Tip'}¨list)/list</code>
<code> [6]           {⍵.Tip←⍵.∆Tip}¨list</code>
<code> [7]       :Else</code>
<code> [8]           CopyTips¨list</code>
<code> [9]           {⍵.Tip←''}¨list</code>
<code> [10]      :EndIf</code>
<code> [11]  :EndIf</code>
</div>
<code class="header" id="listing_187">#.Launchy.Launchy.Version &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Version</code>
<code> [1]  ⍝ See `History`</code>
<code> [2]  r←'Launchy' '7.6.1+277' '2023-09-11'</code>
</div>
<code class="header" id="listing_188">#.Launchy.Launchy.RefNamespace.Create &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  n←Create displayName</code>
<code> [1]   :Access Public Shared</code>
<code> [2]      ⍝ Creates an unnamed namespace and populates it with some functions.</code>
<code> [3]      ⍝ The names of those functions start with a "∆" character.</code>
<code> [4]      ⍝ This namespace is designed to collect all the references used _</code>
<code> [5]      ⍝ by/for a particular GUI like a standard form (StdForm).</code>
<code> [6]      ⍝ The right argument is used for ⎕DF if not empty.</code>
<code> [7]   :Access Public Shared</code>
<code> [8]   n←⎕NS⊃'∆List' '∆GetRefs' '∆GetMethods'</code>
<code> [9]   :If 0≠≢displayName</code>
<code> [10]      n.⎕DF displayName</code>
<code> [11]  :EndIf</code>
</div>
<div id="footer">
<hr>
<p>Created by "CodeCoverage" version 0.10.2+52 from 2023-04-09</p>
</div>

</body>
</html>
